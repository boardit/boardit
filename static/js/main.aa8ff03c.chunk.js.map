{"version":3,"sources":["lib/beautify/core/options.js","lib/beautify/core/output.js","lib/beautify/core/inputscanner.js","lib/beautify/core/token.js","lib/beautify/core/tokenstream.js","lib/beautify/core/whitespacepattern.js","lib/beautify/core/directives.js","lib/beautify/core/templatablepattern.js","components/editor/editor.tsx","components/preview/preview.tsx","components/menu/item/item.tsx","components/menu/bar/bar.tsx","lib/saver/ponyfill/stub/assert.ts","lib/saver/ponyfill/stub/number-isnan.ts","lib/saver/ponyfill/lib/helpers.ts","lib/saver/ponyfill/lib/utils.ts","lib/saver/ponyfill/lib/simple-queue.ts","lib/saver/ponyfill/lib/queue-with-sizes.ts","lib/saver/ponyfill/lib/writable-stream.ts","lib/saver/ponyfill/stub/number-isinteger.ts","lib/saver/ponyfill/lib/readable-stream.ts","lib/createHTML/createHTML.ts","App.tsx","lib/saver/saver.ts","index.tsx","lib/beautify/core/pattern.js","lib/beautify/options.js","lib/beautify/tokenizer.js","lib/beautify/core/tokenizer.js","lib/beautify/index.js","../node_modules/ace-builds/src-noconflict sync /^/.//theme/-.*$","lib/beautify/beautifier.js"],"names":["Options","options","merge_child_field","this","raw_options","_mergeOpts","disabled","_get_boolean","eol","_get_characters","end_with_newline","indent_size","_get_number","indent_char","indent_level","preserve_newlines","max_preserve_newlines","indent_with_tabs","wrap_line_length","indent_empty_lines","templating","_get_selection_list","allOptions","childFieldName","name","finalOpts","_normalizeOpts","key","convertedOpts","replace","prototype","_get_array","default_value","option_value","result","concat","split","undefined","parseInt","isNaN","_get_selection","selection_list","length","Error","_is_valid_selection","some","item","indexOf","module","exports","normalizeOpts","mergeOpts","OutputLine","parent","__parent","__character_count","__indent_count","__alignment_count","__wrap_point_index","__wrap_point_character_count","__wrap_point_indent_count","__wrap_point_alignment_count","__items","IndentStringCache","baseIndentString","__cache","__indent_size","__indent_string","Array","join","__base_string","__base_string_length","Output","__indent_cache","raw","_end_with_newline","__lines","previous_line","current_line","next_line","space_before_token","non_breaking_space","previous_token_wrapped","__add_outputline","clone_empty","line","set_indent","index","has_match","pattern","lastCheckedOutput","match","indent","alignment","is_empty","get_indent_size","_set_wrap_point","_should_wrap","_allow_wrap","add_new_line","next","slice","splice","last","push","last_newline_index","lastIndexOf","pop","_remove_indent","_remove_wrap_indent","trim","toString","get_indent_string","column","__ensure_cache","__add_column","Math","floor","get_line_number","force_newline","just_added_newline","get_code","last_item","sweet_code","set_wrap_point","add_raw_token","token","x","newlines","whitespace_before","text","add_token","printable_token","__add_space_before_token","remove_indent","output_length","eat_newlines","just_added_blankline","ensure_empty_line_above","starts_with","ends_with","potentialEmptyLine","regexp_has_sticky","RegExp","hasOwnProperty","InputScanner","input_string","__input","__input_length","__position","restart","back","hasNext","val","charAt","peek","__match","lastIndex","pattern_match","exec","sticky","test","testChar","read","starting_pattern","until_pattern","until_after","readUntil","match_index","substring","readUntilAfter","get_regexp","match_from","flags","source","get_literal_regexp","literal_string","peekUntilAfter","start","lookBack","testVal","toLowerCase","Token","type","comments_before","previous","opened","closed","directives","TokenStream","parent_token","__tokens","__tokens_length","__parent_token","isEmpty","add","Pattern","require","WhitespacePattern","input_scanner","call","_line_regexp","_input","__set_whitespace_patterns","newline_count","whitespace_before_token","whitespace_chars","newline_chars","_match_pattern","_newline_regexp","resulting_string","matches","__split","matching","_create","_update","regexp","start_index","next_match","Directives","start_block_pattern","end_block_pattern","__directives_block_pattern","__directive_pattern","__directives_end_ignore_pattern","get_directives","directive_match","readIgnored","input","template_names","django","erb","handlebars","php","TemplatablePattern","__template_pattern","_disabled","Object","assign","_excluded","__patterns","handlebars_comment","starting_with","handlebars_unescaped","django_value","django_comment","__set_templated_pattern","disable","language","read_options","exclude","_starting_pattern","_read_template","_until_after","_until_pattern","items","c","peek1","forEach","theme","Editor","props","state","setTheme","bind","setState","commands","bindKey","win","mac","callbacks","format","save","placeholder","mode","onChange","change","editorProps","$blockScrolling","value","width","height","enableBasicAutocompletion","enableLiveAutocompletion","enableSnippets","wrapEnabled","React","Component","Preview","reveal","Reveal","initialize","content","versionCallback","VERSION","toggleOverview","rel","href","className","style","position","left","top","dangerouslySetInnerHTML","__html","Item","onClick","Bar","createItem","map","assert","NumberIsNaN","Number","IsPropertyKey","argument","typeIsObject","createArrayFromList","elements","ArrayBufferCopy","dest","destOffset","src","srcOffset","n","Uint8Array","set","IsFiniteNonNegativeNumber","v","IsNonNegativeNumber","Infinity","Call","F","V","args","TypeError","Function","apply","CreateAlgorithmFromUnderlyingMethod","underlyingObject","methodName","algoArgCount","extraArgs","isArray","method","PromiseCall","arg","fullArgs","Promise","resolve","InvokeOrNoop","O","P","reject","ValidateAndNormalizeHighWaterMark","highWaterMark","RangeError","MakeSizeAlgorithmFromSizeFunction","size","chunk","WaitForAll","promises","successSteps","failureSteps","rejected","rejectionHandler","fulfilledCount","total","promise","promiseIndex","onFulfilled","onRejected","then","PerformPromiseThen","rethrowAssertionErrorRejection","SimpleQueue","_front","_back","_cursor","_size","_elements","_next","element","oldBack","newBack","QUEUE_MAX_ARRAY_SIZE","oldFront","newFront","oldCursor","newCursor","callback","i","node","front","cursor","DequeueValue","container","_queue","pair","shift","_queueTotalSize","EnqueueValueWithSize","ResetQueue","AbortSteps","Symbol","ErrorSteps","WritableStream","underlyingSink","strategy","_state","_storedError","_writer","_writableStreamController","_writeRequests","_inFlightWriteRequest","_closeRequest","_inFlightCloseRequest","_pendingAbortRequest","_backpressure","InitializeWritableStream","sizeAlgorithm","SetUpWritableStreamDefaultControllerFromUnderlyingSink","reason","IsWritableStream","streamBrandCheckException","IsWritableStreamLocked","WritableStreamAbort","AcquireWritableStreamDefaultWriter","stream","WritableStreamDefaultWriter","_promise","wasAlreadyErroring","_resolve","_reject","_reason","_wasAlreadyErroring","WritableStreamStartErroring","WritableStreamDealWithRejection","error","WritableStreamFinishErroring","controller","writer","WritableStreamDefaultWriterEnsureReadyPromiseRejected","WritableStreamHasOperationMarkedInFlight","_started","storedError","writeRequest","abortRequest","WritableStreamRejectCloseAndClosedPromiseIfNeeded","WritableStreamCloseQueuedOrInFlight","defaultWriterClosedPromiseReject","WritableStreamUpdateBackpressure","backpressure","_readyPromise_resolve","_readyPromise_reject","defaultWriterReadyPromiseInitialize","defaultWriterReadyPromiseReset","defaultWriterReadyPromiseResolve","_ownerWritableStream","_closedPromise","_closedPromise_resolve","_closedPromise_reject","_closedPromiseState","_readyPromise","_readyPromiseState","defaultWriterReadyPromiseInitializeAsResolved","defaultWriterClosedPromiseInitialize","defaultWriterReadyPromiseInitializeAsRejected","defaultWriterClosedPromiseResolve","defaultWriterClosedPromiseInitializeAsRejected","IsWritableStreamDefaultWriter","defaultWriterBrandCheckException","defaultWriterLockException","WritableStreamDefaultWriterAbort","WritableStreamDefaultWriterClose","WritableStreamDefaultWriterRelease","WritableStreamDefaultWriterWrite","WritableStreamDefaultControllerGetDesiredSize","WritableStreamDefaultWriterGetDesiredSize","closeRequest","WritableStreamDefaultControllerAdvanceQueueIfNeeded","WritableStreamDefaultWriterEnsureClosedPromiseRejected","defaultWriterClosedPromiseResetToRejected","defaultWriterReadyPromiseReject","defaultWriterReadyPromiseResetToRejected","releasedError","chunkSize","_strategySizeAlgorithm","chunkSizeE","WritableStreamDefaultControllerErrorIfNeeded","WritableStreamDefaultControllerGetChunkSize","WritableStreamAddWriteRequest","writeRecord","enqueueE","_controlledWritableStream","WritableStreamDefaultControllerGetBackpressure","WritableStreamDefaultControllerWrite","WritableStreamDefaultController","_strategyHWM","_writeAlgorithm","_closeAlgorithm","_abortAlgorithm","e","IsWritableStreamDefaultController","WritableStreamDefaultControllerError","WritableStreamDefaultControllerClearAlgorithms","SetUpWritableStreamDefaultController","startAlgorithm","writeAlgorithm","closeAlgorithm","abortAlgorithm","startResult","r","catch","create","WritableStreamMarkCloseRequestInFlight","sinkClosePromise","WritableStreamFinishInFlightClose","WritableStreamFinishInFlightCloseWithError","WritableStreamDefaultControllerProcessClose","WritableStreamMarkFirstWriteRequestInFlight","WritableStreamFinishInFlightWrite","WritableStreamFinishInFlightWriteWithError","WritableStreamDefaultControllerProcessWrite","NumberIsInteger","isInteger","isFinite","AsyncIteratorPrototype","getPrototypeOf","a","CancelSteps","PullSteps","asyncIterator","ReadableStream","underlyingSource","_reader","_disturbed","_readableStreamController","InitializeReadableStream","typeString","String","SetUpReadableByteStreamControllerFromUnderlyingSource","SetUpReadableStreamDefaultControllerFromUnderlyingSource","IsReadableStream","IsReadableStreamLocked","ReadableStreamCancel","AcquireReadableStreamDefaultReader","AcquireReadableStreamBYOBReader","writable","readable","preventClose","preventAbort","preventCancel","signal","Boolean","isAbortSignal","ReadableStreamPipeTo","branches","cloneForBranch2","reason1","reason2","branch1","branch2","resolveCancelPromise","reader","canceled1","canceled2","cancelPromise","pullAlgorithm","ReadableStreamDefaultReaderRead","done","ReadableStreamDefaultControllerClose","value1","value2","ReadableStreamDefaultControllerEnqueue","CreateReadableStream","compositeReason","cancelResult","ReadableStreamDefaultControllerError","ReadableStreamTee","iterator","ReadableStreamAsyncIteratorPrototype","_asyncIteratorReader","_preventCancel","IsReadableStreamAsyncIterator","streamAsyncIteratorBrandCheckException","_ownerReadableStream","readerLockException","ReadableStreamReaderGenericRelease","ReadableStreamCreateReadResult","return","_readRequests","ReadableStreamReaderGenericCancel","forAuthorCode","ReadableStreamBYOBReader","_forAuthorCode","ReadableStreamDefaultReader","cancelAlgorithm","ReadableStreamDefaultController","SetUpReadableStreamDefaultController","shuttingDown","currentWrite","action","DOMException","actions","shutdownWithAction","resolvePromise","rejectPromise","successStepsWrapper","results","stepsResult","failureStepsWrapper","WaitForAllPromise","aborted","addEventListener","isOrBecomesErrored","shutdown","WritableStreamDefaultWriterCloseWithErrorPropagation","destClosed","waitForWritesToFinish","oldCurrentWrite","originalIsError","originalError","doTheRest","finalize","newError","isError","removeEventListener","resolveLoop","rejectLoop","ReadableStreamAddReadIntoRequest","IsReadableStreamBYOBReader","readIntoRequest","_readIntoRequests","ReadableStreamAddReadRequest","IsReadableStreamDefaultReader","readRequest","ReadableStreamClose","defaultReaderClosedPromiseResolve","obj","ReadableStreamError","defaultReaderClosedPromiseReject","ReadableStreamFulfillReadRequest","ReadableStreamGetNumReadIntoRequests","ReadableStreamGetNumReadRequests","ReadableStreamHasBYOBReader","ReadableStreamHasDefaultReader","setPrototypeOf","defineProperty","enumerable","getIterator","configurable","ReadableStreamReaderGenericInitialize","defaultReaderBrandCheckException","IsReadableByteStreamController","byobReaderBrandCheckException","view","ArrayBuffer","isView","buffer","byteLength","_controlledReadableByteStream","elementSize","constructor","DataView","BYTES_PER_ELEMENT","ctor","pullIntoDescriptor","byteOffset","bytesFilled","readerType","_pendingPullIntos","emptyView","ReadableByteStreamControllerFillPullIntoDescriptorFromQueue","filledView","ReadableByteStreamControllerConvertPullIntoDescriptor","ReadableByteStreamControllerHandleQueueDrain","_closeRequested","ReadableByteStreamControllerError","ReadableByteStreamControllerCallPullIfNeeded","ReadableByteStreamControllerPullInto","ReadableStreamBYOBReaderRead","defaultReaderClosedPromiseInitialize","defaultReaderClosedPromiseInitializeAsResolved","defaultReaderClosedPromiseInitializeAsRejected","defaultReaderClosedPromiseResetToRejected","_controlledReadableStream","_pullAgain","_pulling","_pullAlgorithm","_cancelAlgorithm","IsReadableStreamDefaultController","defaultControllerBrandCheckException","ReadableStreamDefaultControllerCanCloseOrEnqueue","ReadableStreamDefaultControllerClearAlgorithms","ReadableStreamDefaultControllerCallPullIfNeeded","pendingPromise","ReadableStreamDefaultControllerGetDesiredSize","ReadableStreamDefaultControllerShouldCallPull","desiredSize","ReadableStreamBYOBRequest","_associatedReadableByteStreamController","_view","bytesWritten","IsReadableStreamBYOBRequest","byobRequestBrandCheckException","ReadableByteStreamControllerRespondInternal","ReadableByteStreamControllerRespond","firstDescriptor","ReadableByteStreamControllerRespondWithNewView","ReadableByteStreamController","_autoAllocateChunkSize","_byobRequest","byteStreamControllerBrandCheckException","ReadableByteStreamControllerClearAlgorithms","ReadableByteStreamControllerClose","transferredBuffer","ReadableByteStreamControllerEnqueueChunkToQueue","transferredView","ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue","ReadableByteStreamControllerEnqueue","entry","viewE","autoAllocateChunkSize","bufferE","byobRequest","request","SetUpReadableStreamBYOBRequest","ReadableByteStreamControllerGetDesiredSize","ReadableByteStreamControllerShouldCallPull","ReadableByteStreamControllerCommitPullIntoDescriptor","ReadableStreamFulfillReadIntoRequest","currentAlignedBytes","maxBytesToCopy","min","maxBytesFilled","maxAlignedBytes","totalBytesToCopyRemaining","ready","queue","headOfQueue","bytesToCopy","destStart","ReadableByteStreamControllerFillHeadPullIntoDescriptor","ReadableByteStreamControllerInvalidateBYOBRequest","ReadableByteStreamControllerShiftPendingPullInto","ReadableByteStreamControllerRespondInClosedState","remainderSize","end","remainder","ReadableByteStreamControllerRespondInReadableState","descriptor","ReadableByteStreamControllerClearPendingPullIntos","SetUpReadableByteStreamController","underlyingByteSource","getOwnPropertyDescriptor","AbortSignal","get","revealVersion","title","downloadFile","reset","console","log","path","version","url","fetch","App","changeText","saveText","formatText","setVersion","newText","createHTML","filename","TextEncoder","encode","streamSaver","createWriteStream","writableStrategy","readableStrategy","getWriter","write","close","beautify","ReactDOM","render","StrictMode","document","getElementById","read_match","until","BaseOptions","indent_inner_html","indent_body_inner_html","indent_head_inner_html","indent_handlebars","wrap_attributes","wrap_attributes_indent_size","extra_liners","inline","void_elements","unformatted","content_unformatted","unformatted_content_delimiter","indent_scripts","BaseTokenizer","Tokenizer","BASETOKEN","TOKEN","TAG_OPEN","TAG_CLOSE","ATTRIBUTE","EQUALS","VALUE","COMMENT","TEXT","UNKNOWN","START","RAW","EOF","directives_core","_current_tag_name","templatable_reader","_options","pattern_reader","word","single_quote","double_quote","attribute","element_name","handlebars_open","handlebars_raw_close","comment","cdata","conditional_comment","processing","_unformatted_content_delimiter","literal_regexp","_is_comment","current_token","_is_opening","_is_closing","open_token","_reset","_get_next_token","previous_token","_readWhitespace","_create_token","_read_open_handlebars","_read_attribute","_read_close","_read_raw_content","_read_content_word","_read_comment_or_cdata","_read_processing","_read_open","ignore","_is_content_unformatted","tag_name","substr","_patterns","whitespace","tokenize","current","open_stack","comments","_is_first_token","Beautifier","html_source","js_beautify","css_beautify","defaultOptions","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","code","keys","lineBreak","allLineBreaks","Printer","base_indent_string","alignment_size","_output","current_line_has_match","set_space_before_token","non_breaking","print_preserved_newlines","raw_token","print_newline","traverse_whitespace","force","print_token","get_full_indent","level","get_custom_beautifier_name","tag_check","typeAttribute","start_token","get_type_attribute","search","in_array","what","arr","TagFrame","parser_token","tag","TagStack","printer","_printer","_current_frame","source_text","_source_text","_js_beautify","_css_beautify","_tag_stack","optionHtml","_is_wrap_attributes_force","_is_wrap_attributes_force_expand_multiline","_is_wrap_attributes_force_aligned","_is_wrap_attributes_aligned_multiple","_is_wrap_attributes_preserve","_is_wrap_attributes_preserve_aligned","get_parser_token","record_tag","new_frame","_try_pop_frame","frame","_get_frame","tag_list","stop_list","try_pop","indent_to_tag","last_token","last_tag_token","TagOpenParserToken","tokens","_handle_tag_open","tag_complete","_handle_inside_tag","_handle_tag_close","_handle_text","is_unformatted","tag_start_char","has_wrapped_attrs","indent_content","is_content_unformatted","is_inline_element","wrapped","attr_count","force_attr_wrap","peek_token","is_only_attribute","peek_index","custom_beautifier_name","_print_custom_beatifier_text","local","_beautifier","script_indent_level","pre","post","indentation","matched","Child_options","white","_get_tag_open_token","is_empty_element","_set_tag_position","start_tag_token","tag_check_match","is_start_tag","is_end_tag","multiline_content","_do_optional_end_element","_calcluate_parent_multiline","do_end_expand","p_closers","p_parent_excludes","p_parent"],"mappings":"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","file":"static/js/main.aa8ff03c.chunk.js","sourcesContent":["/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nfunction Options(options, merge_child_field) {\n  this.raw_options = _mergeOpts(options, merge_child_field);\n\n  // Support passing the source text back with no change\n  this.disabled = this._get_boolean('disabled');\n\n  this.eol = this._get_characters('eol', 'auto');\n  this.end_with_newline = this._get_boolean('end_with_newline');\n  this.indent_size = this._get_number('indent_size', 4);\n  this.indent_char = this._get_characters('indent_char', ' ');\n  this.indent_level = this._get_number('indent_level');\n\n  this.preserve_newlines = this._get_boolean('preserve_newlines', true);\n  this.max_preserve_newlines = this._get_number('max_preserve_newlines', 32786);\n  if (!this.preserve_newlines) {\n    this.max_preserve_newlines = 0;\n  }\n\n  this.indent_with_tabs = this._get_boolean('indent_with_tabs', this.indent_char === '\\t');\n  if (this.indent_with_tabs) {\n    this.indent_char = '\\t';\n\n    // indent_size behavior changed after 1.8.6\n    // It used to be that indent_size would be\n    // set to 1 for indent_with_tabs. That is no longer needed and\n    // actually doesn't make sense - why not use spaces? Further,\n    // that might produce unexpected behavior - tabs being used\n    // for single-column alignment. So, when indent_with_tabs is true\n    // and indent_size is 1, reset indent_size to 4.\n    if (this.indent_size === 1) {\n      this.indent_size = 4;\n    }\n  }\n\n  // Backwards compat with 1.3.x\n  this.wrap_line_length = this._get_number('wrap_line_length', this._get_number('max_char'));\n\n  this.indent_empty_lines = this._get_boolean('indent_empty_lines');\n\n  // valid templating languages ['django', 'erb', 'handlebars', 'php']\n  // For now, 'auto' = all off for javascript, all on for html (and inline javascript).\n  // other values ignored\n  this.templating = this._get_selection_list('templating', ['auto', 'none', 'django', 'erb', 'handlebars', 'php'], ['auto']);\n}\n\nOptions.prototype._get_array = function(name, default_value) {\n  var option_value = this.raw_options[name];\n  var result = default_value || [];\n  if (typeof option_value === 'object') {\n    if (option_value !== null && typeof option_value.concat === 'function') {\n      result = option_value.concat();\n    }\n  } else if (typeof option_value === 'string') {\n    result = option_value.split(/[^a-zA-Z0-9_/-]+/);\n  }\n  return result;\n};\n\nOptions.prototype._get_boolean = function(name, default_value) {\n  var option_value = this.raw_options[name];\n  var result = option_value === undefined ? !!default_value : !!option_value;\n  return result;\n};\n\nOptions.prototype._get_characters = function(name, default_value) {\n  var option_value = this.raw_options[name];\n  var result = default_value || '';\n  if (typeof option_value === 'string') {\n    result = option_value.replace(/\\\\r/, '\\r').replace(/\\\\n/, '\\n').replace(/\\\\t/, '\\t');\n  }\n  return result;\n};\n\nOptions.prototype._get_number = function(name, default_value) {\n  var option_value = this.raw_options[name];\n  default_value = parseInt(default_value, 10);\n  if (isNaN(default_value)) {\n    default_value = 0;\n  }\n  var result = parseInt(option_value, 10);\n  if (isNaN(result)) {\n    result = default_value;\n  }\n  return result;\n};\n\nOptions.prototype._get_selection = function(name, selection_list, default_value) {\n  var result = this._get_selection_list(name, selection_list, default_value);\n  if (result.length !== 1) {\n    throw new Error(\n      \"Invalid Option Value: The option '\" + name + \"' can only be one of the following values:\\n\" +\n      selection_list + \"\\nYou passed in: '\" + this.raw_options[name] + \"'\");\n  }\n\n  return result[0];\n};\n\n\nOptions.prototype._get_selection_list = function(name, selection_list, default_value) {\n  if (!selection_list || selection_list.length === 0) {\n    throw new Error(\"Selection list cannot be empty.\");\n  }\n\n  default_value = default_value || [selection_list[0]];\n  if (!this._is_valid_selection(default_value, selection_list)) {\n    throw new Error(\"Invalid Default Value!\");\n  }\n\n  var result = this._get_array(name, default_value);\n  if (!this._is_valid_selection(result, selection_list)) {\n    throw new Error(\n      \"Invalid Option Value: The option '\" + name + \"' can contain only the following values:\\n\" +\n      selection_list + \"\\nYou passed in: '\" + this.raw_options[name] + \"'\");\n  }\n\n  return result;\n};\n\nOptions.prototype._is_valid_selection = function(result, selection_list) {\n  return result.length && selection_list.length &&\n    !result.some(function(item) { return selection_list.indexOf(item) === -1; });\n};\n\n\n// merges child options up with the parent options object\n// Example: obj = {a: 1, b: {a: 2}}\n//          mergeOpts(obj, 'b')\n//\n//          Returns: {a: 2}\nfunction _mergeOpts(allOptions, childFieldName) {\n  var finalOpts = {};\n  allOptions = _normalizeOpts(allOptions);\n  var name;\n\n  for (name in allOptions) {\n    if (name !== childFieldName) {\n      finalOpts[name] = allOptions[name];\n    }\n  }\n\n  //merge in the per type settings for the childFieldName\n  if (childFieldName && allOptions[childFieldName]) {\n    for (name in allOptions[childFieldName]) {\n      finalOpts[name] = allOptions[childFieldName][name];\n    }\n  }\n  return finalOpts;\n}\n\nfunction _normalizeOpts(options) {\n  var convertedOpts = {};\n  var key;\n\n  for (key in options) {\n    var newKey = key.replace(/-/g, \"_\");\n    convertedOpts[newKey] = options[key];\n  }\n  return convertedOpts;\n}\n\nmodule.exports.Options = Options;\nmodule.exports.normalizeOpts = _normalizeOpts;\nmodule.exports.mergeOpts = _mergeOpts;\n","/*jshint node:true */\n/*\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nfunction OutputLine(parent) {\n  this.__parent = parent;\n  this.__character_count = 0;\n  // use indent_count as a marker for this.__lines that have preserved indentation\n  this.__indent_count = -1;\n  this.__alignment_count = 0;\n  this.__wrap_point_index = 0;\n  this.__wrap_point_character_count = 0;\n  this.__wrap_point_indent_count = -1;\n  this.__wrap_point_alignment_count = 0;\n\n  this.__items = [];\n}\n\nOutputLine.prototype.clone_empty = function() {\n  var line = new OutputLine(this.__parent);\n  line.set_indent(this.__indent_count, this.__alignment_count);\n  return line;\n};\n\nOutputLine.prototype.item = function(index) {\n  if (index < 0) {\n    return this.__items[this.__items.length + index];\n  } else {\n    return this.__items[index];\n  }\n};\n\nOutputLine.prototype.has_match = function(pattern) {\n  for (var lastCheckedOutput = this.__items.length - 1; lastCheckedOutput >= 0; lastCheckedOutput--) {\n    if (this.__items[lastCheckedOutput].match(pattern)) {\n      return true;\n    }\n  }\n  return false;\n};\n\nOutputLine.prototype.set_indent = function(indent, alignment) {\n  if (this.is_empty()) {\n    this.__indent_count = indent || 0;\n    this.__alignment_count = alignment || 0;\n    this.__character_count = this.__parent.get_indent_size(this.__indent_count, this.__alignment_count);\n  }\n};\n\nOutputLine.prototype._set_wrap_point = function() {\n  if (this.__parent.wrap_line_length) {\n    this.__wrap_point_index = this.__items.length;\n    this.__wrap_point_character_count = this.__character_count;\n    this.__wrap_point_indent_count = this.__parent.next_line.__indent_count;\n    this.__wrap_point_alignment_count = this.__parent.next_line.__alignment_count;\n  }\n};\n\nOutputLine.prototype._should_wrap = function() {\n  return this.__wrap_point_index &&\n    this.__character_count > this.__parent.wrap_line_length &&\n    this.__wrap_point_character_count > this.__parent.next_line.__character_count;\n};\n\nOutputLine.prototype._allow_wrap = function() {\n  if (this._should_wrap()) {\n    this.__parent.add_new_line();\n    var next = this.__parent.current_line;\n    next.set_indent(this.__wrap_point_indent_count, this.__wrap_point_alignment_count);\n    next.__items = this.__items.slice(this.__wrap_point_index);\n    this.__items = this.__items.slice(0, this.__wrap_point_index);\n\n    next.__character_count += this.__character_count - this.__wrap_point_character_count;\n    this.__character_count = this.__wrap_point_character_count;\n\n    if (next.__items[0] === \" \") {\n      next.__items.splice(0, 1);\n      next.__character_count -= 1;\n    }\n    return true;\n  }\n  return false;\n};\n\nOutputLine.prototype.is_empty = function() {\n  return this.__items.length === 0;\n};\n\nOutputLine.prototype.last = function() {\n  if (!this.is_empty()) {\n    return this.__items[this.__items.length - 1];\n  } else {\n    return null;\n  }\n};\n\nOutputLine.prototype.push = function(item) {\n  this.__items.push(item);\n  var last_newline_index = item.lastIndexOf('\\n');\n  if (last_newline_index !== -1) {\n    this.__character_count = item.length - last_newline_index;\n  } else {\n    this.__character_count += item.length;\n  }\n};\n\nOutputLine.prototype.pop = function() {\n  var item = null;\n  if (!this.is_empty()) {\n    item = this.__items.pop();\n    this.__character_count -= item.length;\n  }\n  return item;\n};\n\n\nOutputLine.prototype._remove_indent = function() {\n  if (this.__indent_count > 0) {\n    this.__indent_count -= 1;\n    this.__character_count -= this.__parent.indent_size;\n  }\n};\n\nOutputLine.prototype._remove_wrap_indent = function() {\n  if (this.__wrap_point_indent_count > 0) {\n    this.__wrap_point_indent_count -= 1;\n  }\n};\nOutputLine.prototype.trim = function() {\n  while (this.last() === ' ') {\n    this.__items.pop();\n    this.__character_count -= 1;\n  }\n};\n\nOutputLine.prototype.toString = function() {\n  var result = '';\n  if (this.is_empty()) {\n    if (this.__parent.indent_empty_lines) {\n      result = this.__parent.get_indent_string(this.__indent_count);\n    }\n  } else {\n    result = this.__parent.get_indent_string(this.__indent_count, this.__alignment_count);\n    result += this.__items.join('');\n  }\n  return result;\n};\n\nfunction IndentStringCache(options, baseIndentString) {\n  this.__cache = [''];\n  this.__indent_size = options.indent_size;\n  this.__indent_string = options.indent_char;\n  if (!options.indent_with_tabs) {\n    this.__indent_string = new Array(options.indent_size + 1).join(options.indent_char);\n  }\n\n  // Set to null to continue support for auto detection of base indent\n  baseIndentString = baseIndentString || '';\n  if (options.indent_level > 0) {\n    baseIndentString = new Array(options.indent_level + 1).join(this.__indent_string);\n  }\n\n  this.__base_string = baseIndentString;\n  this.__base_string_length = baseIndentString.length;\n}\n\nIndentStringCache.prototype.get_indent_size = function(indent, column) {\n  var result = this.__base_string_length;\n  column = column || 0;\n  if (indent < 0) {\n    result = 0;\n  }\n  result += indent * this.__indent_size;\n  result += column;\n  return result;\n};\n\nIndentStringCache.prototype.get_indent_string = function(indent_level, column) {\n  var result = this.__base_string;\n  column = column || 0;\n  if (indent_level < 0) {\n    indent_level = 0;\n    result = '';\n  }\n  column += indent_level * this.__indent_size;\n  this.__ensure_cache(column);\n  result += this.__cache[column];\n  return result;\n};\n\nIndentStringCache.prototype.__ensure_cache = function(column) {\n  while (column >= this.__cache.length) {\n    this.__add_column();\n  }\n};\n\nIndentStringCache.prototype.__add_column = function() {\n  var column = this.__cache.length;\n  var indent = 0;\n  var result = '';\n  if (this.__indent_size && column >= this.__indent_size) {\n    indent = Math.floor(column / this.__indent_size);\n    column -= indent * this.__indent_size;\n    result = new Array(indent + 1).join(this.__indent_string);\n  }\n  if (column) {\n    result += new Array(column + 1).join(' ');\n  }\n\n  this.__cache.push(result);\n};\n\nfunction Output(options, baseIndentString) {\n  this.__indent_cache = new IndentStringCache(options, baseIndentString);\n  this.raw = false;\n  this._end_with_newline = options.end_with_newline;\n  this.indent_size = options.indent_size;\n  this.wrap_line_length = options.wrap_line_length;\n  this.indent_empty_lines = options.indent_empty_lines;\n  this.__lines = [];\n  this.previous_line = null;\n  this.current_line = null;\n  this.next_line = new OutputLine(this);\n  this.space_before_token = false;\n  this.non_breaking_space = false;\n  this.previous_token_wrapped = false;\n  // initialize\n  this.__add_outputline();\n}\n\nOutput.prototype.__add_outputline = function() {\n  this.previous_line = this.current_line;\n  this.current_line = this.next_line.clone_empty();\n  this.__lines.push(this.current_line);\n};\n\nOutput.prototype.get_line_number = function() {\n  return this.__lines.length;\n};\n\nOutput.prototype.get_indent_string = function(indent, column) {\n  return this.__indent_cache.get_indent_string(indent, column);\n};\n\nOutput.prototype.get_indent_size = function(indent, column) {\n  return this.__indent_cache.get_indent_size(indent, column);\n};\n\nOutput.prototype.is_empty = function() {\n  return !this.previous_line && this.current_line.is_empty();\n};\n\nOutput.prototype.add_new_line = function(force_newline) {\n  // never newline at the start of file\n  // otherwise, newline only if we didn't just add one or we're forced\n  if (this.is_empty() ||\n    (!force_newline && this.just_added_newline())) {\n    return false;\n  }\n\n  // if raw output is enabled, don't print additional newlines,\n  // but still return True as though you had\n  if (!this.raw) {\n    this.__add_outputline();\n  }\n  return true;\n};\n\nOutput.prototype.get_code = function(eol) {\n  this.trim(true);\n\n  // handle some edge cases where the last tokens\n  // has text that ends with newline(s)\n  var last_item = this.current_line.pop();\n  if (last_item) {\n    if (last_item[last_item.length - 1] === '\\n') {\n      last_item = last_item.replace(/\\n+$/g, '');\n    }\n    this.current_line.push(last_item);\n  }\n\n  if (this._end_with_newline) {\n    this.__add_outputline();\n  }\n\n  var sweet_code = this.__lines.join('\\n');\n\n  if (eol !== '\\n') {\n    sweet_code = sweet_code.replace(/[\\n]/g, eol);\n  }\n  return sweet_code;\n};\n\nOutput.prototype.set_wrap_point = function() {\n  this.current_line._set_wrap_point();\n};\n\nOutput.prototype.set_indent = function(indent, alignment) {\n  indent = indent || 0;\n  alignment = alignment || 0;\n\n  // Next line stores alignment values\n  this.next_line.set_indent(indent, alignment);\n\n  // Never indent your first output indent at the start of the file\n  if (this.__lines.length > 1) {\n    this.current_line.set_indent(indent, alignment);\n    return true;\n  }\n\n  this.current_line.set_indent();\n  return false;\n};\n\nOutput.prototype.add_raw_token = function(token) {\n  for (var x = 0; x < token.newlines; x++) {\n    this.__add_outputline();\n  }\n  this.current_line.set_indent(-1);\n  this.current_line.push(token.whitespace_before);\n  this.current_line.push(token.text);\n  this.space_before_token = false;\n  this.non_breaking_space = false;\n  this.previous_token_wrapped = false;\n};\n\nOutput.prototype.add_token = function(printable_token) {\n  this.__add_space_before_token();\n  this.current_line.push(printable_token);\n  this.space_before_token = false;\n  this.non_breaking_space = false;\n  this.previous_token_wrapped = this.current_line._allow_wrap();\n};\n\nOutput.prototype.__add_space_before_token = function() {\n  if (this.space_before_token && !this.just_added_newline()) {\n    if (!this.non_breaking_space) {\n      this.set_wrap_point();\n    }\n    this.current_line.push(' ');\n  }\n};\n\nOutput.prototype.remove_indent = function(index) {\n  var output_length = this.__lines.length;\n  while (index < output_length) {\n    this.__lines[index]._remove_indent();\n    index++;\n  }\n  this.current_line._remove_wrap_indent();\n};\n\nOutput.prototype.trim = function(eat_newlines) {\n  eat_newlines = (eat_newlines === undefined) ? false : eat_newlines;\n\n  this.current_line.trim();\n\n  while (eat_newlines && this.__lines.length > 1 &&\n    this.current_line.is_empty()) {\n    this.__lines.pop();\n    this.current_line = this.__lines[this.__lines.length - 1];\n    this.current_line.trim();\n  }\n\n  this.previous_line = this.__lines.length > 1 ?\n    this.__lines[this.__lines.length - 2] : null;\n};\n\nOutput.prototype.just_added_newline = function() {\n  return this.current_line.is_empty();\n};\n\nOutput.prototype.just_added_blankline = function() {\n  return this.is_empty() ||\n    (this.current_line.is_empty() && this.previous_line.is_empty());\n};\n\nOutput.prototype.ensure_empty_line_above = function(starts_with, ends_with) {\n  var index = this.__lines.length - 2;\n  while (index >= 0) {\n    var potentialEmptyLine = this.__lines[index];\n    if (potentialEmptyLine.is_empty()) {\n      break;\n    } else if (potentialEmptyLine.item(0).indexOf(starts_with) !== 0 &&\n      potentialEmptyLine.item(-1) !== ends_with) {\n      this.__lines.splice(index + 1, 0, new OutputLine(this));\n      this.previous_line = this.__lines[this.__lines.length - 2];\n      break;\n    }\n    index--;\n  }\n};\n\nmodule.exports.Output = Output;\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nvar regexp_has_sticky = RegExp.prototype.hasOwnProperty('sticky');\n\nfunction InputScanner(input_string) {\n  this.__input = input_string || '';\n  this.__input_length = this.__input.length;\n  this.__position = 0;\n}\n\nInputScanner.prototype.restart = function() {\n  this.__position = 0;\n};\n\nInputScanner.prototype.back = function() {\n  if (this.__position > 0) {\n    this.__position -= 1;\n  }\n};\n\nInputScanner.prototype.hasNext = function() {\n  return this.__position < this.__input_length;\n};\n\nInputScanner.prototype.next = function() {\n  var val = null;\n  if (this.hasNext()) {\n    val = this.__input.charAt(this.__position);\n    this.__position += 1;\n  }\n  return val;\n};\n\nInputScanner.prototype.peek = function(index) {\n  var val = null;\n  index = index || 0;\n  index += this.__position;\n  if (index >= 0 && index < this.__input_length) {\n    val = this.__input.charAt(index);\n  }\n  return val;\n};\n\n// This is a JavaScript only helper function (not in python)\n// Javascript doesn't have a match method\n// and not all implementation support \"sticky\" flag.\n// If they do not support sticky then both this.match() and this.test() method\n// must get the match and check the index of the match.\n// If sticky is supported and set, this method will use it.\n// Otherwise it will check that global is set, and fall back to the slower method.\nInputScanner.prototype.__match = function(pattern, index) {\n  pattern.lastIndex = index;\n  var pattern_match = pattern.exec(this.__input);\n\n  if (pattern_match && !(regexp_has_sticky && pattern.sticky)) {\n    if (pattern_match.index !== index) {\n      pattern_match = null;\n    }\n  }\n\n  return pattern_match;\n};\n\nInputScanner.prototype.test = function(pattern, index) {\n  index = index || 0;\n  index += this.__position;\n\n  if (index >= 0 && index < this.__input_length) {\n    return !!this.__match(pattern, index);\n  } else {\n    return false;\n  }\n};\n\nInputScanner.prototype.testChar = function(pattern, index) {\n  // test one character regex match\n  var val = this.peek(index);\n  pattern.lastIndex = 0;\n  return val !== null && pattern.test(val);\n};\n\nInputScanner.prototype.match = function(pattern) {\n  var pattern_match = this.__match(pattern, this.__position);\n  if (pattern_match) {\n    this.__position += pattern_match[0].length;\n  } else {\n    pattern_match = null;\n  }\n  return pattern_match;\n};\n\nInputScanner.prototype.read = function(starting_pattern, until_pattern, until_after) {\n  var val = '';\n  var match;\n  if (starting_pattern) {\n    match = this.match(starting_pattern);\n    if (match) {\n      val += match[0];\n    }\n  }\n  if (until_pattern && (match || !starting_pattern)) {\n    val += this.readUntil(until_pattern, until_after);\n  }\n  return val;\n};\n\nInputScanner.prototype.readUntil = function(pattern, until_after) {\n  var val = '';\n  var match_index = this.__position;\n  pattern.lastIndex = this.__position;\n  var pattern_match = pattern.exec(this.__input);\n  if (pattern_match) {\n    match_index = pattern_match.index;\n    if (until_after) {\n      match_index += pattern_match[0].length;\n    }\n  } else {\n    match_index = this.__input_length;\n  }\n\n  val = this.__input.substring(this.__position, match_index);\n  this.__position = match_index;\n  return val;\n};\n\nInputScanner.prototype.readUntilAfter = function(pattern) {\n  return this.readUntil(pattern, true);\n};\n\nInputScanner.prototype.get_regexp = function(pattern, match_from) {\n  var result = null;\n  var flags = 'g';\n  if (match_from && regexp_has_sticky) {\n    flags = 'y';\n  }\n  // strings are converted to regexp\n  if (typeof pattern === \"string\" && pattern !== '') {\n    // result = new RegExp(pattern.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&'), flags);\n    result = new RegExp(pattern, flags);\n  } else if (pattern) {\n    result = new RegExp(pattern.source, flags);\n  }\n  return result;\n};\n\nInputScanner.prototype.get_literal_regexp = function(literal_string) {\n  return RegExp(literal_string.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&'));\n};\n\n/* css beautifier legacy helpers */\nInputScanner.prototype.peekUntilAfter = function(pattern) {\n  var start = this.__position;\n  var val = this.readUntilAfter(pattern);\n  this.__position = start;\n  return val;\n};\n\nInputScanner.prototype.lookBack = function(testVal) {\n  var start = this.__position - 1;\n  return start >= testVal.length && this.__input.substring(start - testVal.length, start)\n    .toLowerCase() === testVal;\n};\n\nmodule.exports.InputScanner = InputScanner;\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nfunction Token(type, text, newlines, whitespace_before) {\n  this.type = type;\n  this.text = text;\n\n  // comments_before are\n  // comments that have a new line before them\n  // and may or may not have a newline after\n  // this is a set of comments before\n  this.comments_before = null; /* inline comment*/\n\n\n  // this.comments_after =  new TokenStream(); // no new line before and newline after\n  this.newlines = newlines || 0;\n  this.whitespace_before = whitespace_before || '';\n  this.parent = null;\n  this.next = null;\n  this.previous = null;\n  this.opened = null;\n  this.closed = null;\n  this.directives = null;\n}\n\n\nmodule.exports.Token = Token;\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nfunction TokenStream(parent_token) {\n  // private\n  this.__tokens = [];\n  this.__tokens_length = this.__tokens.length;\n  this.__position = 0;\n  this.__parent_token = parent_token;\n}\n\nTokenStream.prototype.restart = function() {\n  this.__position = 0;\n};\n\nTokenStream.prototype.isEmpty = function() {\n  return this.__tokens_length === 0;\n};\n\nTokenStream.prototype.hasNext = function() {\n  return this.__position < this.__tokens_length;\n};\n\nTokenStream.prototype.next = function() {\n  var val = null;\n  if (this.hasNext()) {\n    val = this.__tokens[this.__position];\n    this.__position += 1;\n  }\n  return val;\n};\n\nTokenStream.prototype.peek = function(index) {\n  var val = null;\n  index = index || 0;\n  index += this.__position;\n  if (index >= 0 && index < this.__tokens_length) {\n    val = this.__tokens[index];\n  }\n  return val;\n};\n\nTokenStream.prototype.add = function(token) {\n  if (this.__parent_token) {\n    token.parent = this.__parent_token;\n  }\n  this.__tokens.push(token);\n  this.__tokens_length += 1;\n};\n\nmodule.exports.TokenStream = TokenStream;\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nvar Pattern = require('../core/pattern').Pattern;\n\nfunction WhitespacePattern(input_scanner, parent) {\n  Pattern.call(this, input_scanner, parent);\n  if (parent) {\n    this._line_regexp = this._input.get_regexp(parent._line_regexp);\n  } else {\n    this.__set_whitespace_patterns('', '');\n  }\n\n  this.newline_count = 0;\n  this.whitespace_before_token = '';\n}\nWhitespacePattern.prototype = new Pattern();\n\nWhitespacePattern.prototype.__set_whitespace_patterns = function(whitespace_chars, newline_chars) {\n  whitespace_chars += '\\\\t ';\n  newline_chars += '\\\\n\\\\r';\n\n  this._match_pattern = this._input.get_regexp(\n    '[' + whitespace_chars + newline_chars + ']+', true);\n  this._newline_regexp = this._input.get_regexp(\n    '\\\\r\\\\n|[' + newline_chars + ']');\n};\n\nWhitespacePattern.prototype.read = function() {\n  this.newline_count = 0;\n  this.whitespace_before_token = '';\n\n  var resulting_string = this._input.read(this._match_pattern);\n  if (resulting_string === ' ') {\n    this.whitespace_before_token = ' ';\n  } else if (resulting_string) {\n    var matches = this.__split(this._newline_regexp, resulting_string);\n    this.newline_count = matches.length - 1;\n    this.whitespace_before_token = matches[this.newline_count];\n  }\n\n  return resulting_string;\n};\n\nWhitespacePattern.prototype.matching = function(whitespace_chars, newline_chars) {\n  var result = this._create();\n  result.__set_whitespace_patterns(whitespace_chars, newline_chars);\n  result._update();\n  return result;\n};\n\nWhitespacePattern.prototype._create = function() {\n  return new WhitespacePattern(this._input, this);\n};\n\nWhitespacePattern.prototype.__split = function(regexp, input_string) {\n  regexp.lastIndex = 0;\n  var start_index = 0;\n  var result = [];\n  var next_match = regexp.exec(input_string);\n  while (next_match) {\n    result.push(input_string.substring(start_index, next_match.index));\n    start_index = next_match.index + next_match[0].length;\n    next_match = regexp.exec(input_string);\n  }\n\n  if (start_index < input_string.length) {\n    result.push(input_string.substring(start_index, input_string.length));\n  } else {\n    result.push('');\n  }\n\n  return result;\n};\n\n\n\nmodule.exports.WhitespacePattern = WhitespacePattern;\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nfunction Directives(start_block_pattern, end_block_pattern) {\n  start_block_pattern = typeof start_block_pattern === 'string' ? start_block_pattern : start_block_pattern.source;\n  end_block_pattern = typeof end_block_pattern === 'string' ? end_block_pattern : end_block_pattern.source;\n  this.__directives_block_pattern = new RegExp(start_block_pattern + / beautify( \\w+[:]\\w+)+ /.source + end_block_pattern, 'g');\n  this.__directive_pattern = / (\\w+)[:](\\w+)/g;\n\n  this.__directives_end_ignore_pattern = new RegExp(start_block_pattern + /\\sbeautify\\signore:end\\s/.source + end_block_pattern, 'g');\n}\n\nDirectives.prototype.get_directives = function(text) {\n  if (!text.match(this.__directives_block_pattern)) {\n    return null;\n  }\n\n  var directives = {};\n  this.__directive_pattern.lastIndex = 0;\n  var directive_match = this.__directive_pattern.exec(text);\n\n  while (directive_match) {\n    directives[directive_match[1]] = directive_match[2];\n    directive_match = this.__directive_pattern.exec(text);\n  }\n\n  return directives;\n};\n\nDirectives.prototype.readIgnored = function(input) {\n  return input.readUntilAfter(this.__directives_end_ignore_pattern);\n};\n\n\nmodule.exports.Directives = Directives;\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nvar Pattern = require('./pattern').Pattern;\n\n\nvar template_names = {\n  django: false,\n  erb: false,\n  handlebars: false,\n  php: false\n};\n\n// This lets templates appear anywhere we would do a readUntil\n// The cost is higher but it is pay to play.\nfunction TemplatablePattern(input_scanner, parent) {\n  Pattern.call(this, input_scanner, parent);\n  this.__template_pattern = null;\n  this._disabled = Object.assign({}, template_names);\n  this._excluded = Object.assign({}, template_names);\n\n  if (parent) {\n    this.__template_pattern = this._input.get_regexp(parent.__template_pattern);\n    this._excluded = Object.assign(this._excluded, parent._excluded);\n    this._disabled = Object.assign(this._disabled, parent._disabled);\n  }\n  var pattern = new Pattern(input_scanner);\n  this.__patterns = {\n    handlebars_comment: pattern.starting_with(/{{!--/).until_after(/--}}/),\n    handlebars_unescaped: pattern.starting_with(/{{{/).until_after(/}}}/),\n    handlebars: pattern.starting_with(/{{/).until_after(/}}/),\n    php: pattern.starting_with(/<\\?(?:[=]|php)/).until_after(/\\?>/),\n    erb: pattern.starting_with(/<%[^%]/).until_after(/[^%]%>/),\n    // django coflicts with handlebars a bit.\n    django: pattern.starting_with(/{%/).until_after(/%}/),\n    django_value: pattern.starting_with(/{{/).until_after(/}}/),\n    django_comment: pattern.starting_with(/{#/).until_after(/#}/)\n  };\n}\nTemplatablePattern.prototype = new Pattern();\n\nTemplatablePattern.prototype._create = function() {\n  return new TemplatablePattern(this._input, this);\n};\n\nTemplatablePattern.prototype._update = function() {\n  this.__set_templated_pattern();\n};\n\nTemplatablePattern.prototype.disable = function(language) {\n  var result = this._create();\n  result._disabled[language] = true;\n  result._update();\n  return result;\n};\n\nTemplatablePattern.prototype.read_options = function(options) {\n  var result = this._create();\n  for (var language in template_names) {\n    result._disabled[language] = options.templating.indexOf(language) === -1;\n  }\n  result._update();\n  return result;\n};\n\nTemplatablePattern.prototype.exclude = function(language) {\n  var result = this._create();\n  result._excluded[language] = true;\n  result._update();\n  return result;\n};\n\nTemplatablePattern.prototype.read = function() {\n  var result = '';\n  if (this._match_pattern) {\n    result = this._input.read(this._starting_pattern);\n  } else {\n    result = this._input.read(this._starting_pattern, this.__template_pattern);\n  }\n  var next = this._read_template();\n  while (next) {\n    if (this._match_pattern) {\n      next += this._input.read(this._match_pattern);\n    } else {\n      next += this._input.readUntil(this.__template_pattern);\n    }\n    result += next;\n    next = this._read_template();\n  }\n\n  if (this._until_after) {\n    result += this._input.readUntilAfter(this._until_pattern);\n  }\n  return result;\n};\n\nTemplatablePattern.prototype.__set_templated_pattern = function() {\n  var items = [];\n\n  if (!this._disabled.php) {\n    items.push(this.__patterns.php._starting_pattern.source);\n  }\n  if (!this._disabled.handlebars) {\n    items.push(this.__patterns.handlebars._starting_pattern.source);\n  }\n  if (!this._disabled.erb) {\n    items.push(this.__patterns.erb._starting_pattern.source);\n  }\n  if (!this._disabled.django) {\n    items.push(this.__patterns.django._starting_pattern.source);\n    items.push(this.__patterns.django_value._starting_pattern.source);\n    items.push(this.__patterns.django_comment._starting_pattern.source);\n  }\n\n  if (this._until_pattern) {\n    items.push(this._until_pattern.source);\n  }\n  this.__template_pattern = this._input.get_regexp('(?:' + items.join('|') + ')');\n};\n\nTemplatablePattern.prototype._read_template = function() {\n  var resulting_string = '';\n  var c = this._input.peek();\n  if (c === '<') {\n    var peek1 = this._input.peek(1);\n    //if we're in a comment, do something special\n    // We treat all comments as literals, even more than preformatted tags\n    // we just look for the appropriate close tag\n    if (!this._disabled.php && !this._excluded.php && peek1 === '?') {\n      resulting_string = resulting_string ||\n        this.__patterns.php.read();\n    }\n    if (!this._disabled.erb && !this._excluded.erb && peek1 === '%') {\n      resulting_string = resulting_string ||\n        this.__patterns.erb.read();\n    }\n  } else if (c === '{') {\n    if (!this._disabled.handlebars && !this._excluded.handlebars) {\n      resulting_string = resulting_string ||\n        this.__patterns.handlebars_comment.read();\n      resulting_string = resulting_string ||\n        this.__patterns.handlebars_unescaped.read();\n      resulting_string = resulting_string ||\n        this.__patterns.handlebars.read();\n    }\n    if (!this._disabled.django) {\n      // django coflicts with handlebars a bit.\n      if (!this._excluded.django && !this._excluded.handlebars) {\n        resulting_string = resulting_string ||\n          this.__patterns.django_value.read();\n      }\n      if (!this._excluded.django) {\n        resulting_string = resulting_string ||\n          this.__patterns.django_comment.read();\n        resulting_string = resulting_string ||\n          this.__patterns.django.read();\n      }\n    }\n  }\n  return resulting_string;\n};\n\n\nmodule.exports.TemplatablePattern = TemplatablePattern;\n","import React from \"react\";\nimport AceEditor from \"react-ace\";\nimport { Callbacks } from \"../../App\";\n\nimport \"./editor.css\";\n\nimport \"ace-builds/src-noconflict/mode-jsx\";\nimport \"ace-builds/src-noconflict/mode-html\";\nimport \"ace-builds/src-noconflict/theme-monokai\";\nimport \"ace-builds/src-min-noconflict/ext-language_tools\";\nimport \"ace-builds/src-noconflict/snippets/html\";\nimport \"ace-builds/src-noconflict/snippets/javascript\";\nimport \"ace-builds/src-noconflict/snippets/css\";\n\nconst themes = [\n    \"monokai\",\n    \"github\",\n    \"tomorrow\",\n    \"kuroir\",\n    \"twilight\",\n    \"xcode\",\n    \"textmate\",\n    \"solarized_dark\",\n    \"solarized_light\",\n    \"terminal\"\n];\n\n\nthemes.forEach(theme => require(`ace-builds/src-noconflict/theme-${theme}`));\n\ninterface EditorProps {\n    value: string,\n    callbacks: Callbacks\n}\n\ninterface EditorState {\n    theme: string,\n}\n\nexport default class Editor extends React.Component<EditorProps, EditorState> {\n    constructor(props: any) {\n        super(props);\n        this.state = {\n            theme: \"monokai\",\n        }\n        this.setTheme = this.setTheme.bind(this);\n    }\n\n    setTheme(theme: string) {\n        this.setState({\n            theme: theme\n        });\n    }\n\n    render() {\n        let commands = [{\n            name: \"format\",\n            bindKey: {\n                win: \"Ctrl-Space\",\n                mac: \"Command-Space\"\n            },\n            exec: this.props.callbacks.format\n        }, {\n            name: \"save\",\n            bindKey: {\n                win: \"Ctrl-Shift-Space\",\n                mac: \"Command-Shift-Space\"\n            },\n            exec: this.props.callbacks.save\n        },\n        ];\n        return (\n            <AceEditor \n                placeholder=\"source code\" \n                mode=\"html\" \n                theme = {this.state.theme}\n                onChange={this.props.callbacks.change}\n                name = \"editor\"\n                editorProps={{$blockScrolling: true}}\n                value={this.props.value}\n                commands = {commands}\n                width=\"45vw\"\n                height=\"85vh\"\n                enableBasicAutocompletion enableLiveAutocompletion enableSnippets wrapEnabled\n            />\n        );\n    }\n}","import React from \"react\";\nimport Reveal from \"reveal.js\";\nimport \"reveal.js/dist/reveal.css\";\nimport \"reveal.js/dist/theme/black.css\";\n\ninterface PreviewProps {\n    content: string,\n    versionCallback: any\n}\n\ninterface PreviewState {\n    reveal: any,\n    content: string\n}\n\nexport default class Preview extends React.Component<PreviewProps, PreviewState> {\n    componentDidMount() {\n        let reveal = new Reveal();\n        reveal.initialize();\n        this.setState({reveal: reveal, content: this.props.content});\n        this.props.versionCallback(reveal.VERSION);\n    }\n\n    componentDidUpdate() {\n        // TODO is there a better way to do this?\n        let content = this.props.content;\n        if (this.state.content !== content) {\n            this.setState({content})\n            this.state.reveal.toggleOverview();\n            this.state.reveal.toggleOverview();\n            //this.state.reveal.sync();\n        }\n    }\n\n    render() {\n        return (\n            <div>\n                <link rel=\"stylesheet\" href=\"/node_modules/reveal.js/dist/reveal.css\" />\n                <link rel=\"stylesheet\" href=\"/node_modules/reveal.js/dist/theme/black.css\" />\n                <div className=\"reveal\" style={{position: \"absolute\", left: \"50%\", top: 0, width: \"50%\", height: \"80%\"}}>\n                    <div className=\"slides\" dangerouslySetInnerHTML={{__html: this.props.content}} />\n                </div> \n            </div>\n        );\n    }\n}","import React from \"react\";\nimport \"./item.css\";\n\nexport interface ItemOptions {\n    text: string,\n    onClick: any\n}\n\ninterface ItemState {\n    // nothing\n}\n\nexport class Item extends React.Component<ItemOptions, ItemState> {\n    render() {\n        return (\n            <div className=\"menu-item\" onClick={this.props.onClick}>\n                <p>{this.props.text}</p>\n            </div>\n        );\n    }\n}","import React from \"react\";\nimport \"./bar.css\";\nimport { Callbacks } from \"../../../App\";\nimport { ItemOptions, Item } from \"../item/item\";\n\ninterface BarProps {\n    callbacks: Callbacks\n}\n\ninterface BarState {\n    // nothing\n}\n\n\nexport default class Bar extends React.Component<BarProps, BarState> {\n    createItem(text: string, onClick: any) {\n        return {\n            text,\n            onClick\n        };\n    }\n\n    render() {\n        const items: ItemOptions[] = [\n            this.createItem(\"Save\", this.props.callbacks.save),\n            this.createItem(\"Format\", this.props.callbacks.format)\n        ];\n\n        return (\n            <div className=\"menubar\">\n                {items.map(item => <Item text={item.text} onClick={item.onClick} />)}\n            </div>\n        );\n    }\n}","function noop() {\n    // do nothing\n}\n\nconst assert: (test: boolean) => void = noop;\nexport default assert;\n","// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isNaN#Polyfill\nconst NumberIsNaN: typeof Number.isNaN = Number.isNaN || function (x) {\n  // eslint-disable-next-line no-self-compare\n  return x !== x;\n};\n\nexport default NumberIsNaN;\n","import assert from '../stub/assert';\nimport NumberIsNaN from '../stub/number-isnan';\nimport { FunctionPropertyNames, InferFirst, InferFunction, InferRest, Promisify } from '../util/type-utils';\n\nfunction IsPropertyKey(argument: any): argument is string | symbol {\n  return typeof argument === 'string' || typeof argument === 'symbol';\n}\n\nexport function typeIsObject(x: any): x is object {\n  return (typeof x === 'object' && x !== null) || typeof x === 'function';\n}\n\nexport function createDataProperty(o: object, p: string | symbol, v: any) {\n  assert(typeIsObject(o));\n  Object.defineProperty(o, p, { value: v, writable: true, enumerable: true, configurable: true });\n}\n\nexport function createArrayFromList<T extends any[]>(elements: T): T {\n  // We use arrays to represent lists, so this is basically a no-op.\n  // Do a slice though just in case we happen to depend on the unique-ness.\n  return elements.slice() as T;\n}\n\nexport function ArrayBufferCopy(dest: ArrayBuffer, destOffset: number, src: ArrayBuffer, srcOffset: number, n: number) {\n  new Uint8Array(dest).set(new Uint8Array(src, srcOffset, n), destOffset);\n}\n\nexport function IsFiniteNonNegativeNumber(v: number): boolean {\n  if (IsNonNegativeNumber(v) === false) {\n    return false;\n  }\n\n  if (v === Infinity) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function IsNonNegativeNumber(v: number): boolean {\n  if (typeof v !== 'number') {\n    return false;\n  }\n\n  if (NumberIsNaN(v)) {\n    return false;\n  }\n\n  if (v < 0) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function Call<T, A extends any[], R>(F: (this: T, ...args: A) => R, V: T, args: A): R {\n  if (typeof F !== 'function') {\n    throw new TypeError('Argument is not a function');\n  }\n\n  return Function.prototype.apply.call(F, V, args);\n}\n\nexport function CreateAlgorithmFromUnderlyingMethod<T,\n  Key extends FunctionPropertyNames<Required<T>> = FunctionPropertyNames<Required<T>>>(\n  underlyingObject: T,\n  methodName: Key,\n  algoArgCount: 0,\n  extraArgs: Parameters<InferFunction<T[Key]>>): () => Promisify<ReturnType<InferFunction<T[Key]>>>;\nexport function CreateAlgorithmFromUnderlyingMethod<T,\n  Key extends FunctionPropertyNames<Required<T>> = FunctionPropertyNames<Required<T>>>(\n  underlyingObject: T,\n  methodName: Key,\n  algoArgCount: 1,\n  extraArgs: InferRest<Parameters<InferFunction<T[Key]>>>): (arg: InferFirst<Parameters<InferFunction<T[Key]>>>) => Promisify<ReturnType<InferFunction<T[Key]>>>;\nexport function CreateAlgorithmFromUnderlyingMethod(underlyingObject: any,\n                                                    methodName: any,\n                                                    algoArgCount: 0 | 1,\n                                                    extraArgs: any[]): (...args: any[]) => any {\n  assert(underlyingObject !== undefined);\n  assert(IsPropertyKey(methodName));\n  assert(algoArgCount === 0 || algoArgCount === 1);\n  assert(Array.isArray(extraArgs));\n  const method = underlyingObject[methodName];\n  if (method !== undefined) {\n    if (typeof method !== 'function') {\n      throw new TypeError(`${method} is not a method`);\n    }\n    switch (algoArgCount) {\n      case 0: {\n        return () => {\n          return PromiseCall(method, underlyingObject, extraArgs);\n        };\n      }\n\n      case 1: {\n        return arg => {\n          const fullArgs = [arg].concat(extraArgs);\n          return PromiseCall(method, underlyingObject, fullArgs);\n        };\n      }\n    }\n  }\n  return () => Promise.resolve();\n}\n\nexport function InvokeOrNoop<T, Key extends FunctionPropertyNames<Required<T>> = FunctionPropertyNames<Required<T>>>(\n  O: T,\n  P: Key,\n  args: Parameters<InferFunction<T[Key]>>): ReturnType<InferFunction<T[Key]>> | undefined {\n  assert(O !== undefined);\n  assert(IsPropertyKey(P));\n  assert(Array.isArray(args));\n\n  const method = O[P] as InferFunction<T[Key]> | undefined;\n  if (method === undefined) {\n    return undefined;\n  }\n\n  return Call(method, O, args);\n}\n\nexport function PromiseCall<T, A extends any[], R>(F: (this: T, ...args: A) => R | PromiseLike<R>,\n                                                   V: T,\n                                                   args: A): Promise<R> {\n  assert(typeof F === 'function');\n  assert(V !== undefined);\n  assert(Array.isArray(args));\n  try {\n    return Promise.resolve(Call(F, V, args));\n  } catch (value) {\n    return Promise.reject(value);\n  }\n}\n\n// Not implemented correctly\nexport function TransferArrayBuffer<T extends ArrayBufferLike>(O: T): T {\n  return O;\n}\n\n// Not implemented correctly\nexport function IsDetachedBuffer(O: ArrayBufferLike): boolean { // eslint-disable-line @typescript-eslint/no-unused-vars\n  return false;\n}\n\nexport function ValidateAndNormalizeHighWaterMark(highWaterMark: number): number {\n  highWaterMark = Number(highWaterMark);\n  if (NumberIsNaN(highWaterMark) || highWaterMark < 0) {\n    throw new RangeError('highWaterMark property of a queuing strategy must be non-negative and non-NaN');\n  }\n\n  return highWaterMark;\n}\n\nexport function MakeSizeAlgorithmFromSizeFunction<T>(size?: (chunk: T) => number): (chunk: T) => number {\n  if (size === undefined) {\n    return () => 1;\n  }\n  if (typeof size !== 'function') {\n    throw new TypeError('size property of a queuing strategy must be a function');\n  }\n  return chunk => size(chunk);\n}\n\nexport function PerformPromiseThen<T>(promise: Promise<T>,\n                                      onFulfilled: (result: T) => any,\n                                      onRejected: (reason: any) => any) {\n  // There doesn't appear to be any way to correctly emulate the behaviour from JavaScript, so this is just an\n  // approximation.\n  return Promise.prototype.then.call(promise, onFulfilled, onRejected);\n}\n\nexport function WaitForAll<T>(promises: Array<Promise<T>>,\n                              successSteps: (results: T[]) => void,\n                              failureSteps: (reason: any) => void) {\n  let rejected = false;\n  const rejectionHandler = (arg: any) => {\n    if (rejected === false) {\n      rejected = true;\n      failureSteps(arg);\n    }\n  };\n  let index = 0;\n  let fulfilledCount = 0;\n  const total = promises.length;\n  const result = new Array<T>(total);\n  for (const promise of promises) {\n    const promiseIndex = index;\n    // eslint-disable-next-line\n    const fulfillmentHandler = (arg: T) => {\n      result[promiseIndex] = arg;\n      ++fulfilledCount;\n      if (fulfilledCount === total) {\n        successSteps(result);\n      }\n    };\n    PerformPromiseThen(promise, fulfillmentHandler, rejectionHandler);\n    ++index;\n  }\n}\n\nexport function WaitForAllPromise<T, R>(promises: Array<Promise<T>>,\n                                        successSteps: (results: T[]) => R,\n                                        failureSteps: ((reason: any) => R) | undefined = undefined): Promise<R> {\n  let resolvePromise: (result: R) => void;\n  let rejectPromise: (reason: any) => void;\n  const promise = new Promise<R>((resolve, reject) => {\n    resolvePromise = resolve;\n    rejectPromise = reject;\n  });\n  if (failureSteps === undefined) {\n    failureSteps = arg => {\n      throw arg;\n    };\n  }\n  const successStepsWrapper = (results: T[]) => {\n    try {\n      const stepsResult = successSteps(results);\n      resolvePromise(stepsResult);\n    } catch (e) {\n      rejectPromise(e);\n    }\n  };\n  const failureStepsWrapper = (reason: any) => {\n    try {\n      const stepsResult = failureSteps!(reason);\n      resolvePromise(stepsResult);\n    } catch (e) {\n      rejectPromise(e);\n    }\n  };\n  WaitForAll(promises, successStepsWrapper, failureStepsWrapper);\n  return promise;\n}\n","\nfunction noop() {\n    // do nothing\n}\n\nexport const rethrowAssertionErrorRejection: (e: any) => void = noop;\n","import assert from '../stub/assert';\n\n// Original from Chromium\n// https://chromium.googlesource.com/chromium/src/+/0aee4434a4dba42a42abaea9bfbc0cd196a63bc1/third_party/blink/renderer/core/streams/SimpleQueue.js\n\nconst QUEUE_MAX_ARRAY_SIZE = 16384;\n\ninterface Node<T> {\n  _elements: T[];\n  _next: Node<T> | undefined;\n}\n\n/**\n * Simple queue structure.\n *\n * Avoids scalability issues with using a packed array directly by using\n * multiple arrays in a linked list and keeping the array size bounded.\n */\nexport class SimpleQueue<T> {\n  private _front: Node<T>;\n  private _back: Node<T>;\n  private _cursor: number = 0;\n  private _size: number = 0;\n\n  constructor() {\n    // _front and _back are always defined.\n    this._front = {\n      _elements: [],\n      _next: undefined\n    };\n    this._back = this._front;\n    // The cursor is used to avoid calling Array.shift().\n    // It contains the index of the front element of the array inside the\n    // front-most node. It is always in the range [0, QUEUE_MAX_ARRAY_SIZE).\n    this._cursor = 0;\n    // When there is only one node, size === elements.length - cursor.\n    this._size = 0;\n  }\n\n  get length(): number {\n    return this._size;\n  }\n\n  // For exception safety, this method is structured in order:\n  // 1. Read state\n  // 2. Calculate required state mutations\n  // 3. Perform state mutations\n  push(element: T): void {\n    const oldBack = this._back;\n    let newBack = oldBack;\n    assert(oldBack._next === undefined);\n    if (oldBack._elements.length === QUEUE_MAX_ARRAY_SIZE - 1) {\n      newBack = {\n        _elements: [],\n        _next: undefined\n      };\n    }\n\n    // push() is the mutation most likely to throw an exception, so it\n    // goes first.\n    oldBack._elements.push(element);\n    if (newBack !== oldBack) {\n      this._back = newBack;\n      oldBack._next = newBack;\n    }\n    ++this._size;\n  }\n\n  // Like push(), shift() follows the read -> calculate -> mutate pattern for\n  // exception safety.\n  shift(): T {\n    assert(this._size > 0); // must not be called on an empty queue\n\n    const oldFront = this._front;\n    let newFront = oldFront;\n    const oldCursor = this._cursor;\n    let newCursor = oldCursor + 1;\n\n    const elements = oldFront._elements;\n    const element = elements[oldCursor];\n\n    if (newCursor === QUEUE_MAX_ARRAY_SIZE) {\n      assert(elements.length === QUEUE_MAX_ARRAY_SIZE);\n      assert(oldFront._next !== undefined);\n      newFront = oldFront._next!;\n      newCursor = 0;\n    }\n\n    // No mutations before this point.\n    --this._size;\n    this._cursor = newCursor;\n    if (oldFront !== newFront) {\n      this._front = newFront;\n    }\n\n    // Permit shifted element to be garbage collected.\n    elements[oldCursor] = undefined!;\n\n    return element;\n  }\n\n  // The tricky thing about forEach() is that it can be called\n  // re-entrantly. The queue may be mutated inside the callback. It is easy to\n  // see that push() within the callback has no negative effects since the end\n  // of the queue is checked for on every iteration. If shift() is called\n  // repeatedly within the callback then the next iteration may return an\n  // element that has been removed. In this case the callback will be called\n  // with undefined values until we either \"catch up\" with elements that still\n  // exist or reach the back of the queue.\n  forEach(callback: (element: T) => void): void {\n    let i = this._cursor;\n    let node = this._front;\n    let elements = node._elements;\n    while (i !== elements.length || node._next !== undefined) {\n      if (i === elements.length) {\n        assert(node._next !== undefined);\n        assert(i === QUEUE_MAX_ARRAY_SIZE);\n        node = node._next!;\n        elements = node._elements;\n        i = 0;\n        if (elements.length === 0) {\n          break;\n        }\n      }\n      callback(elements[i]);\n      ++i;\n    }\n  }\n\n  // Return the element that would be returned if shift() was called now,\n  // without modifying the queue.\n  peek() {\n    assert(this._size > 0); // must not be called on an empty queue\n\n    const front = this._front;\n    const cursor = this._cursor;\n    return front._elements[cursor];\n  }\n}\n","import assert from '../stub/assert';\nimport { IsFiniteNonNegativeNumber } from './helpers';\nimport { SimpleQueue } from './simple-queue';\n\nexport interface QueueContainer<T> {\n  _queue: SimpleQueue<T>;\n  _queueTotalSize: number;\n}\n\nexport interface QueuePair<T> {\n  value: T;\n  size: number;\n}\n\nexport function DequeueValue<T>(container: QueueContainer<QueuePair<T>>): T {\n  assert('_queue' in container && '_queueTotalSize' in container);\n  assert(container._queue.length > 0);\n\n  const pair = container._queue.shift()!;\n  container._queueTotalSize -= pair.size;\n  if (container._queueTotalSize < 0) {\n    container._queueTotalSize = 0;\n  }\n\n  return pair.value;\n}\n\nexport function EnqueueValueWithSize<T>(container: QueueContainer<QueuePair<T>>, value: T, size: number) {\n  assert('_queue' in container && '_queueTotalSize' in container);\n\n  size = Number(size);\n  if (!IsFiniteNonNegativeNumber(size)) {\n    throw new RangeError('Size must be a finite, non-NaN, non-negative number.');\n  }\n\n  container._queue.push({ value, size });\n  container._queueTotalSize += size;\n}\n\nexport function PeekQueueValue<T>(container: QueueContainer<QueuePair<T>>): T {\n  assert('_queue' in container && '_queueTotalSize' in container);\n  assert(container._queue.length > 0);\n\n  const pair = container._queue.peek();\n  return pair.value;\n}\n\nexport function ResetQueue<T>(container: QueueContainer<T>) {\n  assert('_queue' in container && '_queueTotalSize' in container);\n\n  container._queue = new SimpleQueue<T>();\n  container._queueTotalSize = 0;\n}\n","import assert from '../stub/assert';\nimport {\n  CreateAlgorithmFromUnderlyingMethod,\n  InvokeOrNoop,\n  IsNonNegativeNumber,\n  MakeSizeAlgorithmFromSizeFunction,\n  typeIsObject,\n  ValidateAndNormalizeHighWaterMark\n} from './helpers';\nimport { rethrowAssertionErrorRejection } from './utils';\nimport { DequeueValue, EnqueueValueWithSize, PeekQueueValue, QueuePair, ResetQueue } from './queue-with-sizes';\nimport { QueuingStrategy, QueuingStrategySizeCallback } from './queuing-strategy';\nimport { SimpleQueue } from './simple-queue';\n\nconst AbortSteps = Symbol('[[AbortSteps]]');\nconst ErrorSteps = Symbol('[[ErrorSteps]]');\n\ntype WritableStreamDefaultControllerStartCallback = (controller: WritableStreamDefaultController) => void | PromiseLike<void>;\ntype WritableStreamDefaultControllerWriteCallback<W> = (chunk: W,\n  controller: WritableStreamDefaultController) => void | PromiseLike<void>;\ntype WritableStreamDefaultControllerCloseCallback = () => void | PromiseLike<void>;\ntype WritableStreamErrorCallback = (reason: any) => void | PromiseLike<void>;\n\nexport interface UnderlyingSink<W = any> {\n  start?: WritableStreamDefaultControllerStartCallback;\n  write?: WritableStreamDefaultControllerWriteCallback<W>;\n  close?: WritableStreamDefaultControllerCloseCallback;\n  abort?: WritableStreamErrorCallback;\n  type?: undefined;\n}\n\ntype WritableStreamState = 'writable' | 'closed' | 'erroring' | 'errored';\n\ninterface WriteOrCloseRequest {\n  _resolve: (value?: undefined) => void;\n  _reject: (reason: any) => void;\n}\n\ntype WriteRequest = WriteOrCloseRequest;\ntype CloseRequest = WriteOrCloseRequest;\n\ninterface PendingAbortRequest {\n  _promise: Promise<void>;\n  _resolve: () => void;\n  _reject: (reason: any) => void;\n  _reason: any;\n  _wasAlreadyErroring: boolean;\n}\n\nclass WritableStream<W = any> {\n  /** @internal */\n  _state!: WritableStreamState;\n  /** @internal */\n  _storedError: any;\n  /** @internal */\n  _writer: WritableStreamDefaultWriter<W> | undefined;\n  /** @internal */\n  _writableStreamController!: WritableStreamDefaultController<W>;\n  /** @internal */\n  _writeRequests!: SimpleQueue<WriteRequest>;\n  /** @internal */\n  _inFlightWriteRequest: WriteRequest | undefined;\n  /** @internal */\n  _closeRequest: CloseRequest | undefined;\n  /** @internal */\n  _inFlightCloseRequest: CloseRequest | undefined;\n  /** @internal */\n  _pendingAbortRequest: PendingAbortRequest | undefined;\n  /** @internal */\n  _backpressure!: boolean;\n\n  constructor(underlyingSink: UnderlyingSink<W> = {}, strategy: QueuingStrategy<W> = {}) {\n    InitializeWritableStream(this);\n\n    const size = strategy.size;\n    let highWaterMark = strategy.highWaterMark;\n\n    const type = underlyingSink.type;\n\n    if (type !== undefined) {\n      throw new RangeError('Invalid type is specified');\n    }\n\n    const sizeAlgorithm = MakeSizeAlgorithmFromSizeFunction(size);\n    if (highWaterMark === undefined) {\n      highWaterMark = 1;\n    }\n    highWaterMark = ValidateAndNormalizeHighWaterMark(highWaterMark);\n\n    SetUpWritableStreamDefaultControllerFromUnderlyingSink(this, underlyingSink, highWaterMark, sizeAlgorithm);\n  }\n\n  get locked(): boolean {\n    if (IsWritableStream(this) === false) {\n      throw streamBrandCheckException('locked');\n    }\n\n    return IsWritableStreamLocked(this);\n  }\n\n  abort(reason: any): Promise<void> {\n    if (IsWritableStream(this) === false) {\n      return Promise.reject(streamBrandCheckException('abort'));\n    }\n\n    if (IsWritableStreamLocked(this) === true) {\n      return Promise.reject(new TypeError('Cannot abort a stream that already has a writer'));\n    }\n\n    return WritableStreamAbort(this, reason);\n  }\n\n  getWriter(): WritableStreamDefaultWriter<W> {\n    if (IsWritableStream(this) === false) {\n      throw streamBrandCheckException('getWriter');\n    }\n\n    return AcquireWritableStreamDefaultWriter(this);\n  }\n}\n\nexport {\n  AcquireWritableStreamDefaultWriter,\n  CreateWritableStream,\n  IsWritableStream,\n  IsWritableStreamLocked,\n  WritableStream,\n  WritableStreamAbort,\n  WritableStreamDefaultControllerErrorIfNeeded,\n  WritableStreamDefaultWriterCloseWithErrorPropagation,\n  WritableStreamDefaultWriterRelease,\n  WritableStreamDefaultWriterWrite,\n  WritableStreamCloseQueuedOrInFlight\n};\n\n// Abstract operations for the WritableStream.\n\nfunction AcquireWritableStreamDefaultWriter<W>(stream: WritableStream<W>): WritableStreamDefaultWriter<W> {\n  return new WritableStreamDefaultWriter(stream);\n}\n\n// Throws if and only if startAlgorithm throws.\nfunction CreateWritableStream<W>(startAlgorithm: () => void | PromiseLike<void>,\n                                 writeAlgorithm: (chunk: W) => Promise<void>,\n                                 closeAlgorithm: () => Promise<void>,\n                                 abortAlgorithm: (reason: any) => Promise<void>,\n                                 highWaterMark: number = 1,\n                                 sizeAlgorithm: QueuingStrategySizeCallback<W> = () => 1) {\n  assert(IsNonNegativeNumber(highWaterMark) === true);\n\n  const stream: WritableStream<W> = Object.create(WritableStream.prototype);\n  InitializeWritableStream(stream);\n\n  const controller: WritableStreamDefaultController<W> = Object.create(WritableStreamDefaultController.prototype);\n\n  SetUpWritableStreamDefaultController(stream, controller, startAlgorithm, writeAlgorithm, closeAlgorithm,\n                                       abortAlgorithm, highWaterMark, sizeAlgorithm);\n  return stream;\n}\n\nfunction InitializeWritableStream<W>(stream: WritableStream<W>) {\n  stream._state = 'writable';\n\n  // The error that will be reported by new method calls once the state becomes errored. Only set when [[state]] is\n  // 'erroring' or 'errored'. May be set to an undefined value.\n  stream._storedError = undefined;\n\n  stream._writer = undefined;\n\n  // Initialize to undefined first because the constructor of the controller checks this\n  // variable to validate the caller.\n  stream._writableStreamController = undefined!;\n\n  // This queue is placed here instead of the writer class in order to allow for passing a writer to the next data\n  // producer without waiting for the queued writes to finish.\n  stream._writeRequests = new SimpleQueue();\n\n  // Write requests are removed from _writeRequests when write() is called on the underlying sink. This prevents\n  // them from being erroneously rejected on error. If a write() call is in-flight, the request is stored here.\n  stream._inFlightWriteRequest = undefined;\n\n  // The promise that was returned from writer.close(). Stored here because it may be fulfilled after the writer\n  // has been detached.\n  stream._closeRequest = undefined;\n\n  // Close request is removed from _closeRequest when close() is called on the underlying sink. This prevents it\n  // from being erroneously rejected on error. If a close() call is in-flight, the request is stored here.\n  stream._inFlightCloseRequest = undefined;\n\n  // The promise that was returned from writer.abort(). This may also be fulfilled after the writer has detached.\n  stream._pendingAbortRequest = undefined;\n\n  // The backpressure signal set by the controller.\n  stream._backpressure = false;\n}\n\nfunction IsWritableStream<W>(x: any): x is WritableStream<W> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_writableStreamController')) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction IsWritableStreamLocked(stream: WritableStream): boolean {\n  assert(IsWritableStream(stream) === true);\n\n  if (stream._writer === undefined) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction WritableStreamAbort(stream: WritableStream, reason: any): Promise<void> {\n  const state = stream._state;\n  if (state === 'closed' || state === 'errored') {\n    return Promise.resolve(undefined);\n  }\n  if (stream._pendingAbortRequest !== undefined) {\n    return stream._pendingAbortRequest._promise;\n  }\n\n  assert(state === 'writable' || state === 'erroring');\n\n  let wasAlreadyErroring = false;\n  if (state === 'erroring') {\n    wasAlreadyErroring = true;\n    // reason will not be used, so don't keep a reference to it.\n    reason = undefined;\n  }\n\n  const promise = new Promise<void>((resolve, reject) => {\n    stream._pendingAbortRequest = {\n      _promise: undefined!,\n      _resolve: resolve,\n      _reject: reject,\n      _reason: reason,\n      _wasAlreadyErroring: wasAlreadyErroring\n    };\n  });\n  stream._pendingAbortRequest!._promise = promise;\n\n  if (wasAlreadyErroring === false) {\n    WritableStreamStartErroring(stream, reason);\n  }\n\n  return promise;\n}\n\n// WritableStream API exposed for controllers.\n\nfunction WritableStreamAddWriteRequest(stream: WritableStream): Promise<void> {\n  assert(IsWritableStreamLocked(stream) === true);\n  assert(stream._state === 'writable');\n\n  const promise = new Promise<void>((resolve, reject) => {\n    const writeRequest: WriteRequest = {\n      _resolve: resolve,\n      _reject: reject\n    };\n\n    stream._writeRequests.push(writeRequest);\n  });\n\n  return promise;\n}\n\nfunction WritableStreamDealWithRejection(stream: WritableStream, error: any) {\n  const state = stream._state;\n\n  if (state === 'writable') {\n    WritableStreamStartErroring(stream, error);\n    return;\n  }\n\n  assert(state === 'erroring');\n  WritableStreamFinishErroring(stream);\n}\n\nfunction WritableStreamStartErroring(stream: WritableStream, reason: any) {\n  assert(stream._storedError === undefined);\n  assert(stream._state === 'writable');\n\n  const controller = stream._writableStreamController;\n  assert(controller !== undefined);\n\n  stream._state = 'erroring';\n  stream._storedError = reason;\n  const writer = stream._writer;\n  if (writer !== undefined) {\n    WritableStreamDefaultWriterEnsureReadyPromiseRejected(writer, reason);\n  }\n\n  if (WritableStreamHasOperationMarkedInFlight(stream) === false && controller._started === true) {\n    WritableStreamFinishErroring(stream);\n  }\n}\n\nfunction WritableStreamFinishErroring(stream: WritableStream) {\n  assert(stream._state === 'erroring');\n  assert(WritableStreamHasOperationMarkedInFlight(stream) === false);\n  stream._state = 'errored';\n  stream._writableStreamController[ErrorSteps]();\n\n  const storedError = stream._storedError;\n  stream._writeRequests.forEach(writeRequest => {\n    writeRequest._reject(storedError);\n  });\n  stream._writeRequests = new SimpleQueue();\n\n  if (stream._pendingAbortRequest === undefined) {\n    WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream);\n    return;\n  }\n\n  const abortRequest = stream._pendingAbortRequest;\n  stream._pendingAbortRequest = undefined;\n\n  if (abortRequest._wasAlreadyErroring === true) {\n    abortRequest._reject(storedError);\n    WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream);\n    return;\n  }\n\n  const promise = stream._writableStreamController[AbortSteps](abortRequest._reason);\n  promise.then(\n    () => {\n      abortRequest._resolve();\n      WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream);\n    },\n    (reason: any) => {\n      abortRequest._reject(reason);\n      WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream);\n    });\n}\n\nfunction WritableStreamFinishInFlightWrite(stream: WritableStream) {\n  assert(stream._inFlightWriteRequest !== undefined);\n  stream._inFlightWriteRequest!._resolve(undefined);\n  stream._inFlightWriteRequest = undefined;\n}\n\nfunction WritableStreamFinishInFlightWriteWithError(stream: WritableStream, error: any) {\n  assert(stream._inFlightWriteRequest !== undefined);\n  stream._inFlightWriteRequest!._reject(error);\n  stream._inFlightWriteRequest = undefined;\n\n  assert(stream._state === 'writable' || stream._state === 'erroring');\n\n  WritableStreamDealWithRejection(stream, error);\n}\n\nfunction WritableStreamFinishInFlightClose(stream: WritableStream) {\n  assert(stream._inFlightCloseRequest !== undefined);\n  stream._inFlightCloseRequest!._resolve(undefined);\n  stream._inFlightCloseRequest = undefined;\n\n  const state = stream._state;\n\n  assert(state === 'writable' || state === 'erroring');\n\n  if (state === 'erroring') {\n    // The error was too late to do anything, so it is ignored.\n    stream._storedError = undefined;\n    if (stream._pendingAbortRequest !== undefined) {\n      stream._pendingAbortRequest._resolve();\n      stream._pendingAbortRequest = undefined;\n    }\n  }\n\n  stream._state = 'closed';\n\n  const writer = stream._writer;\n  if (writer !== undefined) {\n    defaultWriterClosedPromiseResolve(writer);\n  }\n\n  assert(stream._pendingAbortRequest === undefined);\n  assert(stream._storedError === undefined);\n}\n\nfunction WritableStreamFinishInFlightCloseWithError(stream: WritableStream, error: any) {\n  assert(stream._inFlightCloseRequest !== undefined);\n  stream._inFlightCloseRequest!._reject(error);\n  stream._inFlightCloseRequest = undefined;\n\n  assert(stream._state === 'writable' || stream._state === 'erroring');\n\n  // Never execute sink abort() after sink close().\n  if (stream._pendingAbortRequest !== undefined) {\n    stream._pendingAbortRequest._reject(error);\n    stream._pendingAbortRequest = undefined;\n  }\n  WritableStreamDealWithRejection(stream, error);\n}\n\n// TODO(ricea): Fix alphabetical order.\nfunction WritableStreamCloseQueuedOrInFlight(stream: WritableStream): boolean {\n  if (stream._closeRequest === undefined && stream._inFlightCloseRequest === undefined) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction WritableStreamHasOperationMarkedInFlight(stream: WritableStream): boolean {\n  if (stream._inFlightWriteRequest === undefined && stream._inFlightCloseRequest === undefined) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction WritableStreamMarkCloseRequestInFlight(stream: WritableStream) {\n  assert(stream._inFlightCloseRequest === undefined);\n  assert(stream._closeRequest !== undefined);\n  stream._inFlightCloseRequest = stream._closeRequest;\n  stream._closeRequest = undefined;\n}\n\nfunction WritableStreamMarkFirstWriteRequestInFlight(stream: WritableStream) {\n  assert(stream._inFlightWriteRequest === undefined);\n  assert(stream._writeRequests.length !== 0);\n  stream._inFlightWriteRequest = stream._writeRequests.shift();\n}\n\nfunction WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream: WritableStream) {\n  assert(stream._state === 'errored');\n  if (stream._closeRequest !== undefined) {\n    assert(stream._inFlightCloseRequest === undefined);\n\n    stream._closeRequest._reject(stream._storedError);\n    stream._closeRequest = undefined;\n  }\n  const writer = stream._writer;\n  if (writer !== undefined) {\n    defaultWriterClosedPromiseReject(writer, stream._storedError);\n  }\n}\n\nfunction WritableStreamUpdateBackpressure(stream: WritableStream, backpressure: boolean) {\n  assert(stream._state === 'writable');\n  assert(WritableStreamCloseQueuedOrInFlight(stream) === false);\n\n  const writer = stream._writer;\n  if (writer !== undefined && backpressure !== stream._backpressure) {\n    if (backpressure === true) {\n      defaultWriterReadyPromiseReset(writer);\n    } else {\n      assert(backpressure === false);\n\n      defaultWriterReadyPromiseResolve(writer);\n    }\n  }\n\n  stream._backpressure = backpressure;\n}\n\nexport type WritableStreamDefaultWriterType<W> = WritableStreamDefaultWriter<W>;\n\nclass WritableStreamDefaultWriter<W> {\n  /** @internal */\n  _ownerWritableStream: WritableStream<W>;\n  /** @internal */\n  _closedPromise!: Promise<void>;\n  /** @internal */\n  _closedPromise_resolve?: (value?: undefined) => void;\n  /** @internal */\n  _closedPromise_reject?: (reason: any) => void;\n  /** @internal */\n  _closedPromiseState!: 'pending' | 'resolved' | 'rejected';\n  /** @internal */\n  _readyPromise!: Promise<void>;\n  /** @internal */\n  _readyPromise_resolve?: (value?: undefined) => void;\n  /** @internal */\n  _readyPromise_reject?: (reason: any) => void;\n  /** @internal */\n  _readyPromiseState!: 'pending' | 'fulfilled' | 'rejected';\n\n  constructor(stream: WritableStream<W>) {\n    if (IsWritableStream(stream) === false) {\n      throw new TypeError('WritableStreamDefaultWriter can only be constructed with a WritableStream instance');\n    }\n    if (IsWritableStreamLocked(stream) === true) {\n      throw new TypeError('This stream has already been locked for exclusive writing by another writer');\n    }\n\n    this._ownerWritableStream = stream;\n    stream._writer = this;\n\n    const state = stream._state;\n\n    if (state === 'writable') {\n      if (WritableStreamCloseQueuedOrInFlight(stream) === false && stream._backpressure === true) {\n        defaultWriterReadyPromiseInitialize(this);\n      } else {\n        defaultWriterReadyPromiseInitializeAsResolved(this);\n      }\n\n      defaultWriterClosedPromiseInitialize(this);\n    } else if (state === 'erroring') {\n      defaultWriterReadyPromiseInitializeAsRejected(this, stream._storedError);\n      defaultWriterClosedPromiseInitialize(this);\n    } else if (state === 'closed') {\n      defaultWriterReadyPromiseInitializeAsResolved(this);\n      defaultWriterClosedPromiseInitializeAsResolved(this);\n    } else {\n      assert(state === 'errored');\n\n      const storedError = stream._storedError;\n      defaultWriterReadyPromiseInitializeAsRejected(this, storedError);\n      defaultWriterClosedPromiseInitializeAsRejected(this, storedError);\n    }\n  }\n\n  get closed(): Promise<void> {\n    if (IsWritableStreamDefaultWriter(this) === false) {\n      return Promise.reject(defaultWriterBrandCheckException('closed'));\n    }\n\n    return this._closedPromise;\n  }\n\n  get desiredSize(): number | null {\n    if (IsWritableStreamDefaultWriter(this) === false) {\n      throw defaultWriterBrandCheckException('desiredSize');\n    }\n\n    if (this._ownerWritableStream === undefined) {\n      throw defaultWriterLockException('desiredSize');\n    }\n\n    return WritableStreamDefaultWriterGetDesiredSize(this);\n  }\n\n  get ready(): Promise<void> {\n    if (IsWritableStreamDefaultWriter(this) === false) {\n      return Promise.reject(defaultWriterBrandCheckException('ready'));\n    }\n\n    return this._readyPromise;\n  }\n\n  abort(reason: any): Promise<void> {\n    if (IsWritableStreamDefaultWriter(this) === false) {\n      return Promise.reject(defaultWriterBrandCheckException('abort'));\n    }\n\n    if (this._ownerWritableStream === undefined) {\n      return Promise.reject(defaultWriterLockException('abort'));\n    }\n\n    return WritableStreamDefaultWriterAbort(this, reason);\n  }\n\n  close(): Promise<void> {\n    if (IsWritableStreamDefaultWriter(this) === false) {\n      return Promise.reject(defaultWriterBrandCheckException('close'));\n    }\n\n    const stream = this._ownerWritableStream;\n\n    if (stream === undefined) {\n      return Promise.reject(defaultWriterLockException('close'));\n    }\n\n    if (WritableStreamCloseQueuedOrInFlight(stream) === true) {\n      return Promise.reject(new TypeError('cannot close an already-closing stream'));\n    }\n\n    return WritableStreamDefaultWriterClose(this);\n  }\n\n  releaseLock(): void {\n    if (IsWritableStreamDefaultWriter(this) === false) {\n      throw defaultWriterBrandCheckException('releaseLock');\n    }\n\n    const stream = this._ownerWritableStream;\n\n    if (stream === undefined) {\n      return;\n    }\n\n    assert(stream._writer !== undefined);\n\n    WritableStreamDefaultWriterRelease(this);\n  }\n\n  write(chunk: W): Promise<void> {\n    if (IsWritableStreamDefaultWriter(this) === false) {\n      return Promise.reject(defaultWriterBrandCheckException('write'));\n    }\n\n    if (this._ownerWritableStream === undefined) {\n      return Promise.reject(defaultWriterLockException('write to'));\n    }\n\n    return WritableStreamDefaultWriterWrite(this, chunk);\n  }\n}\n\n// Abstract operations for the WritableStreamDefaultWriter.\n\nfunction IsWritableStreamDefaultWriter<W>(x: any): x is WritableStreamDefaultWriter<W> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_ownerWritableStream')) {\n    return false;\n  }\n\n  return true;\n}\n\n// A client of WritableStreamDefaultWriter may use these functions directly to bypass state check.\n\nfunction WritableStreamDefaultWriterAbort(writer: WritableStreamDefaultWriter<any>, reason: any) {\n  const stream = writer._ownerWritableStream;\n\n  assert(stream !== undefined);\n\n  return WritableStreamAbort(stream, reason);\n}\n\nfunction WritableStreamDefaultWriterClose(writer: WritableStreamDefaultWriter<any>): Promise<void> {\n  const stream = writer._ownerWritableStream;\n\n  assert(stream !== undefined);\n\n  const state = stream._state;\n  if (state === 'closed' || state === 'errored') {\n    return Promise.reject(new TypeError(\n      `The stream (in ${state} state) is not in the writable state and cannot be closed`));\n  }\n\n  assert(state === 'writable' || state === 'erroring');\n  assert(WritableStreamCloseQueuedOrInFlight(stream) === false);\n\n  const promise = new Promise<void>((resolve, reject) => {\n    const closeRequest: CloseRequest = {\n      _resolve: resolve,\n      _reject: reject\n    };\n\n    stream._closeRequest = closeRequest;\n  });\n\n  if (stream._backpressure === true && state === 'writable') {\n    defaultWriterReadyPromiseResolve(writer);\n  }\n\n  WritableStreamDefaultControllerClose(stream._writableStreamController);\n\n  return promise;\n}\n\n\nfunction WritableStreamDefaultWriterCloseWithErrorPropagation(writer: WritableStreamDefaultWriter<any>): Promise<void> {\n  const stream = writer._ownerWritableStream;\n\n  assert(stream !== undefined);\n\n  const state = stream._state;\n  if (WritableStreamCloseQueuedOrInFlight(stream) === true || state === 'closed') {\n    return Promise.resolve();\n  }\n\n  if (state === 'errored') {\n    return Promise.reject(stream._storedError);\n  }\n\n  assert(state === 'writable' || state === 'erroring');\n\n  return WritableStreamDefaultWriterClose(writer);\n}\n\nfunction WritableStreamDefaultWriterEnsureClosedPromiseRejected(writer: WritableStreamDefaultWriter<any>, error: any) {\n  if (writer._closedPromiseState === 'pending') {\n    defaultWriterClosedPromiseReject(writer, error);\n  } else {\n    defaultWriterClosedPromiseResetToRejected(writer, error);\n  }\n}\n\nfunction WritableStreamDefaultWriterEnsureReadyPromiseRejected(writer: WritableStreamDefaultWriter<any>, error: any) {\n  if (writer._readyPromiseState === 'pending') {\n    defaultWriterReadyPromiseReject(writer, error);\n  } else {\n    defaultWriterReadyPromiseResetToRejected(writer, error);\n  }\n}\n\nfunction WritableStreamDefaultWriterGetDesiredSize(writer: WritableStreamDefaultWriter<any>): number | null {\n  const stream = writer._ownerWritableStream;\n  const state = stream._state;\n\n  if (state === 'errored' || state === 'erroring') {\n    return null;\n  }\n\n  if (state === 'closed') {\n    return 0;\n  }\n\n  return WritableStreamDefaultControllerGetDesiredSize(stream._writableStreamController);\n}\n\nfunction WritableStreamDefaultWriterRelease(writer: WritableStreamDefaultWriter<any>) {\n  const stream = writer._ownerWritableStream;\n  assert(stream !== undefined);\n  assert(stream._writer === writer);\n\n  const releasedError = new TypeError(\n    'Writer was released and can no longer be used to monitor the stream\\'s closedness');\n\n  WritableStreamDefaultWriterEnsureReadyPromiseRejected(writer, releasedError);\n\n  // The state transitions to \"errored\" before the sink abort() method runs, but the writer.closed promise is not\n  // rejected until afterwards. This means that simply testing state will not work.\n  WritableStreamDefaultWriterEnsureClosedPromiseRejected(writer, releasedError);\n\n  stream._writer = undefined;\n  writer._ownerWritableStream = undefined!;\n}\n\nfunction WritableStreamDefaultWriterWrite<W>(writer: WritableStreamDefaultWriter<W>, chunk: W): Promise<void> {\n  const stream = writer._ownerWritableStream;\n\n  assert(stream !== undefined);\n\n  const controller = stream._writableStreamController;\n\n  const chunkSize = WritableStreamDefaultControllerGetChunkSize(controller, chunk);\n\n  if (stream !== writer._ownerWritableStream) {\n    return Promise.reject(defaultWriterLockException('write to'));\n  }\n\n  const state = stream._state;\n  if (state === 'errored') {\n    return Promise.reject(stream._storedError);\n  }\n  if (WritableStreamCloseQueuedOrInFlight(stream) === true || state === 'closed') {\n    return Promise.reject(new TypeError('The stream is closing or closed and cannot be written to'));\n  }\n  if (state === 'erroring') {\n    return Promise.reject(stream._storedError);\n  }\n\n  assert(state === 'writable');\n\n  const promise = WritableStreamAddWriteRequest(stream);\n\n  WritableStreamDefaultControllerWrite(controller, chunk, chunkSize);\n\n  return promise;\n}\n\ninterface WriteRecord<W> {\n  chunk: W;\n}\n\ntype QueueRecord<W> = WriteRecord<W> | 'close';\n\nexport type WritableStreamDefaultControllerType = WritableStreamDefaultController<any>;\n\nclass WritableStreamDefaultController<W = any> {\n  /** @internal */\n  _controlledWritableStream!: WritableStream<W>;\n  /** @internal */\n  _queue!: SimpleQueue<QueuePair<QueueRecord<W>>>;\n  /** @internal */\n  _queueTotalSize!: number;\n  /** @internal */\n  _started!: boolean;\n  /** @internal */\n  _strategySizeAlgorithm!: QueuingStrategySizeCallback<W>;\n  /** @internal */\n  _strategyHWM!: number;\n  /** @internal */\n  _writeAlgorithm!: (chunk: W) => Promise<void>;\n  /** @internal */\n  _closeAlgorithm!: () => Promise<void>;\n  /** @internal */\n  _abortAlgorithm!: (reason: any) => Promise<void>;\n\n  /** @internal */\n  constructor() {\n    throw new TypeError('WritableStreamDefaultController cannot be constructed explicitly');\n  }\n\n  error(e: any) {\n    if (IsWritableStreamDefaultController(this) === false) {\n      throw new TypeError(\n        'WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController');\n    }\n    const state = this._controlledWritableStream._state;\n    if (state !== 'writable') {\n      // The stream is closed, errored or will be soon. The sink can't do anything useful if it gets an error here, so\n      // just treat it as a no-op.\n      return;\n    }\n\n    WritableStreamDefaultControllerError(this, e);\n  }\n\n  /** @internal */\n  [AbortSteps](reason: any) {\n    const result = this._abortAlgorithm(reason);\n    WritableStreamDefaultControllerClearAlgorithms(this);\n    return result;\n  }\n\n  /** @internal */\n  [ErrorSteps]() {\n    ResetQueue(this);\n  }\n}\n\n// Abstract operations implementing interface required by the WritableStream.\n\nfunction IsWritableStreamDefaultController<W>(x: any): x is WritableStreamDefaultController<W> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_controlledWritableStream')) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction SetUpWritableStreamDefaultController<W>(stream: WritableStream<W>,\n                                                 controller: WritableStreamDefaultController<W>,\n                                                 startAlgorithm: () => void | PromiseLike<void>,\n                                                 writeAlgorithm: (chunk: W) => Promise<void>,\n                                                 closeAlgorithm: () => Promise<void>,\n                                                 abortAlgorithm: (reason: any) => Promise<void>,\n                                                 highWaterMark: number,\n                                                 sizeAlgorithm: QueuingStrategySizeCallback<W>) {\n  assert(IsWritableStream(stream) === true);\n  assert(stream._writableStreamController === undefined);\n\n  controller._controlledWritableStream = stream;\n  stream._writableStreamController = controller;\n\n  // Need to set the slots so that the assert doesn't fire. In the spec the slots already exist implicitly.\n  controller._queue = undefined!;\n  controller._queueTotalSize = undefined!;\n  ResetQueue(controller);\n\n  controller._started = false;\n\n  controller._strategySizeAlgorithm = sizeAlgorithm;\n  controller._strategyHWM = highWaterMark;\n\n  controller._writeAlgorithm = writeAlgorithm;\n  controller._closeAlgorithm = closeAlgorithm;\n  controller._abortAlgorithm = abortAlgorithm;\n\n  const backpressure = WritableStreamDefaultControllerGetBackpressure(controller);\n  WritableStreamUpdateBackpressure(stream, backpressure);\n\n  const startResult = startAlgorithm();\n  const startPromise = Promise.resolve(startResult);\n  startPromise.then(\n    () => {\n      assert(stream._state === 'writable' || stream._state === 'erroring');\n      controller._started = true;\n      WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller);\n    },\n    r => {\n      assert(stream._state === 'writable' || stream._state === 'erroring');\n      controller._started = true;\n      WritableStreamDealWithRejection(stream, r);\n    }\n  ).catch(rethrowAssertionErrorRejection);\n}\n\nfunction SetUpWritableStreamDefaultControllerFromUnderlyingSink<W>(stream: WritableStream<W>,\n                                                                   underlyingSink: UnderlyingSink<W>,\n                                                                   highWaterMark: number,\n                                                                   sizeAlgorithm: QueuingStrategySizeCallback<W>) {\n  assert(underlyingSink !== undefined);\n\n  const controller = Object.create(WritableStreamDefaultController.prototype);\n\n  function startAlgorithm() {\n    return InvokeOrNoop<typeof underlyingSink, 'start'>(underlyingSink, 'start', [controller]);\n  }\n\n  const writeAlgorithm = CreateAlgorithmFromUnderlyingMethod<typeof underlyingSink, 'write'>(\n    underlyingSink, 'write', 1, [controller]\n  );\n  const closeAlgorithm = CreateAlgorithmFromUnderlyingMethod<typeof underlyingSink, 'close'>(\n    underlyingSink, 'close', 0, []\n  );\n  const abortAlgorithm = CreateAlgorithmFromUnderlyingMethod<typeof underlyingSink, 'abort'>(\n    underlyingSink, 'abort', 1, []\n  );\n\n  SetUpWritableStreamDefaultController(stream, controller, startAlgorithm, writeAlgorithm, closeAlgorithm,\n                                       abortAlgorithm, highWaterMark, sizeAlgorithm);\n}\n\n// ClearAlgorithms may be called twice. Erroring the same stream in multiple ways will often result in redundant calls.\nfunction WritableStreamDefaultControllerClearAlgorithms(controller: WritableStreamDefaultController<any>) {\n  controller._writeAlgorithm = undefined!;\n  controller._closeAlgorithm = undefined!;\n  controller._abortAlgorithm = undefined!;\n  controller._strategySizeAlgorithm = undefined!;\n}\n\nfunction WritableStreamDefaultControllerClose(controller: WritableStreamDefaultController<any>) {\n  EnqueueValueWithSize(controller, 'close', 0);\n  WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller);\n}\n\nfunction WritableStreamDefaultControllerGetChunkSize<W>(controller: WritableStreamDefaultController<W>,\n                                                        chunk: W): number {\n  try {\n    return controller._strategySizeAlgorithm(chunk);\n  } catch (chunkSizeE) {\n    WritableStreamDefaultControllerErrorIfNeeded(controller, chunkSizeE);\n    return 1;\n  }\n}\n\nfunction WritableStreamDefaultControllerGetDesiredSize(controller: WritableStreamDefaultController<any>): number {\n  return controller._strategyHWM - controller._queueTotalSize;\n}\n\nfunction WritableStreamDefaultControllerWrite<W>(controller: WritableStreamDefaultController<W>,\n                                                 chunk: W,\n                                                 chunkSize: number) {\n  const writeRecord = { chunk };\n\n  try {\n    EnqueueValueWithSize(controller, writeRecord, chunkSize);\n  } catch (enqueueE) {\n    WritableStreamDefaultControllerErrorIfNeeded(controller, enqueueE);\n    return;\n  }\n\n  const stream = controller._controlledWritableStream;\n  if (WritableStreamCloseQueuedOrInFlight(stream) === false && stream._state === 'writable') {\n    const backpressure = WritableStreamDefaultControllerGetBackpressure(controller);\n    WritableStreamUpdateBackpressure(stream, backpressure);\n  }\n\n  WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller);\n}\n\n// Abstract operations for the WritableStreamDefaultController.\n\nfunction WritableStreamDefaultControllerAdvanceQueueIfNeeded<W>(controller: WritableStreamDefaultController<W>) {\n  const stream = controller._controlledWritableStream;\n\n  if (controller._started === false) {\n    return;\n  }\n\n  if (stream._inFlightWriteRequest !== undefined) {\n    return;\n  }\n\n  const state = stream._state;\n  assert(state !== 'closed' && state !== 'errored');\n  if (state === 'erroring') {\n    WritableStreamFinishErroring(stream);\n    return;\n  }\n\n  if (controller._queue.length === 0) {\n    return;\n  }\n\n  const writeRecord = PeekQueueValue(controller);\n  if (writeRecord === 'close') {\n    WritableStreamDefaultControllerProcessClose(controller);\n  } else {\n    WritableStreamDefaultControllerProcessWrite(controller, writeRecord.chunk);\n  }\n}\n\nfunction WritableStreamDefaultControllerErrorIfNeeded(controller: WritableStreamDefaultController<any>, error: any) {\n  if (controller._controlledWritableStream._state === 'writable') {\n    WritableStreamDefaultControllerError(controller, error);\n  }\n}\n\nfunction WritableStreamDefaultControllerProcessClose(controller: WritableStreamDefaultController<any>) {\n  const stream = controller._controlledWritableStream;\n\n  WritableStreamMarkCloseRequestInFlight(stream);\n\n  DequeueValue(controller);\n  assert(controller._queue.length === 0);\n\n  const sinkClosePromise = controller._closeAlgorithm();\n  WritableStreamDefaultControllerClearAlgorithms(controller);\n  sinkClosePromise.then(\n    () => {\n      WritableStreamFinishInFlightClose(stream);\n    },\n    reason => {\n      WritableStreamFinishInFlightCloseWithError(stream, reason);\n    }\n  ).catch(rethrowAssertionErrorRejection);\n}\n\nfunction WritableStreamDefaultControllerProcessWrite<W>(controller: WritableStreamDefaultController<W>, chunk: W) {\n  const stream = controller._controlledWritableStream;\n\n  WritableStreamMarkFirstWriteRequestInFlight(stream);\n\n  const sinkWritePromise = controller._writeAlgorithm(chunk);\n  sinkWritePromise.then(\n    () => {\n      WritableStreamFinishInFlightWrite(stream);\n\n      const state = stream._state;\n      assert(state === 'writable' || state === 'erroring');\n\n      DequeueValue(controller);\n\n      if (WritableStreamCloseQueuedOrInFlight(stream) === false && state === 'writable') {\n        const backpressure = WritableStreamDefaultControllerGetBackpressure(controller);\n        WritableStreamUpdateBackpressure(stream, backpressure);\n      }\n\n      WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller);\n    },\n    reason => {\n      if (stream._state === 'writable') {\n        WritableStreamDefaultControllerClearAlgorithms(controller);\n      }\n      WritableStreamFinishInFlightWriteWithError(stream, reason);\n    }\n  ).catch(rethrowAssertionErrorRejection);\n}\n\nfunction WritableStreamDefaultControllerGetBackpressure(controller: WritableStreamDefaultController<any>): boolean {\n  const desiredSize = WritableStreamDefaultControllerGetDesiredSize(controller);\n  return desiredSize <= 0;\n}\n\n// A client of WritableStreamDefaultController may use these functions directly to bypass state check.\n\nfunction WritableStreamDefaultControllerError(controller: WritableStreamDefaultController<any>, error: any) {\n  const stream = controller._controlledWritableStream;\n\n  assert(stream._state === 'writable');\n\n  WritableStreamDefaultControllerClearAlgorithms(controller);\n  WritableStreamStartErroring(stream, error);\n}\n\n// Helper functions for the WritableStream.\n\nfunction streamBrandCheckException(name: string): TypeError {\n  return new TypeError(`WritableStream.prototype.${name} can only be used on a WritableStream`);\n}\n\n// Helper functions for the WritableStreamDefaultWriter.\n\nfunction defaultWriterBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `WritableStreamDefaultWriter.prototype.${name} can only be used on a WritableStreamDefaultWriter`);\n}\n\nfunction defaultWriterLockException(name: string): TypeError {\n  return new TypeError('Cannot ' + name + ' a stream using a released writer');\n}\n\nfunction defaultWriterClosedPromiseInitialize(writer: WritableStreamDefaultWriter<any>) {\n  writer._closedPromise = new Promise((resolve, reject) => {\n    writer._closedPromise_resolve = resolve;\n    writer._closedPromise_reject = reject;\n    writer._closedPromiseState = 'pending';\n  });\n}\n\nfunction defaultWriterClosedPromiseInitializeAsRejected(writer: WritableStreamDefaultWriter<any>, reason: any) {\n  defaultWriterClosedPromiseInitialize(writer);\n  defaultWriterClosedPromiseReject(writer, reason);\n}\n\nfunction defaultWriterClosedPromiseInitializeAsResolved(writer: WritableStreamDefaultWriter<any>) {\n  defaultWriterClosedPromiseInitialize(writer);\n  defaultWriterClosedPromiseResolve(writer);\n}\n\nfunction defaultWriterClosedPromiseReject(writer: WritableStreamDefaultWriter<any>, reason: any) {\n  assert(writer._closedPromise_resolve !== undefined);\n  assert(writer._closedPromise_reject !== undefined);\n  assert(writer._closedPromiseState === 'pending');\n\n  writer._closedPromise.catch(() => {});\n  writer._closedPromise_reject!(reason);\n  writer._closedPromise_resolve = undefined;\n  writer._closedPromise_reject = undefined;\n  writer._closedPromiseState = 'rejected';\n}\n\nfunction defaultWriterClosedPromiseResetToRejected(writer: WritableStreamDefaultWriter<any>, reason: any) {\n  assert(writer._closedPromise_resolve === undefined);\n  assert(writer._closedPromise_reject === undefined);\n  assert(writer._closedPromiseState !== 'pending');\n\n  defaultWriterClosedPromiseInitializeAsRejected(writer, reason);\n}\n\nfunction defaultWriterClosedPromiseResolve(writer: WritableStreamDefaultWriter<any>) {\n  assert(writer._closedPromise_resolve !== undefined);\n  assert(writer._closedPromise_reject !== undefined);\n  assert(writer._closedPromiseState === 'pending');\n\n  writer._closedPromise_resolve!(undefined);\n  writer._closedPromise_resolve = undefined;\n  writer._closedPromise_reject = undefined;\n  writer._closedPromiseState = 'resolved';\n}\n\nfunction defaultWriterReadyPromiseInitialize(writer: WritableStreamDefaultWriter<any>) {\n  writer._readyPromise = new Promise((resolve, reject) => {\n    writer._readyPromise_resolve = resolve;\n    writer._readyPromise_reject = reject;\n  });\n  writer._readyPromiseState = 'pending';\n}\n\nfunction defaultWriterReadyPromiseInitializeAsRejected(writer: WritableStreamDefaultWriter<any>, reason: any) {\n  defaultWriterReadyPromiseInitialize(writer);\n  defaultWriterReadyPromiseReject(writer, reason);\n}\n\nfunction defaultWriterReadyPromiseInitializeAsResolved(writer: WritableStreamDefaultWriter<any>) {\n  defaultWriterReadyPromiseInitialize(writer);\n  defaultWriterReadyPromiseResolve(writer);\n}\n\nfunction defaultWriterReadyPromiseReject(writer: WritableStreamDefaultWriter<any>, reason: any) {\n  assert(writer._readyPromise_resolve !== undefined);\n  assert(writer._readyPromise_reject !== undefined);\n\n  writer._readyPromise.catch(() => {});\n  writer._readyPromise_reject!(reason);\n  writer._readyPromise_resolve = undefined;\n  writer._readyPromise_reject = undefined;\n  writer._readyPromiseState = 'rejected';\n}\n\nfunction defaultWriterReadyPromiseReset(writer: WritableStreamDefaultWriter<any>) {\n  assert(writer._readyPromise_resolve === undefined);\n  assert(writer._readyPromise_reject === undefined);\n\n  defaultWriterReadyPromiseInitialize(writer);\n}\n\nfunction defaultWriterReadyPromiseResetToRejected(writer: WritableStreamDefaultWriter<any>, reason: any) {\n  assert(writer._readyPromise_resolve === undefined);\n  assert(writer._readyPromise_reject === undefined);\n\n  defaultWriterReadyPromiseInitializeAsRejected(writer, reason);\n}\n\nfunction defaultWriterReadyPromiseResolve(writer: WritableStreamDefaultWriter<any>) {\n  assert(writer._readyPromise_resolve !== undefined);\n  assert(writer._readyPromise_reject !== undefined);\n\n  writer._readyPromise_resolve!(undefined);\n  writer._readyPromise_resolve = undefined;\n  writer._readyPromise_reject = undefined;\n  writer._readyPromiseState = 'fulfilled';\n}\n","// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger#Polyfill\nconst NumberIsInteger: typeof Number.isInteger = Number.isInteger || function (value) {\n  return typeof value === 'number' &&\n    isFinite(value) &&\n    Math.floor(value) === value;\n};\n\nexport default NumberIsInteger;\n","/// <reference lib=\"dom\" />\n/* global AbortSignal:false */\n\nimport assert from '../stub/assert';\nimport {\n  ArrayBufferCopy,\n  CreateAlgorithmFromUnderlyingMethod,\n  createArrayFromList,\n  InvokeOrNoop,\n  IsDetachedBuffer,\n  IsFiniteNonNegativeNumber,\n  IsNonNegativeNumber,\n  MakeSizeAlgorithmFromSizeFunction,\n  TransferArrayBuffer,\n  typeIsObject,\n  ValidateAndNormalizeHighWaterMark,\n  WaitForAllPromise\n} from './helpers';\nimport { rethrowAssertionErrorRejection } from './utils';\nimport { DequeueValue, EnqueueValueWithSize, QueuePair, ResetQueue } from './queue-with-sizes';\nimport { QueuingStrategy, QueuingStrategySizeCallback } from './queuing-strategy';\nimport {\n  AcquireWritableStreamDefaultWriter,\n  IsWritableStream,\n  IsWritableStreamLocked,\n  WritableStream,\n  WritableStreamAbort,\n  WritableStreamCloseQueuedOrInFlight,\n  WritableStreamDefaultWriterCloseWithErrorPropagation,\n  WritableStreamDefaultWriterRelease,\n  WritableStreamDefaultWriterWrite\n} from './writable-stream';\nimport NumberIsInteger from '../stub/number-isinteger';\nimport { SimpleQueue } from './simple-queue';\n\nconst AsyncIteratorPrototype: AsyncIterable<any> | undefined = Object.getPrototypeOf(\n  Object.getPrototypeOf(async function* (): AsyncIterableIterator<any> {}).prototype\n);\n\nconst CancelSteps = Symbol('[[CancelSteps]]');\nconst PullSteps = Symbol('[[PullSteps]]');\n\nexport type ReadableByteStream = ReadableStream<Uint8Array>;\n\nexport type ReadableStreamDefaultControllerCallback<R> = (controller: ReadableStreamDefaultController<R>) => void | PromiseLike<void>;\nexport type ReadableByteStreamControllerCallback = (controller: ReadableByteStreamController) => void | PromiseLike<void>;\nexport type ReadableStreamErrorCallback = (reason: any) => void | PromiseLike<void>;\n\nexport interface UnderlyingSource<R = any> {\n  start?: ReadableStreamDefaultControllerCallback<R>;\n  pull?: ReadableStreamDefaultControllerCallback<R>;\n  cancel?: ReadableStreamErrorCallback;\n  type?: undefined;\n}\n\nexport interface UnderlyingByteSource {\n  start?: ReadableByteStreamControllerCallback;\n  pull?: ReadableByteStreamControllerCallback;\n  cancel?: ReadableStreamErrorCallback;\n  type: 'bytes';\n  autoAllocateChunkSize?: number;\n}\n\nexport interface PipeOptions {\n  preventAbort?: boolean;\n  preventCancel?: boolean;\n  preventClose?: boolean;\n  signal?: AbortSignal;\n}\n\n// TODO Fix ReadableStreamReadResult<R> in TypeScript DOM types\nexport interface ReadResult<T = any> {\n  done: boolean;\n  value: T;\n}\n\ntype ReadableStreamState = 'readable' | 'closed' | 'errored';\n\nclass ReadableStream<R = any> {\n  /** @internal */\n  _state!: ReadableStreamState;\n  /** @internal */\n  _reader: ReadableStreamReader<R> | undefined;\n  /** @internal */\n  _storedError: any;\n  /** @internal */\n  _disturbed!: boolean;\n  /** @internal */\n  _readableStreamController!: ReadableStreamDefaultController<R> | ReadableByteStreamController;\n\n  constructor(underlyingSource: UnderlyingByteSource, strategy?: { highWaterMark?: number; size?: undefined });\n  constructor(underlyingSource?: UnderlyingSource<R>, strategy?: QueuingStrategy<R>);\n  constructor(underlyingSource: UnderlyingSource<R> | UnderlyingByteSource = {}, strategy: QueuingStrategy<R> = {}) {\n    InitializeReadableStream(this);\n\n    const size = strategy.size;\n    let highWaterMark = strategy.highWaterMark;\n\n    const type = underlyingSource.type;\n    const typeString = String(type);\n    if (typeString === 'bytes') {\n      if (size !== undefined) {\n        throw new RangeError('The strategy for a byte stream cannot have a size function');\n      }\n\n      if (highWaterMark === undefined) {\n        highWaterMark = 0;\n      }\n      highWaterMark = ValidateAndNormalizeHighWaterMark(highWaterMark);\n\n      SetUpReadableByteStreamControllerFromUnderlyingSource(this as unknown as ReadableByteStream,\n                                                            underlyingSource as UnderlyingByteSource,\n                                                            highWaterMark);\n    } else if (type === undefined) {\n      const sizeAlgorithm = MakeSizeAlgorithmFromSizeFunction(size);\n\n      if (highWaterMark === undefined) {\n        highWaterMark = 1;\n      }\n      highWaterMark = ValidateAndNormalizeHighWaterMark(highWaterMark);\n\n      SetUpReadableStreamDefaultControllerFromUnderlyingSource(this,\n                                                               underlyingSource as UnderlyingSource<R>,\n                                                               highWaterMark,\n                                                               sizeAlgorithm);\n    } else {\n      throw new RangeError('Invalid type is specified');\n    }\n  }\n\n  get locked(): boolean {\n    if (IsReadableStream(this) === false) {\n      throw streamBrandCheckException('locked');\n    }\n\n    return IsReadableStreamLocked(this);\n  }\n\n  cancel(reason: any): Promise<void> {\n    if (IsReadableStream(this) === false) {\n      return Promise.reject(streamBrandCheckException('cancel'));\n    }\n\n    if (IsReadableStreamLocked(this) === true) {\n      return Promise.reject(new TypeError('Cannot cancel a stream that already has a reader'));\n    }\n\n    return ReadableStreamCancel(this, reason);\n  }\n\n  getReader({ mode }: { mode: 'byob' }): ReadableStreamBYOBReader;\n  getReader(): ReadableStreamDefaultReader<R>;\n  getReader({ mode }: { mode?: 'byob' } = {}): ReadableStreamDefaultReader<R> | ReadableStreamBYOBReader {\n    if (IsReadableStream(this) === false) {\n      throw streamBrandCheckException('getReader');\n    }\n\n    if (mode === undefined) {\n      return AcquireReadableStreamDefaultReader(this, true);\n    }\n\n    mode = String(mode) as 'byob';\n\n    if (mode === 'byob') {\n      return AcquireReadableStreamBYOBReader(this as unknown as ReadableByteStream, true);\n    }\n\n    throw new RangeError('Invalid mode is specified');\n  }\n\n  pipeThrough<T>({ writable, readable }: { writable: WritableStream<R>; readable: ReadableStream<T> },\n                 { preventClose, preventAbort, preventCancel, signal }: PipeOptions = {}): ReadableStream<T> {\n    if (IsReadableStream(this) === false) {\n      throw streamBrandCheckException('pipeThrough');\n    }\n\n    if (IsWritableStream(writable) === false) {\n      throw new TypeError('writable argument to pipeThrough must be a WritableStream');\n    }\n\n    if (IsReadableStream(readable) === false) {\n      throw new TypeError('readable argument to pipeThrough must be a ReadableStream');\n    }\n\n    preventClose = Boolean(preventClose);\n    preventAbort = Boolean(preventAbort);\n    preventCancel = Boolean(preventCancel);\n\n    if (signal !== undefined && !isAbortSignal(signal)) {\n      throw new TypeError('ReadableStream.prototype.pipeThrough\\'s signal option must be an AbortSignal');\n    }\n\n    if (IsReadableStreamLocked(this) === true) {\n      throw new TypeError('ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream');\n    }\n    if (IsWritableStreamLocked(writable) === true) {\n      throw new TypeError('ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream');\n    }\n\n    const promise = ReadableStreamPipeTo(this, writable, preventClose, preventAbort, preventCancel, signal);\n\n    promise.catch(() => {});\n\n    return readable;\n  }\n\n  pipeTo(dest: WritableStream<R>,\n         { preventClose, preventAbort, preventCancel, signal }: PipeOptions = {}): Promise<void> {\n    if (IsReadableStream(this) === false) {\n      return Promise.reject(streamBrandCheckException('pipeTo'));\n    }\n    if (IsWritableStream(dest) === false) {\n      return Promise.reject(\n        new TypeError('ReadableStream.prototype.pipeTo\\'s first argument must be a WritableStream'));\n    }\n\n    preventClose = Boolean(preventClose);\n    preventAbort = Boolean(preventAbort);\n    preventCancel = Boolean(preventCancel);\n\n    if (signal !== undefined && !isAbortSignal(signal)) {\n      return Promise.reject(new TypeError('ReadableStream.prototype.pipeTo\\'s signal option must be an AbortSignal'));\n    }\n\n    if (IsReadableStreamLocked(this) === true) {\n      return Promise.reject(new TypeError('ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream'));\n    }\n    if (IsWritableStreamLocked(dest) === true) {\n      return Promise.reject(new TypeError('ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream'));\n    }\n\n    return ReadableStreamPipeTo(this, dest, preventClose, preventAbort, preventCancel, signal);\n  }\n\n  tee(): [ReadableStream<R>, ReadableStream<R>] {\n    if (IsReadableStream(this) === false) {\n      throw streamBrandCheckException('tee');\n    }\n\n    const branches = ReadableStreamTee(this, false);\n    return createArrayFromList(branches);\n  }\n\n  getIterator({ preventCancel }: { preventCancel?: boolean } = {}): ReadableStreamAsyncIterator<R> {\n    if (IsReadableStream(this) === false) {\n      throw streamBrandCheckException('getIterator');\n    }\n    const reader = AcquireReadableStreamDefaultReader<R>(this);\n    const iterator: ReadableStreamAsyncIteratorImpl<R> = Object.create(ReadableStreamAsyncIteratorPrototype);\n    iterator._asyncIteratorReader = reader;\n    iterator._preventCancel = Boolean(preventCancel);\n    return iterator;\n  }\n\n  [Symbol.asyncIterator]: (options?: { preventCancel?: boolean }) => ReadableStreamAsyncIterator<R>;\n}\n\nexport interface ReadableStreamAsyncIterator<R> extends AsyncIterator<R> {\n  next(): Promise<IteratorResult<R>>;\n\n  return(value?: any): Promise<IteratorResult<any>>;\n}\n\ndeclare class ReadableStreamAsyncIteratorImpl<R> implements ReadableStreamAsyncIterator<R> {\n  /** @internal */\n  _asyncIteratorReader: ReadableStreamDefaultReader<R>;\n  /** @internal */\n  _preventCancel: boolean;\n\n  next(): Promise<IteratorResult<R>>;\n\n  return(value?: any): Promise<IteratorResult<any>>;\n}\n\nconst ReadableStreamAsyncIteratorPrototype: ReadableStreamAsyncIteratorImpl<any> = {\n  next(): Promise<IteratorResult<any>> {\n    if (IsReadableStreamAsyncIterator(this) === false) {\n      return Promise.reject(streamAsyncIteratorBrandCheckException('next'));\n    }\n    const reader = this._asyncIteratorReader;\n    if (reader._ownerReadableStream === undefined) {\n      return Promise.reject(readerLockException('iterate'));\n    }\n    return ReadableStreamDefaultReaderRead(reader).then(result => {\n      assert(typeIsObject(result));\n      const done = result.done;\n      assert(typeof done === 'boolean');\n      if (done) {\n        ReadableStreamReaderGenericRelease(reader);\n      }\n      const value = result.value;\n      return ReadableStreamCreateReadResult(value, done, true);\n    });\n  },\n\n  return(value: any): Promise<IteratorResult<any>> {\n    if (IsReadableStreamAsyncIterator(this) === false) {\n      return Promise.reject(streamAsyncIteratorBrandCheckException('next'));\n    }\n    const reader = this._asyncIteratorReader;\n    if (reader._ownerReadableStream === undefined) {\n      return Promise.reject(readerLockException('finish iterating'));\n    }\n    if (reader._readRequests.length > 0) {\n      return Promise.reject(new TypeError(\n        'Tried to release a reader lock when that reader has pending read() calls un-settled'));\n    }\n    if (this._preventCancel === false) {\n      const result = ReadableStreamReaderGenericCancel(reader, value);\n      ReadableStreamReaderGenericRelease(reader);\n      return result.then(() => ReadableStreamCreateReadResult(value, true, true));\n    }\n    ReadableStreamReaderGenericRelease(reader);\n    return Promise.resolve(ReadableStreamCreateReadResult(value, true, true));\n  }\n} as any;\nif (AsyncIteratorPrototype !== undefined) {\n  Object.setPrototypeOf(ReadableStreamAsyncIteratorPrototype, AsyncIteratorPrototype);\n}\nObject.defineProperty(ReadableStreamAsyncIteratorPrototype, 'next', { enumerable: false });\nObject.defineProperty(ReadableStreamAsyncIteratorPrototype, 'return', { enumerable: false });\n\nif (typeof Symbol.asyncIterator === 'symbol') {\n  Object.defineProperty(ReadableStream.prototype, Symbol.asyncIterator, {\n    value: ReadableStream.prototype.getIterator,\n    enumerable: false,\n    writable: true,\n    configurable: true\n  });\n}\n\nexport {\n  CreateReadableByteStream,\n  CreateReadableStream,\n  ReadableStream,\n  IsReadableStreamDisturbed,\n  ReadableStreamDefaultControllerClose,\n  ReadableStreamDefaultControllerEnqueue,\n  ReadableStreamDefaultControllerError,\n  ReadableStreamDefaultControllerGetDesiredSize,\n  ReadableStreamDefaultControllerHasBackpressure,\n  ReadableStreamDefaultControllerCanCloseOrEnqueue\n};\n\n// Abstract operations for the ReadableStream.\n\nfunction AcquireReadableStreamBYOBReader(stream: ReadableStream<Uint8Array>,\n                                         forAuthorCode: boolean = false): ReadableStreamBYOBReader {\n  const reader = new ReadableStreamBYOBReader(stream);\n  reader._forAuthorCode = forAuthorCode;\n  return reader;\n}\n\nfunction AcquireReadableStreamDefaultReader<R>(stream: ReadableStream,\n                                               forAuthorCode: boolean = false): ReadableStreamDefaultReader<R> {\n  const reader = new ReadableStreamDefaultReader(stream);\n  reader._forAuthorCode = forAuthorCode;\n  return reader;\n}\n\n// Throws if and only if startAlgorithm throws.\nfunction CreateReadableStream<R>(startAlgorithm: () => void | PromiseLike<void>,\n                                 pullAlgorithm: () => Promise<void>,\n                                 cancelAlgorithm: (reason: any) => Promise<void>,\n                                 highWaterMark: number = 1,\n                                 sizeAlgorithm: QueuingStrategySizeCallback<R> = () => 1): ReadableStream<R> {\n  assert(IsNonNegativeNumber(highWaterMark) === true);\n\n  const stream: ReadableStream<R> = Object.create(ReadableStream.prototype);\n  InitializeReadableStream(stream);\n\n  const controller: ReadableStreamDefaultController<R> = Object.create(ReadableStreamDefaultController.prototype);\n\n  SetUpReadableStreamDefaultController(\n    stream, controller, startAlgorithm, pullAlgorithm, cancelAlgorithm, highWaterMark, sizeAlgorithm\n  );\n\n  return stream;\n}\n\n// Throws if and only if startAlgorithm throws.\nfunction CreateReadableByteStream(startAlgorithm: () => void | PromiseLike<void>,\n                                  pullAlgorithm: () => Promise<void>,\n                                  cancelAlgorithm: (reason: any) => Promise<void>,\n                                  highWaterMark: number = 0,\n                                  autoAllocateChunkSize: number | undefined = undefined): ReadableStream<Uint8Array> {\n  assert(IsNonNegativeNumber(highWaterMark) === true);\n  if (autoAllocateChunkSize !== undefined) {\n    assert(NumberIsInteger(autoAllocateChunkSize) === true);\n    assert(autoAllocateChunkSize > 0);\n  }\n\n  const stream: ReadableStream<Uint8Array> = Object.create(ReadableStream.prototype);\n  InitializeReadableStream(stream);\n\n  const controller: ReadableByteStreamController = Object.create(ReadableByteStreamController.prototype);\n\n  SetUpReadableByteStreamController(stream, controller, startAlgorithm, pullAlgorithm, cancelAlgorithm, highWaterMark,\n                                    autoAllocateChunkSize);\n\n  return stream;\n}\n\nfunction InitializeReadableStream(stream: ReadableStream) {\n  stream._state = 'readable';\n  stream._reader = undefined;\n  stream._storedError = undefined;\n  stream._disturbed = false;\n}\n\nfunction IsReadableStream(x: any): x is ReadableStream {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_readableStreamController')) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction IsReadableStreamDisturbed(stream: ReadableStream): boolean {\n  assert(IsReadableStream(stream) === true);\n\n  return stream._disturbed;\n}\n\nfunction IsReadableStreamLocked(stream: ReadableStream): boolean {\n  assert(IsReadableStream(stream) === true);\n\n  if (stream._reader === undefined) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction IsReadableStreamAsyncIterator<R>(x: any): x is ReadableStreamAsyncIterator<R> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_asyncIteratorReader')) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction ReadableStreamPipeTo<T>(source: ReadableStream<T>,\n                                 dest: WritableStream<T>,\n                                 preventClose: boolean,\n                                 preventAbort: boolean,\n                                 preventCancel: boolean,\n                                 signal: AbortSignal | undefined): Promise<void> {\n  assert(IsReadableStream(source) === true);\n  assert(IsWritableStream(dest) === true);\n  assert(typeof preventClose === 'boolean');\n  assert(typeof preventAbort === 'boolean');\n  assert(typeof preventCancel === 'boolean');\n  assert(signal === undefined || isAbortSignal(signal));\n  assert(IsReadableStreamLocked(source) === false);\n  assert(IsWritableStreamLocked(dest) === false);\n\n  const reader = AcquireReadableStreamDefaultReader<T>(source);\n  const writer = AcquireWritableStreamDefaultWriter<T>(dest);\n\n  let shuttingDown = false;\n\n  // This is used to keep track of the spec's requirement that we wait for ongoing writes during shutdown.\n  let currentWrite = Promise.resolve();\n\n  return new Promise((resolve, reject) => {\n    let abortAlgorithm: () => void;\n    if (signal !== undefined) {\n      abortAlgorithm = () => {\n        const error = new DOMException('Aborted', 'AbortError');\n        const actions: Array<() => Promise<void>> = [];\n        if (preventAbort === false) {\n          actions.push(() => {\n            if (dest._state === 'writable') {\n              return WritableStreamAbort(dest, error);\n            }\n            return Promise.resolve();\n          });\n        }\n        if (preventCancel === false) {\n          actions.push(() => {\n            if (source._state === 'readable') {\n              return ReadableStreamCancel(source, error);\n            }\n            return Promise.resolve();\n          });\n        }\n        shutdownWithAction(() => WaitForAllPromise(actions.map(action => action()), results => results), true, error);\n      };\n\n      if (signal.aborted === true) {\n        abortAlgorithm();\n        return;\n      }\n\n      signal.addEventListener('abort', abortAlgorithm);\n    }\n\n    // Using reader and writer, read all chunks from this and write them to dest\n    // - Backpressure must be enforced\n    // - Shutdown must stop all activity\n    function pipeLoop() {\n      return new Promise<void>((resolveLoop, rejectLoop) => {\n        function next(done: boolean) {\n          if (done) {\n            resolveLoop();\n          } else {\n            pipeStep().then(next, rejectLoop);\n          }\n        }\n\n        next(false);\n      });\n    }\n\n    function pipeStep(): Promise<boolean> {\n      if (shuttingDown === true) {\n        return Promise.resolve(true);\n      }\n\n      return writer._readyPromise.then(() => {\n        return ReadableStreamDefaultReaderRead(reader).then(({ value, done }) => {\n          if (done === true) {\n            return true;\n          }\n\n          currentWrite = WritableStreamDefaultWriterWrite(writer, value!).catch(() => {});\n          return false;\n        });\n      });\n    }\n\n    // Errors must be propagated forward\n    isOrBecomesErrored(source, reader._closedPromise, storedError => {\n      if (preventAbort === false) {\n        shutdownWithAction(() => WritableStreamAbort(dest, storedError), true, storedError);\n      } else {\n        shutdown(true, storedError);\n      }\n    });\n\n    // Errors must be propagated backward\n    isOrBecomesErrored(dest, writer._closedPromise, storedError => {\n      if (preventCancel === false) {\n        shutdownWithAction(() => ReadableStreamCancel(source, storedError), true, storedError);\n      } else {\n        shutdown(true, storedError);\n      }\n    });\n\n    // Closing must be propagated forward\n    isOrBecomesClosed(source, reader._closedPromise, () => {\n      if (preventClose === false) {\n        shutdownWithAction(() => WritableStreamDefaultWriterCloseWithErrorPropagation(writer));\n      } else {\n        shutdown();\n      }\n    });\n\n    // Closing must be propagated backward\n    if (WritableStreamCloseQueuedOrInFlight(dest) === true || dest._state === 'closed') {\n      const destClosed = new TypeError('the destination writable stream closed before all data could be piped to it');\n\n      if (preventCancel === false) {\n        shutdownWithAction(() => ReadableStreamCancel(source, destClosed), true, destClosed);\n      } else {\n        shutdown(true, destClosed);\n      }\n    }\n\n    pipeLoop().catch(rethrowAssertionErrorRejection);\n\n    function waitForWritesToFinish(): Promise<void> {\n      // Another write may have started while we were waiting on this currentWrite, so we have to be sure to wait\n      // for that too.\n      const oldCurrentWrite = currentWrite;\n      return currentWrite.then(() => oldCurrentWrite !== currentWrite ? waitForWritesToFinish() : undefined);\n    }\n\n    function isOrBecomesErrored(stream: ReadableStream | WritableStream,\n                                promise: Promise<void>,\n                                action: (reason: any) => void) {\n      if (stream._state === 'errored') {\n        action(stream._storedError);\n      } else {\n        promise.catch(action).catch(rethrowAssertionErrorRejection);\n      }\n    }\n\n    function isOrBecomesClosed(stream: ReadableStream | WritableStream, promise: Promise<void>, action: () => void) {\n      if (stream._state === 'closed') {\n        action();\n      } else {\n        promise.then(action).catch(rethrowAssertionErrorRejection);\n      }\n    }\n\n    function shutdownWithAction(action: () => Promise<unknown>, originalIsError?: boolean, originalError?: any) {\n      if (shuttingDown === true) {\n        return;\n      }\n      shuttingDown = true;\n\n      if (dest._state === 'writable' && WritableStreamCloseQueuedOrInFlight(dest) === false) {\n        waitForWritesToFinish().then(doTheRest);\n      } else {\n        doTheRest();\n      }\n\n      function doTheRest() {\n        action().then(\n          () => finalize(originalIsError, originalError),\n          newError => finalize(true, newError)\n        ).catch(rethrowAssertionErrorRejection);\n      }\n    }\n\n    function shutdown(isError?: boolean, error?: any) {\n      if (shuttingDown === true) {\n        return;\n      }\n      shuttingDown = true;\n\n      if (dest._state === 'writable' && WritableStreamCloseQueuedOrInFlight(dest) === false) {\n        waitForWritesToFinish().then(() => finalize(isError, error)).catch(rethrowAssertionErrorRejection);\n      } else {\n        finalize(isError, error);\n      }\n    }\n\n    function finalize(isError?: boolean, error?: any) {\n      WritableStreamDefaultWriterRelease(writer);\n      ReadableStreamReaderGenericRelease(reader);\n\n      if (signal !== undefined) {\n        signal.removeEventListener('abort', abortAlgorithm);\n      }\n      if (isError) {\n        reject(error);\n      } else {\n        resolve(undefined);\n      }\n    }\n  });\n}\n\nfunction ReadableStreamTee<R>(stream: ReadableStream<R>,\n                              cloneForBranch2: boolean): [ReadableStream<R>, ReadableStream<R>] {\n  assert(IsReadableStream(stream) === true);\n  assert(typeof cloneForBranch2 === 'boolean');\n\n  const reader = AcquireReadableStreamDefaultReader<R>(stream);\n\n  let closed = false;\n  let canceled1 = false;\n  let canceled2 = false;\n  let reason1: any;\n  let reason2: any;\n  let branch1: ReadableStream<R>;\n  let branch2: ReadableStream<R>;\n\n  let resolveCancelPromise: (reason: any) => void;\n  const cancelPromise = new Promise<any>(resolve => {\n    resolveCancelPromise = resolve;\n  });\n\n  function pullAlgorithm(): Promise<void> {\n    return ReadableStreamDefaultReaderRead(reader).then(result => {\n      if (closed === true) {\n        return;\n      }\n\n      assert(typeIsObject(result));\n      const done = result.done;\n      assert(typeof done === 'boolean');\n\n      if (done === true) {\n        if (canceled1 === false) {\n          ReadableStreamDefaultControllerClose(branch1._readableStreamController as ReadableStreamDefaultController<R>);\n        }\n        if (canceled2 === false) {\n          ReadableStreamDefaultControllerClose(branch2._readableStreamController as ReadableStreamDefaultController<R>);\n        }\n        closed = true;\n        return;\n      }\n\n      const value = result.value!;\n      const value1 = value;\n      const value2 = value;\n\n      // There is no way to access the cloning code right now in the reference implementation.\n      // If we add one then we'll need an implementation for serializable objects.\n      // if (canceled2 === false && cloneForBranch2 === true) {\n      //   value2 = StructuredDeserialize(StructuredSerialize(value2));\n      // }\n\n      if (canceled1 === false) {\n        ReadableStreamDefaultControllerEnqueue(\n          branch1._readableStreamController as ReadableStreamDefaultController<R>,\n          value1\n        );\n      }\n\n      if (canceled2 === false) {\n        ReadableStreamDefaultControllerEnqueue(\n          branch2._readableStreamController as ReadableStreamDefaultController<R>,\n          value2\n        );\n      }\n    });\n  }\n\n  function cancel1Algorithm(reason: any): Promise<void> {\n    canceled1 = true;\n    reason1 = reason;\n    if (canceled2 === true) {\n      const compositeReason = createArrayFromList([reason1, reason2]);\n      const cancelResult = ReadableStreamCancel(stream, compositeReason);\n      resolveCancelPromise(cancelResult);\n    }\n    return cancelPromise;\n  }\n\n  function cancel2Algorithm(reason: any): Promise<void> {\n    canceled2 = true;\n    reason2 = reason;\n    if (canceled1 === true) {\n      const compositeReason = createArrayFromList([reason1, reason2]);\n      const cancelResult = ReadableStreamCancel(stream, compositeReason);\n      resolveCancelPromise(cancelResult);\n    }\n    return cancelPromise;\n  }\n\n  function startAlgorithm() {}\n\n  branch1 = CreateReadableStream(startAlgorithm, pullAlgorithm, cancel1Algorithm);\n  branch2 = CreateReadableStream(startAlgorithm, pullAlgorithm, cancel2Algorithm);\n\n  reader._closedPromise.catch((r: any) => {\n    ReadableStreamDefaultControllerError(branch1._readableStreamController as ReadableStreamDefaultController<R>, r);\n    ReadableStreamDefaultControllerError(branch2._readableStreamController as ReadableStreamDefaultController<R>, r);\n  });\n\n  return [branch1, branch2];\n}\n\n// ReadableStream API exposed for controllers.\n\nfunction ReadableStreamAddReadIntoRequest<T extends ArrayBufferView>(stream: ReadableByteStream): Promise<ReadResult<T>> {\n  assert(IsReadableStreamBYOBReader(stream._reader) === true);\n  assert(stream._state === 'readable' || stream._state === 'closed');\n\n  const promise = new Promise<ReadResult<T>>((resolve, reject) => {\n    const readIntoRequest: ReadIntoRequest<T> = {\n      _resolve: resolve,\n      _reject: reject\n    };\n\n    (stream._reader! as ReadableStreamBYOBReader)._readIntoRequests.push(readIntoRequest);\n  });\n\n  return promise;\n}\n\nfunction ReadableStreamAddReadRequest<R>(stream: ReadableStream<R>): Promise<ReadResult<R>> {\n  assert(IsReadableStreamDefaultReader(stream._reader) === true);\n  assert(stream._state === 'readable');\n\n  const promise = new Promise<ReadResult<R>>((resolve, reject) => {\n    const readRequest: ReadRequest<R> = {\n      _resolve: resolve,\n      _reject: reject\n    };\n\n    (stream._reader! as ReadableStreamDefaultReader<R>)._readRequests.push(readRequest);\n  });\n\n  return promise;\n}\n\nfunction ReadableStreamCancel<R>(stream: ReadableStream<R>, reason: any): Promise<void> {\n  stream._disturbed = true;\n\n  if (stream._state === 'closed') {\n    return Promise.resolve(undefined);\n  }\n  if (stream._state === 'errored') {\n    return Promise.reject(stream._storedError);\n  }\n\n  ReadableStreamClose(stream);\n\n  const sourceCancelPromise = stream._readableStreamController[CancelSteps](reason);\n  return sourceCancelPromise.then(() => undefined);\n}\n\nfunction ReadableStreamClose<R>(stream: ReadableStream<R>): void {\n  assert(stream._state === 'readable');\n\n  stream._state = 'closed';\n\n  const reader = stream._reader;\n\n  if (reader === undefined) {\n    return;\n  }\n\n  if (IsReadableStreamDefaultReader<R>(reader)) {\n    reader._readRequests.forEach(readRequest => {\n      readRequest._resolve(ReadableStreamCreateReadResult<R>(undefined, true, reader._forAuthorCode));\n    });\n    reader._readRequests = new SimpleQueue();\n  }\n\n  defaultReaderClosedPromiseResolve(reader);\n}\n\nfunction ReadableStreamCreateReadResult<T>(value: T | undefined, done: boolean, forAuthorCode: boolean): ReadResult<T> {\n  let prototype: object | null = null;\n  if (forAuthorCode === true) {\n    prototype = Object.prototype;\n  }\n  assert(typeof done === 'boolean');\n  const obj: ReadResult<T> = Object.create(prototype);\n  obj.value = value!;\n  obj.done = done;\n  return obj;\n}\n\nfunction ReadableStreamError<R>(stream: ReadableStream<R>, e: any): void {\n  assert(IsReadableStream(stream) === true);\n  assert(stream._state === 'readable');\n\n  stream._state = 'errored';\n  stream._storedError = e;\n\n  const reader = stream._reader;\n\n  if (reader === undefined) {\n    return;\n  }\n\n  if (IsReadableStreamDefaultReader<R>(reader)) {\n    reader._readRequests.forEach(readRequest => {\n      readRequest._reject(e);\n    });\n\n    reader._readRequests = new SimpleQueue();\n  } else {\n    assert(IsReadableStreamBYOBReader(reader));\n\n    reader._readIntoRequests.forEach(readIntoRequest => {\n      readIntoRequest._reject(e);\n    });\n\n    reader._readIntoRequests = new SimpleQueue();\n  }\n\n  defaultReaderClosedPromiseReject(reader, e);\n}\n\nfunction ReadableStreamFulfillReadIntoRequest(stream: ReadableByteStream, chunk: ArrayBufferView, done: boolean) {\n  const reader = stream._reader as ReadableStreamBYOBReader;\n\n  assert(reader._readIntoRequests.length > 0);\n\n  const readIntoRequest = reader._readIntoRequests.shift()!;\n  readIntoRequest._resolve(ReadableStreamCreateReadResult(chunk, done, reader._forAuthorCode));\n}\n\nfunction ReadableStreamFulfillReadRequest<R>(stream: ReadableStream<R>, chunk: R | undefined, done: boolean) {\n  const reader = stream._reader as ReadableStreamDefaultReader<R>;\n\n  assert(reader._readRequests.length > 0);\n\n  const readRequest = reader._readRequests.shift()!;\n  readRequest._resolve(ReadableStreamCreateReadResult(chunk, done, reader._forAuthorCode));\n}\n\nfunction ReadableStreamGetNumReadIntoRequests(stream: ReadableByteStream): number {\n  return (stream._reader as ReadableStreamBYOBReader)._readIntoRequests.length;\n}\n\nfunction ReadableStreamGetNumReadRequests<R>(stream: ReadableStream<R>): number {\n  return (stream._reader as ReadableStreamDefaultReader<R>)._readRequests.length;\n}\n\nfunction ReadableStreamHasBYOBReader(stream: ReadableByteStream): boolean {\n  const reader = stream._reader;\n\n  if (reader === undefined) {\n    return false;\n  }\n\n  if (!IsReadableStreamBYOBReader(reader)) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction ReadableStreamHasDefaultReader(stream: ReadableStream): boolean {\n  const reader = stream._reader;\n\n  if (reader === undefined) {\n    return false;\n  }\n\n  if (!IsReadableStreamDefaultReader(reader)) {\n    return false;\n  }\n\n  return true;\n}\n\n// Readers\n\ntype ReadableStreamReader<R> = ReadableStreamDefaultReader<R> | ReadableStreamBYOBReader;\n\ninterface ReadRequest<R> {\n  _resolve: (value: ReadResult<R>) => void;\n  _reject: (reason: any) => void;\n}\n\nexport type ReadableStreamDefaultReaderType<R> = ReadableStreamDefaultReader<R>;\n\nclass ReadableStreamDefaultReader<R> {\n  /** @internal */\n  _forAuthorCode!: boolean;\n  /** @internal */\n  _ownerReadableStream!: ReadableStream<R>;\n  /** @internal */\n  _closedPromise!: Promise<void>;\n  /** @internal */\n  _closedPromise_resolve?: (value?: undefined) => void;\n  /** @internal */\n  _closedPromise_reject?: (reason: any) => void;\n  /** @internal */\n  _readRequests: SimpleQueue<ReadRequest<R>>;\n\n  constructor(stream: ReadableStream<R>) {\n    if (IsReadableStream(stream) === false) {\n      throw new TypeError('ReadableStreamDefaultReader can only be constructed with a ReadableStream instance');\n    }\n    if (IsReadableStreamLocked(stream) === true) {\n      throw new TypeError('This stream has already been locked for exclusive reading by another reader');\n    }\n\n    ReadableStreamReaderGenericInitialize(this, stream);\n\n    this._readRequests = new SimpleQueue();\n  }\n\n  get closed(): Promise<void> {\n    if (!IsReadableStreamDefaultReader(this)) {\n      return Promise.reject(defaultReaderBrandCheckException('closed'));\n    }\n\n    return this._closedPromise;\n  }\n\n  cancel(reason: any): Promise<void> {\n    if (!IsReadableStreamDefaultReader(this)) {\n      return Promise.reject(defaultReaderBrandCheckException('cancel'));\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return Promise.reject(readerLockException('cancel'));\n    }\n\n    return ReadableStreamReaderGenericCancel(this, reason);\n  }\n\n  read(): Promise<ReadResult<R>> {\n    if (!IsReadableStreamDefaultReader(this)) {\n      return Promise.reject(defaultReaderBrandCheckException('read'));\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return Promise.reject(readerLockException('read from'));\n    }\n\n    return ReadableStreamDefaultReaderRead<R>(this);\n  }\n\n  releaseLock(): void {\n    if (!IsReadableStreamDefaultReader(this)) {\n      throw defaultReaderBrandCheckException('releaseLock');\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return;\n    }\n\n    if (this._readRequests.length > 0) {\n      throw new TypeError('Tried to release a reader lock when that reader has pending read() calls un-settled');\n    }\n\n    ReadableStreamReaderGenericRelease(this);\n  }\n}\n\ninterface ReadIntoRequest<T extends ArrayBufferView> {\n  _resolve: (value: ReadResult<T>) => void;\n  _reject: (reason: any) => void;\n}\n\nexport type ReadableStreamBYOBReaderType = ReadableStreamBYOBReader;\n\nclass ReadableStreamBYOBReader {\n  /** @internal */\n  _forAuthorCode!: boolean;\n  /** @internal */\n  _ownerReadableStream!: ReadableByteStream;\n  /** @internal */\n  _closedPromise!: Promise<void>;\n  /** @internal */\n  _closedPromise_resolve?: (value?: undefined) => void;\n  /** @internal */\n  _closedPromise_reject?: (reason: any) => void;\n  /** @internal */\n  _readIntoRequests: SimpleQueue<ReadIntoRequest<any>>;\n\n  constructor(stream: ReadableByteStream) {\n    if (!IsReadableStream(stream)) {\n      throw new TypeError('ReadableStreamBYOBReader can only be constructed with a ReadableStream instance given a ' +\n                            'byte source');\n    }\n    if (IsReadableByteStreamController(stream._readableStreamController) === false) {\n      throw new TypeError('Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte ' +\n                            'source');\n    }\n    if (IsReadableStreamLocked(stream)) {\n      throw new TypeError('This stream has already been locked for exclusive reading by another reader');\n    }\n\n    ReadableStreamReaderGenericInitialize(this, stream);\n\n    this._readIntoRequests = new SimpleQueue();\n  }\n\n  get closed(): Promise<void> {\n    if (!IsReadableStreamBYOBReader(this)) {\n      return Promise.reject(byobReaderBrandCheckException('closed'));\n    }\n\n    return this._closedPromise;\n  }\n\n  cancel(reason: any): Promise<void> {\n    if (!IsReadableStreamBYOBReader(this)) {\n      return Promise.reject(byobReaderBrandCheckException('cancel'));\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return Promise.reject(readerLockException('cancel'));\n    }\n\n    return ReadableStreamReaderGenericCancel(this, reason);\n  }\n\n  read<T extends ArrayBufferView>(view: T): Promise<ReadResult<T>> {\n    if (!IsReadableStreamBYOBReader(this)) {\n      return Promise.reject(byobReaderBrandCheckException('read'));\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return Promise.reject(readerLockException('read from'));\n    }\n\n    if (!ArrayBuffer.isView(view)) {\n      return Promise.reject(new TypeError('view must be an array buffer view'));\n    }\n\n    if (IsDetachedBuffer(view.buffer) === true) {\n      return Promise.reject(new TypeError('Cannot read into a view onto a detached ArrayBuffer'));\n    }\n\n    if (view.byteLength === 0) {\n      return Promise.reject(new TypeError('view must have non-zero byteLength'));\n    }\n\n    return ReadableStreamBYOBReaderRead(this, view);\n  }\n\n  releaseLock(): void {\n    if (!IsReadableStreamBYOBReader(this)) {\n      throw byobReaderBrandCheckException('releaseLock');\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return;\n    }\n\n    if (this._readIntoRequests.length > 0) {\n      throw new TypeError('Tried to release a reader lock when that reader has pending read() calls un-settled');\n    }\n\n    ReadableStreamReaderGenericRelease(this);\n  }\n}\n\n// Abstract operations for the readers.\n\nfunction IsReadableStreamBYOBReader(x: any): x is ReadableStreamBYOBReader {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_readIntoRequests')) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction IsReadableStreamDefaultReader<R>(x: any): x is ReadableStreamDefaultReader<R> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_readRequests')) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction ReadableStreamReaderGenericInitialize<R>(reader: ReadableStreamReader<R>, stream: ReadableStream<R>) {\n  reader._forAuthorCode = true;\n  reader._ownerReadableStream = stream;\n  stream._reader = reader;\n\n  if (stream._state === 'readable') {\n    defaultReaderClosedPromiseInitialize(reader);\n  } else if (stream._state === 'closed') {\n    defaultReaderClosedPromiseInitializeAsResolved(reader);\n  } else {\n    assert(stream._state === 'errored');\n\n    defaultReaderClosedPromiseInitializeAsRejected(reader, stream._storedError);\n  }\n}\n\n// A client of ReadableStreamDefaultReader and ReadableStreamBYOBReader may use these functions directly to bypass state\n// check.\n\nfunction ReadableStreamReaderGenericCancel(reader: ReadableStreamReader<any>, reason: any): Promise<void> {\n  const stream = reader._ownerReadableStream;\n  assert(stream !== undefined);\n  return ReadableStreamCancel(stream, reason);\n}\n\nfunction ReadableStreamReaderGenericRelease(reader: ReadableStreamReader<any>) {\n  assert(reader._ownerReadableStream !== undefined);\n  assert(reader._ownerReadableStream._reader === reader);\n\n  if (reader._ownerReadableStream._state === 'readable') {\n    defaultReaderClosedPromiseReject(\n      reader,\n      new TypeError('Reader was released and can no longer be used to monitor the stream\\'s closedness'));\n  } else {\n    defaultReaderClosedPromiseResetToRejected(\n      reader,\n      new TypeError('Reader was released and can no longer be used to monitor the stream\\'s closedness'));\n  }\n\n  reader._ownerReadableStream._reader = undefined;\n  reader._ownerReadableStream = undefined!;\n}\n\nfunction ReadableStreamBYOBReaderRead<T extends ArrayBufferView>(reader: ReadableStreamBYOBReader,\n                                                                 view: T): Promise<ReadResult<T>> {\n  const stream = reader._ownerReadableStream;\n\n  assert(stream !== undefined);\n\n  stream._disturbed = true;\n\n  if (stream._state === 'errored') {\n    return Promise.reject(stream._storedError);\n  }\n\n  // Controllers must implement this.\n  return ReadableByteStreamControllerPullInto(stream._readableStreamController as ReadableByteStreamController,\n                                              view);\n}\n\nfunction ReadableStreamDefaultReaderRead<R>(reader: ReadableStreamDefaultReader<R>): Promise<ReadResult<R>> {\n  const stream = reader._ownerReadableStream;\n\n  assert(stream !== undefined);\n\n  stream._disturbed = true;\n\n  if (stream._state === 'closed') {\n    return Promise.resolve(ReadableStreamCreateReadResult<R>(undefined, true, reader._forAuthorCode));\n  }\n\n  if (stream._state === 'errored') {\n    return Promise.reject(stream._storedError);\n  }\n\n  assert(stream._state === 'readable');\n\n  return stream._readableStreamController[PullSteps]() as unknown as Promise<ReadResult<R>>;\n}\n\n// Controllers\n\nexport type ReadableStreamDefaultControllerType<R> = ReadableStreamDefaultController<R>;\n\nclass ReadableStreamDefaultController<R> {\n  /** @internal */\n  _controlledReadableStream!: ReadableStream<R>;\n  /** @internal */\n  _queue!: SimpleQueue<QueuePair<R>>;\n  /** @internal */\n  _queueTotalSize!: number;\n  /** @internal */\n  _started!: boolean;\n  /** @internal */\n  _closeRequested!: boolean;\n  /** @internal */\n  _pullAgain!: boolean;\n  /** @internal */\n  _pulling !: boolean;\n  /** @internal */\n  _strategySizeAlgorithm!: QueuingStrategySizeCallback<R>;\n  /** @internal */\n  _strategyHWM!: number;\n  /** @internal */\n  _pullAlgorithm!: () => Promise<void>;\n  /** @internal */\n  _cancelAlgorithm!: (reason: any) => Promise<void>;\n\n  /** @internal */\n  constructor() {\n    throw new TypeError();\n  }\n\n  get desiredSize(): number | null {\n    if (IsReadableStreamDefaultController(this) === false) {\n      throw defaultControllerBrandCheckException('desiredSize');\n    }\n\n    return ReadableStreamDefaultControllerGetDesiredSize(this);\n  }\n\n  close(): void {\n    if (IsReadableStreamDefaultController(this) === false) {\n      throw defaultControllerBrandCheckException('close');\n    }\n\n    if (ReadableStreamDefaultControllerCanCloseOrEnqueue(this) === false) {\n      throw new TypeError('The stream is not in a state that permits close');\n    }\n\n    ReadableStreamDefaultControllerClose(this);\n  }\n\n  enqueue(chunk: R): void {\n    if (IsReadableStreamDefaultController(this) === false) {\n      throw defaultControllerBrandCheckException('enqueue');\n    }\n\n    if (ReadableStreamDefaultControllerCanCloseOrEnqueue(this) === false) {\n      throw new TypeError('The stream is not in a state that permits enqueue');\n    }\n\n    return ReadableStreamDefaultControllerEnqueue(this, chunk);\n  }\n\n  error(e: any): void {\n    if (IsReadableStreamDefaultController(this) === false) {\n      throw defaultControllerBrandCheckException('error');\n    }\n\n    ReadableStreamDefaultControllerError(this, e);\n  }\n\n  /** @internal */\n  [CancelSteps](reason: any): Promise<void> {\n    ResetQueue(this);\n    const result = this._cancelAlgorithm(reason);\n    ReadableStreamDefaultControllerClearAlgorithms(this);\n    return result;\n  }\n\n  /** @internal */\n  [PullSteps](): Promise<ReadResult<R>> {\n    const stream = this._controlledReadableStream;\n\n    if (this._queue.length > 0) {\n      const chunk = DequeueValue(this);\n\n      if (this._closeRequested === true && this._queue.length === 0) {\n        ReadableStreamDefaultControllerClearAlgorithms(this);\n        ReadableStreamClose(stream);\n      } else {\n        ReadableStreamDefaultControllerCallPullIfNeeded(this);\n      }\n\n      return Promise.resolve(ReadableStreamCreateReadResult(chunk, false, stream._reader!._forAuthorCode));\n    }\n\n    const pendingPromise = ReadableStreamAddReadRequest(stream);\n    ReadableStreamDefaultControllerCallPullIfNeeded(this);\n    return pendingPromise;\n  }\n}\n\n// Abstract operations for the ReadableStreamDefaultController.\n\nfunction IsReadableStreamDefaultController<R>(x: any): x is ReadableStreamDefaultController<R> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_controlledReadableStream')) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction ReadableStreamDefaultControllerCallPullIfNeeded(controller: ReadableStreamDefaultController<any>): void {\n  const shouldPull = ReadableStreamDefaultControllerShouldCallPull(controller);\n  if (shouldPull === false) {\n    return;\n  }\n\n  if (controller._pulling === true) {\n    controller._pullAgain = true;\n    return;\n  }\n\n  assert(controller._pullAgain === false);\n\n  controller._pulling = true;\n\n  const pullPromise = controller._pullAlgorithm();\n  pullPromise.then(\n    () => {\n      controller._pulling = false;\n\n      if (controller._pullAgain === true) {\n        controller._pullAgain = false;\n        ReadableStreamDefaultControllerCallPullIfNeeded(controller);\n      }\n    },\n    e => {\n      ReadableStreamDefaultControllerError(controller, e);\n    }\n  ).catch(rethrowAssertionErrorRejection);\n}\n\nfunction ReadableStreamDefaultControllerShouldCallPull(controller: ReadableStreamDefaultController<any>): boolean {\n  const stream = controller._controlledReadableStream;\n\n  if (ReadableStreamDefaultControllerCanCloseOrEnqueue(controller) === false) {\n    return false;\n  }\n\n  if (controller._started === false) {\n    return false;\n  }\n\n  if (IsReadableStreamLocked(stream) === true && ReadableStreamGetNumReadRequests(stream) > 0) {\n    return true;\n  }\n\n  const desiredSize = ReadableStreamDefaultControllerGetDesiredSize(controller);\n  assert(desiredSize !== null);\n  if (desiredSize! > 0) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction ReadableStreamDefaultControllerClearAlgorithms(controller: ReadableStreamDefaultController<any>) {\n  controller._pullAlgorithm = undefined!;\n  controller._cancelAlgorithm = undefined!;\n  controller._strategySizeAlgorithm = undefined!;\n}\n\n// A client of ReadableStreamDefaultController may use these functions directly to bypass state check.\n\nfunction ReadableStreamDefaultControllerClose(controller: ReadableStreamDefaultController<any>) {\n  const stream = controller._controlledReadableStream;\n\n  assert(ReadableStreamDefaultControllerCanCloseOrEnqueue(controller) === true);\n\n  controller._closeRequested = true;\n\n  if (controller._queue.length === 0) {\n    ReadableStreamDefaultControllerClearAlgorithms(controller);\n    ReadableStreamClose(stream);\n  }\n}\n\nfunction ReadableStreamDefaultControllerEnqueue<R>(controller: ReadableStreamDefaultController<R>, chunk: R): void {\n  const stream = controller._controlledReadableStream;\n\n  assert(ReadableStreamDefaultControllerCanCloseOrEnqueue(controller) === true);\n\n  if (IsReadableStreamLocked(stream) === true && ReadableStreamGetNumReadRequests(stream) > 0) {\n    ReadableStreamFulfillReadRequest(stream, chunk, false);\n  } else {\n    let chunkSize;\n    try {\n      chunkSize = controller._strategySizeAlgorithm(chunk);\n    } catch (chunkSizeE) {\n      ReadableStreamDefaultControllerError(controller, chunkSizeE);\n      throw chunkSizeE;\n    }\n\n    try {\n      EnqueueValueWithSize(controller, chunk, chunkSize);\n    } catch (enqueueE) {\n      ReadableStreamDefaultControllerError(controller, enqueueE);\n      throw enqueueE;\n    }\n  }\n\n  ReadableStreamDefaultControllerCallPullIfNeeded(controller);\n}\n\nfunction ReadableStreamDefaultControllerError(controller: ReadableStreamDefaultController<any>, e: any) {\n  const stream = controller._controlledReadableStream;\n\n  if (stream._state !== 'readable') {\n    return;\n  }\n\n  ResetQueue(controller);\n\n  ReadableStreamDefaultControllerClearAlgorithms(controller);\n  ReadableStreamError(stream, e);\n}\n\nfunction ReadableStreamDefaultControllerGetDesiredSize(controller: ReadableStreamDefaultController<any>): number | null {\n  const stream = controller._controlledReadableStream;\n  const state = stream._state;\n\n  if (state === 'errored') {\n    return null;\n  }\n  if (state === 'closed') {\n    return 0;\n  }\n\n  return controller._strategyHWM - controller._queueTotalSize;\n}\n\n// This is used in the implementation of TransformStream.\nfunction ReadableStreamDefaultControllerHasBackpressure(controller: ReadableStreamDefaultController<any>): boolean {\n  if (ReadableStreamDefaultControllerShouldCallPull(controller) === true) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction ReadableStreamDefaultControllerCanCloseOrEnqueue(controller: ReadableStreamDefaultController<any>): boolean {\n  const state = controller._controlledReadableStream._state;\n\n  if (controller._closeRequested === false && state === 'readable') {\n    return true;\n  }\n\n  return false;\n}\n\nfunction SetUpReadableStreamDefaultController<R>(stream: ReadableStream<R>,\n                                                 controller: ReadableStreamDefaultController<R>,\n                                                 startAlgorithm: () => void | PromiseLike<void>,\n                                                 pullAlgorithm: () => Promise<void>,\n                                                 cancelAlgorithm: (reason: any) => Promise<void>,\n                                                 highWaterMark: number,\n                                                 sizeAlgorithm: QueuingStrategySizeCallback<R>) {\n  assert(stream._readableStreamController === undefined);\n\n  controller._controlledReadableStream = stream;\n\n  controller._queue = undefined!;\n  controller._queueTotalSize = undefined!;\n  ResetQueue(controller);\n\n  controller._started = false;\n  controller._closeRequested = false;\n  controller._pullAgain = false;\n  controller._pulling = false;\n\n  controller._strategySizeAlgorithm = sizeAlgorithm;\n  controller._strategyHWM = highWaterMark;\n\n  controller._pullAlgorithm = pullAlgorithm;\n  controller._cancelAlgorithm = cancelAlgorithm;\n\n  stream._readableStreamController = controller;\n\n  const startResult = startAlgorithm();\n  Promise.resolve(startResult).then(\n    () => {\n      controller._started = true;\n\n      assert(controller._pulling === false);\n      assert(controller._pullAgain === false);\n\n      ReadableStreamDefaultControllerCallPullIfNeeded(controller);\n    },\n    r => {\n      ReadableStreamDefaultControllerError(controller, r);\n    }\n  ).catch(rethrowAssertionErrorRejection);\n}\n\nfunction SetUpReadableStreamDefaultControllerFromUnderlyingSource<R>(stream: ReadableStream<R>,\n                                                                     underlyingSource: UnderlyingSource<R>,\n                                                                     highWaterMark: number,\n                                                                     sizeAlgorithm: QueuingStrategySizeCallback<R>) {\n  assert(underlyingSource !== undefined);\n\n  const controller: ReadableStreamDefaultController<R> = Object.create(ReadableStreamDefaultController.prototype);\n\n  function startAlgorithm() {\n    return InvokeOrNoop<typeof underlyingSource, 'start'>(underlyingSource, 'start', [controller]);\n  }\n\n  const pullAlgorithm = CreateAlgorithmFromUnderlyingMethod<typeof underlyingSource, 'pull'>(\n    underlyingSource, 'pull', 0, [controller]\n  );\n  const cancelAlgorithm = CreateAlgorithmFromUnderlyingMethod<typeof underlyingSource, 'cancel'>(\n    underlyingSource, 'cancel', 1, []\n  );\n\n  SetUpReadableStreamDefaultController(stream, controller, startAlgorithm, pullAlgorithm, cancelAlgorithm,\n                                       highWaterMark, sizeAlgorithm);\n}\n\nexport type ReadableStreamBYOBRequestType = ReadableStreamBYOBRequest;\n\nclass ReadableStreamBYOBRequest {\n  /** @internal */\n  _associatedReadableByteStreamController!: ReadableByteStreamController;\n  /** @internal */\n  _view!: ArrayBufferView;\n\n  /** @internal */\n  constructor() {\n    throw new TypeError('ReadableStreamBYOBRequest cannot be used directly');\n  }\n\n  get view(): ArrayBufferView {\n    if (IsReadableStreamBYOBRequest(this) === false) {\n      throw byobRequestBrandCheckException('view');\n    }\n\n    return this._view;\n  }\n\n  respond(bytesWritten: number): void {\n    if (IsReadableStreamBYOBRequest(this) === false) {\n      throw byobRequestBrandCheckException('respond');\n    }\n\n    if (this._associatedReadableByteStreamController === undefined) {\n      throw new TypeError('This BYOB request has been invalidated');\n    }\n\n    if (IsDetachedBuffer(this._view.buffer) === true) {\n      throw new TypeError('The BYOB request\\'s buffer has been detached and so cannot be used as a response');\n    }\n\n    ReadableByteStreamControllerRespond(this._associatedReadableByteStreamController, bytesWritten);\n  }\n\n  respondWithNewView(view: ArrayBufferView): void {\n    if (IsReadableStreamBYOBRequest(this) === false) {\n      throw byobRequestBrandCheckException('respond');\n    }\n\n    if (this._associatedReadableByteStreamController === undefined) {\n      throw new TypeError('This BYOB request has been invalidated');\n    }\n\n    if (!ArrayBuffer.isView(view)) {\n      throw new TypeError('You can only respond with array buffer views');\n    }\n\n    if (IsDetachedBuffer(view.buffer) === true) {\n      throw new TypeError('The supplied view\\'s buffer has been detached and so cannot be used as a response');\n    }\n\n    ReadableByteStreamControllerRespondWithNewView(this._associatedReadableByteStreamController, view);\n  }\n}\n\ninterface ArrayBufferViewConstructor<T extends ArrayBufferView = ArrayBufferView> {\n  new(buffer: ArrayBufferLike, byteOffset: number, length?: number): T;\n\n  readonly prototype: T;\n  readonly BYTES_PER_ELEMENT: number;\n}\n\ninterface ByteQueueElement {\n  buffer: ArrayBufferLike;\n  byteOffset: number;\n  byteLength: number;\n}\n\ntype PullIntoDescriptor<T extends ArrayBufferView = ArrayBufferView> =\n  DefaultPullIntoDescriptor\n  | BYOBPullIntoDescriptor;\n\ninterface DefaultPullIntoDescriptor {\n  buffer: ArrayBufferLike;\n  byteOffset: number;\n  byteLength: number;\n  bytesFilled: number;\n  elementSize: number;\n  ctor: ArrayBufferViewConstructor<Uint8Array>;\n  readerType: 'default';\n}\n\ninterface BYOBPullIntoDescriptor<T extends ArrayBufferView = ArrayBufferView> {\n  buffer: ArrayBufferLike;\n  byteOffset: number;\n  byteLength: number;\n  bytesFilled: number;\n  elementSize: number;\n  ctor: ArrayBufferViewConstructor<T>;\n  readerType: 'byob';\n}\n\nexport type ReadableByteStreamControllerType = ReadableByteStreamController;\n\nclass ReadableByteStreamController {\n  /** @internal */\n  _controlledReadableByteStream!: ReadableByteStream;\n  /** @internal */\n  _queue!: SimpleQueue<ByteQueueElement>;\n  /** @internal */\n  _queueTotalSize!: number;\n  /** @internal */\n  _started!: boolean;\n  /** @internal */\n  _closeRequested!: boolean;\n  /** @internal */\n  _pullAgain!: boolean;\n  /** @internal */\n  _pulling !: boolean;\n  /** @internal */\n  _strategyHWM!: number;\n  /** @internal */\n  _pullAlgorithm!: () => Promise<void>;\n  /** @internal */\n  _cancelAlgorithm!: (reason: any) => Promise<void>;\n  /** @internal */\n  _autoAllocateChunkSize: number | undefined;\n  /** @internal */\n  _byobRequest: ReadableStreamBYOBRequest | undefined;\n  /** @internal */\n  _pendingPullIntos!: SimpleQueue<PullIntoDescriptor>;\n\n  /** @internal */\n  constructor() {\n    throw new TypeError('ReadableByteStreamController constructor cannot be used directly');\n  }\n\n  get byobRequest(): ReadableStreamBYOBRequest | undefined {\n    if (IsReadableByteStreamController(this) === false) {\n      throw byteStreamControllerBrandCheckException('byobRequest');\n    }\n\n    if (this._byobRequest === undefined && this._pendingPullIntos.length > 0) {\n      const firstDescriptor = this._pendingPullIntos.peek();\n      const view = new Uint8Array(firstDescriptor.buffer,\n                                  firstDescriptor.byteOffset + firstDescriptor.bytesFilled,\n                                  firstDescriptor.byteLength - firstDescriptor.bytesFilled);\n\n      const byobRequest: ReadableStreamBYOBRequest = Object.create(ReadableStreamBYOBRequest.prototype);\n      SetUpReadableStreamBYOBRequest(byobRequest, this, view);\n      this._byobRequest = byobRequest;\n    }\n\n    return this._byobRequest;\n  }\n\n  get desiredSize(): number | null {\n    if (IsReadableByteStreamController(this) === false) {\n      throw byteStreamControllerBrandCheckException('desiredSize');\n    }\n\n    return ReadableByteStreamControllerGetDesiredSize(this);\n  }\n\n  close(): void {\n    if (IsReadableByteStreamController(this) === false) {\n      throw byteStreamControllerBrandCheckException('close');\n    }\n\n    if (this._closeRequested === true) {\n      throw new TypeError('The stream has already been closed; do not close it again!');\n    }\n\n    const state = this._controlledReadableByteStream._state;\n    if (state !== 'readable') {\n      throw new TypeError(`The stream (in ${state} state) is not in the readable state and cannot be closed`);\n    }\n\n    ReadableByteStreamControllerClose(this);\n  }\n\n  enqueue(chunk: ArrayBufferView): void {\n    if (IsReadableByteStreamController(this) === false) {\n      throw byteStreamControllerBrandCheckException('enqueue');\n    }\n\n    if (this._closeRequested === true) {\n      throw new TypeError('stream is closed or draining');\n    }\n\n    const state = this._controlledReadableByteStream._state;\n    if (state !== 'readable') {\n      throw new TypeError(`The stream (in ${state} state) is not in the readable state and cannot be enqueued to`);\n    }\n\n    if (!ArrayBuffer.isView(chunk)) {\n      throw new TypeError('You can only enqueue array buffer views when using a ReadableByteStreamController');\n    }\n\n    if (IsDetachedBuffer(chunk.buffer) === true) {\n      throw new TypeError('Cannot enqueue a view onto a detached ArrayBuffer');\n    }\n\n    ReadableByteStreamControllerEnqueue(this, chunk);\n  }\n\n  error(e: any): void {\n    if (IsReadableByteStreamController(this) === false) {\n      throw byteStreamControllerBrandCheckException('error');\n    }\n\n    ReadableByteStreamControllerError(this, e);\n  }\n\n  /** @internal */\n  [CancelSteps](reason: any): Promise<void> {\n    if (this._pendingPullIntos.length > 0) {\n      const firstDescriptor = this._pendingPullIntos.peek();\n      firstDescriptor.bytesFilled = 0;\n    }\n\n    ResetQueue(this);\n\n    const result = this._cancelAlgorithm(reason);\n    ReadableByteStreamControllerClearAlgorithms(this);\n    return result;\n  }\n\n  /** @internal */\n  [PullSteps](): Promise<ReadResult<ArrayBufferView>> {\n    const stream = this._controlledReadableByteStream;\n    assert(ReadableStreamHasDefaultReader(stream) === true);\n\n    if (this._queueTotalSize > 0) {\n      assert(ReadableStreamGetNumReadRequests(stream) === 0);\n\n      const entry = this._queue.shift()!;\n      this._queueTotalSize -= entry.byteLength;\n\n      ReadableByteStreamControllerHandleQueueDrain(this);\n\n      let view: ArrayBufferView;\n      try {\n        view = new Uint8Array(entry.buffer, entry.byteOffset, entry.byteLength);\n      } catch (viewE) {\n        return Promise.reject(viewE);\n      }\n\n      return Promise.resolve(ReadableStreamCreateReadResult(view, false, stream._reader!._forAuthorCode));\n    }\n\n    const autoAllocateChunkSize = this._autoAllocateChunkSize;\n    if (autoAllocateChunkSize !== undefined) {\n      let buffer: ArrayBuffer;\n      try {\n        buffer = new ArrayBuffer(autoAllocateChunkSize);\n      } catch (bufferE) {\n        return Promise.reject(bufferE);\n      }\n\n      const pullIntoDescriptor: DefaultPullIntoDescriptor = {\n        buffer,\n        byteOffset: 0,\n        byteLength: autoAllocateChunkSize,\n        bytesFilled: 0,\n        elementSize: 1,\n        ctor: Uint8Array,\n        readerType: 'default'\n      };\n\n      this._pendingPullIntos.push(pullIntoDescriptor);\n    }\n\n    const promise = ReadableStreamAddReadRequest(stream);\n\n    ReadableByteStreamControllerCallPullIfNeeded(this);\n\n    return promise;\n  }\n}\n\n// Abstract operations for the ReadableByteStreamController.\n\nfunction IsReadableByteStreamController(x: any): x is ReadableByteStreamController {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_controlledReadableByteStream')) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction IsReadableStreamBYOBRequest(x: any): x is ReadableStreamBYOBRequest {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_associatedReadableByteStreamController')) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction ReadableByteStreamControllerCallPullIfNeeded(controller: ReadableByteStreamController): void {\n  const shouldPull = ReadableByteStreamControllerShouldCallPull(controller);\n  if (shouldPull === false) {\n    return;\n  }\n\n  if (controller._pulling === true) {\n    controller._pullAgain = true;\n    return;\n  }\n\n  assert(controller._pullAgain === false);\n\n  controller._pulling = true;\n\n  // TODO: Test controller argument\n  const pullPromise = controller._pullAlgorithm();\n  pullPromise.then(\n    () => {\n      controller._pulling = false;\n\n      if (controller._pullAgain === true) {\n        controller._pullAgain = false;\n        ReadableByteStreamControllerCallPullIfNeeded(controller);\n      }\n    },\n    e => {\n      ReadableByteStreamControllerError(controller, e);\n    }\n  ).catch(rethrowAssertionErrorRejection);\n}\n\nfunction ReadableByteStreamControllerClearPendingPullIntos(controller: ReadableByteStreamController) {\n  ReadableByteStreamControllerInvalidateBYOBRequest(controller);\n  controller._pendingPullIntos = new SimpleQueue();\n}\n\nfunction ReadableByteStreamControllerCommitPullIntoDescriptor<T extends ArrayBufferView>(stream: ReadableByteStream,\n                                                                                         pullIntoDescriptor: PullIntoDescriptor<T>) {\n  assert(stream._state !== 'errored');\n\n  let done = false;\n  if (stream._state === 'closed') {\n    assert(pullIntoDescriptor.bytesFilled === 0);\n    done = true;\n  }\n\n  const filledView = ReadableByteStreamControllerConvertPullIntoDescriptor<T>(pullIntoDescriptor);\n  if (pullIntoDescriptor.readerType === 'default') {\n    ReadableStreamFulfillReadRequest(stream, filledView as unknown as Uint8Array, done);\n  } else {\n    assert(pullIntoDescriptor.readerType === 'byob');\n    ReadableStreamFulfillReadIntoRequest(stream, filledView, done);\n  }\n}\n\nfunction ReadableByteStreamControllerConvertPullIntoDescriptor<T extends ArrayBufferView>(pullIntoDescriptor: PullIntoDescriptor<T>): T {\n  const bytesFilled = pullIntoDescriptor.bytesFilled;\n  const elementSize = pullIntoDescriptor.elementSize;\n\n  assert(bytesFilled <= pullIntoDescriptor.byteLength);\n  assert(bytesFilled % elementSize === 0);\n\n  return new pullIntoDescriptor.ctor(\n    pullIntoDescriptor.buffer, pullIntoDescriptor.byteOffset, bytesFilled / elementSize) as T;\n}\n\nfunction ReadableByteStreamControllerEnqueueChunkToQueue(controller: ReadableByteStreamController,\n                                                         buffer: ArrayBufferLike,\n                                                         byteOffset: number,\n                                                         byteLength: number) {\n  controller._queue.push({ buffer, byteOffset, byteLength });\n  controller._queueTotalSize += byteLength;\n}\n\nfunction ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(controller: ReadableByteStreamController,\n                                                                     pullIntoDescriptor: PullIntoDescriptor) {\n  const elementSize = pullIntoDescriptor.elementSize;\n\n  const currentAlignedBytes = pullIntoDescriptor.bytesFilled - pullIntoDescriptor.bytesFilled % elementSize;\n\n  const maxBytesToCopy = Math.min(controller._queueTotalSize,\n                                  pullIntoDescriptor.byteLength - pullIntoDescriptor.bytesFilled);\n  const maxBytesFilled = pullIntoDescriptor.bytesFilled + maxBytesToCopy;\n  const maxAlignedBytes = maxBytesFilled - maxBytesFilled % elementSize;\n\n  let totalBytesToCopyRemaining = maxBytesToCopy;\n  let ready = false;\n  if (maxAlignedBytes > currentAlignedBytes) {\n    totalBytesToCopyRemaining = maxAlignedBytes - pullIntoDescriptor.bytesFilled;\n    ready = true;\n  }\n\n  const queue = controller._queue;\n\n  while (totalBytesToCopyRemaining > 0) {\n    const headOfQueue = queue.peek();\n\n    const bytesToCopy = Math.min(totalBytesToCopyRemaining, headOfQueue.byteLength);\n\n    const destStart = pullIntoDescriptor.byteOffset + pullIntoDescriptor.bytesFilled;\n    ArrayBufferCopy(pullIntoDescriptor.buffer, destStart, headOfQueue.buffer, headOfQueue.byteOffset, bytesToCopy);\n\n    if (headOfQueue.byteLength === bytesToCopy) {\n      queue.shift();\n    } else {\n      headOfQueue.byteOffset += bytesToCopy;\n      headOfQueue.byteLength -= bytesToCopy;\n    }\n    controller._queueTotalSize -= bytesToCopy;\n\n    ReadableByteStreamControllerFillHeadPullIntoDescriptor(controller, bytesToCopy, pullIntoDescriptor);\n\n    totalBytesToCopyRemaining -= bytesToCopy;\n  }\n\n  if (ready === false) {\n    assert(controller._queueTotalSize === 0);\n    assert(pullIntoDescriptor.bytesFilled > 0);\n    assert(pullIntoDescriptor.bytesFilled < pullIntoDescriptor.elementSize);\n  }\n\n  return ready;\n}\n\nfunction ReadableByteStreamControllerFillHeadPullIntoDescriptor(controller: ReadableByteStreamController,\n                                                                size: number,\n                                                                pullIntoDescriptor: PullIntoDescriptor) {\n  assert(controller._pendingPullIntos.length === 0 || controller._pendingPullIntos.peek() === pullIntoDescriptor);\n\n  ReadableByteStreamControllerInvalidateBYOBRequest(controller);\n  pullIntoDescriptor.bytesFilled += size;\n}\n\nfunction ReadableByteStreamControllerHandleQueueDrain(controller: ReadableByteStreamController) {\n  assert(controller._controlledReadableByteStream._state === 'readable');\n\n  if (controller._queueTotalSize === 0 && controller._closeRequested === true) {\n    ReadableByteStreamControllerClearAlgorithms(controller);\n    ReadableStreamClose(controller._controlledReadableByteStream);\n  } else {\n    ReadableByteStreamControllerCallPullIfNeeded(controller);\n  }\n}\n\nfunction ReadableByteStreamControllerInvalidateBYOBRequest(controller: ReadableByteStreamController) {\n  if (controller._byobRequest === undefined) {\n    return;\n  }\n\n  controller._byobRequest._associatedReadableByteStreamController = undefined!;\n  controller._byobRequest._view = undefined!;\n  controller._byobRequest = undefined;\n}\n\nfunction ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(controller: ReadableByteStreamController) {\n  assert(controller._closeRequested === false);\n\n  while (controller._pendingPullIntos.length > 0) {\n    if (controller._queueTotalSize === 0) {\n      return;\n    }\n\n    const pullIntoDescriptor = controller._pendingPullIntos.peek();\n\n    if (ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(controller, pullIntoDescriptor) === true) {\n      ReadableByteStreamControllerShiftPendingPullInto(controller);\n\n      ReadableByteStreamControllerCommitPullIntoDescriptor(\n        controller._controlledReadableByteStream,\n        pullIntoDescriptor\n      );\n    }\n  }\n}\n\nfunction ReadableByteStreamControllerPullInto<T extends ArrayBufferView>(controller: ReadableByteStreamController,\n                                                                         view: T): Promise<ReadResult<T>> {\n  const stream = controller._controlledReadableByteStream;\n\n  let elementSize = 1;\n  if (view.constructor !== DataView) {\n    elementSize = (view.constructor as ArrayBufferViewConstructor<T>).BYTES_PER_ELEMENT;\n  }\n\n  const ctor = view.constructor as ArrayBufferViewConstructor<T>;\n\n  const buffer = TransferArrayBuffer(view.buffer);\n  const pullIntoDescriptor: BYOBPullIntoDescriptor<T> = {\n    buffer,\n    byteOffset: view.byteOffset,\n    byteLength: view.byteLength,\n    bytesFilled: 0,\n    elementSize,\n    ctor,\n    readerType: 'byob'\n  };\n\n  if (controller._pendingPullIntos.length > 0) {\n    controller._pendingPullIntos.push(pullIntoDescriptor);\n\n    // No ReadableByteStreamControllerCallPullIfNeeded() call since:\n    // - No change happens on desiredSize\n    // - The source has already been notified of that there's at least 1 pending read(view)\n\n    return ReadableStreamAddReadIntoRequest(stream);\n  }\n\n  if (stream._state === 'closed') {\n    const emptyView = new ctor(pullIntoDescriptor.buffer, pullIntoDescriptor.byteOffset, 0);\n    return Promise.resolve(ReadableStreamCreateReadResult(emptyView, true, stream._reader!._forAuthorCode));\n  }\n\n  if (controller._queueTotalSize > 0) {\n    if (ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(controller, pullIntoDescriptor) === true) {\n      const filledView = ReadableByteStreamControllerConvertPullIntoDescriptor<T>(pullIntoDescriptor);\n\n      ReadableByteStreamControllerHandleQueueDrain(controller);\n\n      return Promise.resolve(ReadableStreamCreateReadResult(filledView, false, stream._reader!._forAuthorCode));\n    }\n\n    if (controller._closeRequested === true) {\n      const e = new TypeError('Insufficient bytes to fill elements in the given buffer');\n      ReadableByteStreamControllerError(controller, e);\n\n      return Promise.reject(e);\n    }\n  }\n\n  controller._pendingPullIntos.push(pullIntoDescriptor);\n\n  const promise = ReadableStreamAddReadIntoRequest<T>(stream);\n\n  ReadableByteStreamControllerCallPullIfNeeded(controller);\n\n  return promise;\n}\n\nfunction ReadableByteStreamControllerRespondInClosedState(controller: ReadableByteStreamController,\n                                                          firstDescriptor: PullIntoDescriptor) {\n  firstDescriptor.buffer = TransferArrayBuffer(firstDescriptor.buffer);\n\n  assert(firstDescriptor.bytesFilled === 0);\n\n  const stream = controller._controlledReadableByteStream;\n  if (ReadableStreamHasBYOBReader(stream) === true) {\n    while (ReadableStreamGetNumReadIntoRequests(stream) > 0) {\n      const pullIntoDescriptor = ReadableByteStreamControllerShiftPendingPullInto(controller);\n      ReadableByteStreamControllerCommitPullIntoDescriptor(stream, pullIntoDescriptor);\n    }\n  }\n}\n\nfunction ReadableByteStreamControllerRespondInReadableState(controller: ReadableByteStreamController,\n                                                            bytesWritten: number,\n                                                            pullIntoDescriptor: PullIntoDescriptor) {\n  if (pullIntoDescriptor.bytesFilled + bytesWritten > pullIntoDescriptor.byteLength) {\n    throw new RangeError('bytesWritten out of range');\n  }\n\n  ReadableByteStreamControllerFillHeadPullIntoDescriptor(controller, bytesWritten, pullIntoDescriptor);\n\n  if (pullIntoDescriptor.bytesFilled < pullIntoDescriptor.elementSize) {\n    // TODO: Figure out whether we should detach the buffer or not here.\n    return;\n  }\n\n  ReadableByteStreamControllerShiftPendingPullInto(controller);\n\n  const remainderSize = pullIntoDescriptor.bytesFilled % pullIntoDescriptor.elementSize;\n  if (remainderSize > 0) {\n    const end = pullIntoDescriptor.byteOffset + pullIntoDescriptor.bytesFilled;\n    const remainder = pullIntoDescriptor.buffer.slice(end - remainderSize, end);\n    ReadableByteStreamControllerEnqueueChunkToQueue(controller, remainder, 0, remainder.byteLength);\n  }\n\n  pullIntoDescriptor.buffer = TransferArrayBuffer(pullIntoDescriptor.buffer);\n  pullIntoDescriptor.bytesFilled -= remainderSize;\n  ReadableByteStreamControllerCommitPullIntoDescriptor(controller._controlledReadableByteStream, pullIntoDescriptor);\n\n  ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(controller);\n}\n\nfunction ReadableByteStreamControllerRespondInternal(controller: ReadableByteStreamController, bytesWritten: number) {\n  const firstDescriptor = controller._pendingPullIntos.peek();\n\n  const stream = controller._controlledReadableByteStream;\n\n  if (stream._state === 'closed') {\n    if (bytesWritten !== 0) {\n      throw new TypeError('bytesWritten must be 0 when calling respond() on a closed stream');\n    }\n\n    ReadableByteStreamControllerRespondInClosedState(controller, firstDescriptor);\n  } else {\n    assert(stream._state === 'readable');\n\n    ReadableByteStreamControllerRespondInReadableState(controller, bytesWritten, firstDescriptor);\n  }\n\n  ReadableByteStreamControllerCallPullIfNeeded(controller);\n}\n\nfunction ReadableByteStreamControllerShiftPendingPullInto(controller: ReadableByteStreamController): PullIntoDescriptor {\n  const descriptor = controller._pendingPullIntos.shift()!;\n  ReadableByteStreamControllerInvalidateBYOBRequest(controller);\n  return descriptor;\n}\n\nfunction ReadableByteStreamControllerShouldCallPull(controller: ReadableByteStreamController): boolean {\n  const stream = controller._controlledReadableByteStream;\n\n  if (stream._state !== 'readable') {\n    return false;\n  }\n\n  if (controller._closeRequested === true) {\n    return false;\n  }\n\n  if (controller._started === false) {\n    return false;\n  }\n\n  if (ReadableStreamHasDefaultReader(stream) === true && ReadableStreamGetNumReadRequests(stream) > 0) {\n    return true;\n  }\n\n  if (ReadableStreamHasBYOBReader(stream) === true && ReadableStreamGetNumReadIntoRequests(stream) > 0) {\n    return true;\n  }\n\n  const desiredSize = ReadableByteStreamControllerGetDesiredSize(controller);\n  assert(desiredSize !== null);\n  if (desiredSize! > 0) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction ReadableByteStreamControllerClearAlgorithms(controller: ReadableByteStreamController) {\n  controller._pullAlgorithm = undefined!;\n  controller._cancelAlgorithm = undefined!;\n}\n\n// A client of ReadableByteStreamController may use these functions directly to bypass state check.\n\nfunction ReadableByteStreamControllerClose(controller: ReadableByteStreamController) {\n  const stream = controller._controlledReadableByteStream;\n\n  assert(controller._closeRequested === false);\n  assert(stream._state === 'readable');\n\n  if (controller._queueTotalSize > 0) {\n    controller._closeRequested = true;\n\n    return;\n  }\n\n  if (controller._pendingPullIntos.length > 0) {\n    const firstPendingPullInto = controller._pendingPullIntos.peek();\n    if (firstPendingPullInto.bytesFilled > 0) {\n      const e = new TypeError('Insufficient bytes to fill elements in the given buffer');\n      ReadableByteStreamControllerError(controller, e);\n\n      throw e;\n    }\n  }\n\n  ReadableByteStreamControllerClearAlgorithms(controller);\n  ReadableStreamClose(stream);\n}\n\nfunction ReadableByteStreamControllerEnqueue(controller: ReadableByteStreamController, chunk: ArrayBufferView) {\n  const stream = controller._controlledReadableByteStream;\n\n  assert(controller._closeRequested === false);\n  assert(stream._state === 'readable');\n\n  const buffer = chunk.buffer;\n  const byteOffset = chunk.byteOffset;\n  const byteLength = chunk.byteLength;\n  const transferredBuffer = TransferArrayBuffer(buffer);\n\n  if (ReadableStreamHasDefaultReader(stream) === true) {\n    if (ReadableStreamGetNumReadRequests(stream) === 0) {\n      ReadableByteStreamControllerEnqueueChunkToQueue(controller, transferredBuffer, byteOffset, byteLength);\n    } else {\n      assert(controller._queue.length === 0);\n\n      const transferredView = new Uint8Array(transferredBuffer, byteOffset, byteLength);\n      ReadableStreamFulfillReadRequest(stream, transferredView, false);\n    }\n  } else if (ReadableStreamHasBYOBReader(stream) === true) {\n    // TODO: Ideally in this branch detaching should happen only if the buffer is not consumed fully.\n    ReadableByteStreamControllerEnqueueChunkToQueue(controller, transferredBuffer, byteOffset, byteLength);\n    ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(controller);\n  } else {\n    assert(IsReadableStreamLocked(stream) === false);\n    ReadableByteStreamControllerEnqueueChunkToQueue(controller, transferredBuffer, byteOffset, byteLength);\n  }\n\n  ReadableByteStreamControllerCallPullIfNeeded(controller);\n}\n\nfunction ReadableByteStreamControllerError(controller: ReadableByteStreamController, e: any) {\n  const stream = controller._controlledReadableByteStream;\n\n  if (stream._state !== 'readable') {\n    return;\n  }\n\n  ReadableByteStreamControllerClearPendingPullIntos(controller);\n\n  ResetQueue(controller);\n  ReadableByteStreamControllerClearAlgorithms(controller);\n  ReadableStreamError(stream, e);\n}\n\nfunction ReadableByteStreamControllerGetDesiredSize(controller: ReadableByteStreamController): number | null {\n  const stream = controller._controlledReadableByteStream;\n  const state = stream._state;\n\n  if (state === 'errored') {\n    return null;\n  }\n  if (state === 'closed') {\n    return 0;\n  }\n\n  return controller._strategyHWM - controller._queueTotalSize;\n}\n\nfunction ReadableByteStreamControllerRespond(controller: ReadableByteStreamController, bytesWritten: number) {\n  bytesWritten = Number(bytesWritten);\n  if (IsFiniteNonNegativeNumber(bytesWritten) === false) {\n    throw new RangeError('bytesWritten must be a finite');\n  }\n\n  assert(controller._pendingPullIntos.length > 0);\n\n  ReadableByteStreamControllerRespondInternal(controller, bytesWritten);\n}\n\nfunction ReadableByteStreamControllerRespondWithNewView(controller: ReadableByteStreamController,\n                                                        view: ArrayBufferView) {\n  assert(controller._pendingPullIntos.length > 0);\n\n  const firstDescriptor = controller._pendingPullIntos.peek();\n\n  if (firstDescriptor.byteOffset + firstDescriptor.bytesFilled !== view.byteOffset) {\n    throw new RangeError('The region specified by view does not match byobRequest');\n  }\n  if (firstDescriptor.byteLength !== view.byteLength) {\n    throw new RangeError('The buffer of view has different capacity than byobRequest');\n  }\n\n  firstDescriptor.buffer = view.buffer;\n\n  ReadableByteStreamControllerRespondInternal(controller, view.byteLength);\n}\n\nfunction SetUpReadableByteStreamController(stream: ReadableByteStream,\n                                           controller: ReadableByteStreamController,\n                                           startAlgorithm: () => void | PromiseLike<void>,\n                                           pullAlgorithm: () => Promise<void>,\n                                           cancelAlgorithm: (reason: any) => Promise<void>,\n                                           highWaterMark: number,\n                                           autoAllocateChunkSize: number | undefined) {\n  assert(stream._readableStreamController === undefined);\n  if (autoAllocateChunkSize !== undefined) {\n    assert(NumberIsInteger(autoAllocateChunkSize) === true);\n    assert(autoAllocateChunkSize > 0);\n  }\n\n  controller._controlledReadableByteStream = stream;\n\n  controller._pullAgain = false;\n  controller._pulling = false;\n\n  controller._byobRequest = undefined;\n\n  // Need to set the slots so that the assert doesn't fire. In the spec the slots already exist implicitly.\n  controller._queue = controller._queueTotalSize = undefined!;\n  ResetQueue(controller);\n\n  controller._closeRequested = false;\n  controller._started = false;\n\n  controller._strategyHWM = ValidateAndNormalizeHighWaterMark(highWaterMark);\n\n  controller._pullAlgorithm = pullAlgorithm;\n  controller._cancelAlgorithm = cancelAlgorithm;\n\n  controller._autoAllocateChunkSize = autoAllocateChunkSize;\n\n  controller._pendingPullIntos = new SimpleQueue();\n\n  stream._readableStreamController = controller;\n\n  const startResult = startAlgorithm();\n  Promise.resolve(startResult).then(\n    () => {\n      controller._started = true;\n\n      assert(controller._pulling === false);\n      assert(controller._pullAgain === false);\n\n      ReadableByteStreamControllerCallPullIfNeeded(controller);\n    },\n    r => {\n      ReadableByteStreamControllerError(controller, r);\n    }\n  ).catch(rethrowAssertionErrorRejection);\n}\n\nfunction SetUpReadableByteStreamControllerFromUnderlyingSource(stream: ReadableByteStream,\n                                                               underlyingByteSource: UnderlyingByteSource,\n                                                               highWaterMark: number) {\n  assert(underlyingByteSource !== undefined);\n\n  const controller: ReadableByteStreamController = Object.create(ReadableByteStreamController.prototype);\n\n  function startAlgorithm() {\n    return InvokeOrNoop<typeof underlyingByteSource, 'start'>(underlyingByteSource, 'start', [controller]);\n  }\n\n  const pullAlgorithm = CreateAlgorithmFromUnderlyingMethod<typeof underlyingByteSource, 'pull'>(\n    underlyingByteSource, 'pull', 0, [controller]\n  );\n  const cancelAlgorithm = CreateAlgorithmFromUnderlyingMethod<typeof underlyingByteSource, 'cancel'>(\n    underlyingByteSource, 'cancel', 1, []\n  );\n\n  let autoAllocateChunkSize = underlyingByteSource.autoAllocateChunkSize;\n  if (autoAllocateChunkSize !== undefined) {\n    autoAllocateChunkSize = Number(autoAllocateChunkSize);\n    if (NumberIsInteger(autoAllocateChunkSize) === false || autoAllocateChunkSize <= 0) {\n      throw new RangeError('autoAllocateChunkSize must be a positive integer');\n    }\n  }\n\n  SetUpReadableByteStreamController(stream, controller, startAlgorithm, pullAlgorithm, cancelAlgorithm, highWaterMark,\n                                    autoAllocateChunkSize);\n}\n\nfunction SetUpReadableStreamBYOBRequest(request: ReadableStreamBYOBRequest,\n                                        controller: ReadableByteStreamController,\n                                        view: ArrayBufferView) {\n  assert(IsReadableByteStreamController(controller) === true);\n  assert(typeof view === 'object');\n  assert(ArrayBuffer.isView(view) === true);\n  assert(IsDetachedBuffer(view.buffer) === false);\n  request._associatedReadableByteStreamController = controller;\n  request._view = view;\n}\n\n// Helper functions for the ReadableStream.\n\nfunction isAbortSignal(value: any): value is AbortSignal {\n  if (typeof value !== 'object' || value === null) {\n    return false;\n  }\n\n  // Use the brand check to distinguish a real AbortSignal from a fake one.\n  const aborted = Object.getOwnPropertyDescriptor(AbortSignal.prototype, 'aborted')!.get!;\n  try {\n    aborted.call(value);\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction streamBrandCheckException(name: string): TypeError {\n  return new TypeError(`ReadableStream.prototype.${name} can only be used on a ReadableStream`);\n}\n\nfunction streamAsyncIteratorBrandCheckException(name: string): TypeError {\n  return new TypeError(`ReadableStreamAsyncIterator.${name} can only be used on a ReadableSteamAsyncIterator`);\n}\n\n// Helper functions for the readers.\n\nfunction readerLockException(name: string): TypeError {\n  return new TypeError('Cannot ' + name + ' a stream using a released reader');\n}\n\n// Helper functions for the ReadableStreamDefaultReader.\n\nfunction defaultReaderBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `ReadableStreamDefaultReader.prototype.${name} can only be used on a ReadableStreamDefaultReader`);\n}\n\nfunction defaultReaderClosedPromiseInitialize(reader: ReadableStreamReader<any>) {\n  reader._closedPromise = new Promise((resolve, reject) => {\n    reader._closedPromise_resolve = resolve;\n    reader._closedPromise_reject = reject;\n  });\n}\n\nfunction defaultReaderClosedPromiseInitializeAsRejected(reader: ReadableStreamReader<any>, reason: any) {\n  defaultReaderClosedPromiseInitialize(reader);\n  defaultReaderClosedPromiseReject(reader, reason);\n}\n\nfunction defaultReaderClosedPromiseInitializeAsResolved(reader: ReadableStreamReader<any>) {\n  defaultReaderClosedPromiseInitialize(reader);\n  defaultReaderClosedPromiseResolve(reader);\n}\n\nfunction defaultReaderClosedPromiseReject(reader: ReadableStreamReader<any>, reason: any) {\n  assert(reader._closedPromise_resolve !== undefined);\n  assert(reader._closedPromise_reject !== undefined);\n\n  reader._closedPromise.catch(() => {});\n  reader._closedPromise_reject!(reason);\n  reader._closedPromise_resolve = undefined;\n  reader._closedPromise_reject = undefined;\n}\n\nfunction defaultReaderClosedPromiseResetToRejected(reader: ReadableStreamReader<any>, reason: any) {\n  assert(reader._closedPromise_resolve === undefined);\n  assert(reader._closedPromise_reject === undefined);\n\n  defaultReaderClosedPromiseInitializeAsRejected(reader, reason);\n}\n\nfunction defaultReaderClosedPromiseResolve(reader: ReadableStreamReader<any>) {\n  assert(reader._closedPromise_resolve !== undefined);\n  assert(reader._closedPromise_reject !== undefined);\n\n  reader._closedPromise_resolve!(undefined);\n  reader._closedPromise_resolve = undefined;\n  reader._closedPromise_reject = undefined;\n}\n\n// Helper functions for the ReadableStreamDefaultReader.\n\nfunction byobReaderBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `ReadableStreamBYOBReader.prototype.${name} can only be used on a ReadableStreamBYOBReader`);\n}\n\n// Helper functions for the ReadableStreamDefaultController.\n\nfunction defaultControllerBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `ReadableStreamDefaultController.prototype.${name} can only be used on a ReadableStreamDefaultController`);\n}\n\n// Helper functions for the ReadableStreamBYOBRequest.\n\nfunction byobRequestBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `ReadableStreamBYOBRequest.prototype.${name} can only be used on a ReadableStreamBYOBRequest`);\n}\n\n// Helper functions for the ReadableByteStreamController.\n\nfunction byteStreamControllerBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `ReadableByteStreamController.prototype.${name} can only be used on a ReadableByteStreamController`);\n}\n","export default async function createHTML(input: string, revealVersion: string) {\n    const title = \"boardIt\";\n    let style = await downloadFile(\"reveal.css\", revealVersion);\n    let reset = await downloadFile(\"reset.css\", revealVersion);\n    let theme = await downloadFile(\"theme/black.css\", revealVersion);\n    let source = await downloadFile(\"reveal.js\", revealVersion);\n    console.log(source);\n    return (`\n<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <style id=\"reveal-style-id\">${style}</style>\n    <style id=\"reveal-theme-id\">${theme}</style>\n    <style id=\"reveal-reset-id\">${reset}</style>\n    <link rel=\"stylesheet\" href=\"dist/theme/white.css\">\n    <title>${title}</title>\n  </head>\n  <body>\n    <div class=\"reveal\">\n      <div class=\"slides\">\n        ${input}\n      </div>\n    </div>\n    <script id=\"reveal-source-id\">${source}</script>\n    <script>\n      Reveal.initialize();\n    </script>\n  </body>\n</html>`);}\n\n\nasync function downloadFile(path: string, version: string) {\n    let url = `https://raw.githubusercontent.com/hakimel/reveal.js/${version}/dist/${path}`;\n    let result = await fetch(url);\n    return result.text();\n}","import React from 'react';\n\n//import logo from './components/icons/logo.svg';\nimport './App.css';\n\nimport Editor from './components/editor/editor';\nimport Preview from './components/preview/preview';\nimport Bar from \"./components/menu/bar/bar\";\n\nimport save from \"./lib/saver/saver\";\nimport beautify from \"./lib/beautify/index\";\nimport createHTML from './lib/createHTML/createHTML';\n\ninterface AppState {\n  text: string,\n  version: string\n}\n\nexport interface Callbacks {\n  change: any,\n  save: any,\n  format: any\n}\n\nclass App extends React.Component<any, AppState> {\n  constructor(props: any) {\n    super(props);\n    this.state = {text: \"<section>Section 1</section><section>Section 2</section>\", version: \"error\"};\n    this.changeText = this.changeText.bind(this);\n    this.saveText = this.saveText.bind(this);\n    this.formatText = this.formatText.bind(this);\n    this.setVersion = this.setVersion.bind(this);\n  }\n\n  changeText(newText: string) {\n    this.setState({text: newText});\n  }\n\n  setVersion(version: string) {\n    this.setState({version})\n  }\n\n  saveText() {\n    const filename = \"boardit.html\";\n    let text = this.state.text;\n    createHTML(text, this.state.version).then((text) =>  {\n      console.log(text);\n      save(filename, text);\n    });\n  }\n\n  formatText() {\n    let text = this.state.text;\n    this.setState({text: beautify(text, null, null, null)});\n  }\n\n  render() {\n    let callbacks: Callbacks = {\n      change: this.changeText,\n      save: this.saveText,\n      format: this.formatText\n    }\n\n    return (\n      <div> \n        <Bar callbacks={callbacks}/>\n        <div className=\"App\">\n          <Editor value={this.state.text} callbacks={callbacks} />\n          <Preview content={this.state.text} versionCallback={this.setVersion}/>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import streamSaver from \"streamsaver\";\nimport {WritableStream} from \"./ponyfill/ponyfill\";\n\nexport default function save(filename: string, content: string) {\n    let text = new TextEncoder().encode(content);\n    streamSaver.WritableStream = WritableStream;\n    let fileStream = streamSaver.createWriteStream(filename, {\n        size: text.byteLength,\n        writableStrategy: undefined,\n        readableStrategy: undefined\n    });\n    const writer = fileStream.getWriter();\n    writer.write(text);\n    writer.close();\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nfunction Pattern(input_scanner, parent) {\n  this._input = input_scanner;\n  this._starting_pattern = null;\n  this._match_pattern = null;\n  this._until_pattern = null;\n  this._until_after = false;\n\n  if (parent) {\n    this._starting_pattern = this._input.get_regexp(parent._starting_pattern, true);\n    this._match_pattern = this._input.get_regexp(parent._match_pattern, true);\n    this._until_pattern = this._input.get_regexp(parent._until_pattern);\n    this._until_after = parent._until_after;\n  }\n}\n\nPattern.prototype.read = function() {\n  var result = this._input.read(this._starting_pattern);\n  if (!this._starting_pattern || result) {\n    result += this._input.read(this._match_pattern, this._until_pattern, this._until_after);\n  }\n  return result;\n};\n\nPattern.prototype.read_match = function() {\n  return this._input.match(this._match_pattern);\n};\n\nPattern.prototype.until_after = function(pattern) {\n  var result = this._create();\n  result._until_after = true;\n  result._until_pattern = this._input.get_regexp(pattern);\n  result._update();\n  return result;\n};\n\nPattern.prototype.until = function(pattern) {\n  var result = this._create();\n  result._until_after = false;\n  result._until_pattern = this._input.get_regexp(pattern);\n  result._update();\n  return result;\n};\n\nPattern.prototype.starting_with = function(pattern) {\n  var result = this._create();\n  result._starting_pattern = this._input.get_regexp(pattern, true);\n  result._update();\n  return result;\n};\n\nPattern.prototype.matching = function(pattern) {\n  var result = this._create();\n  result._match_pattern = this._input.get_regexp(pattern, true);\n  result._update();\n  return result;\n};\n\nPattern.prototype._create = function() {\n  return new Pattern(this._input, this);\n};\n\nPattern.prototype._update = function() {};\n\nmodule.exports.Pattern = Pattern;\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nvar BaseOptions = require('./core/options').Options;\n\nfunction Options(options) {\n  BaseOptions.call(this, options, 'html');\n  if (this.templating.length === 1 && this.templating[0] === 'auto') {\n    this.templating = ['django', 'erb', 'handlebars', 'php'];\n  }\n\n  this.indent_inner_html = this._get_boolean('indent_inner_html');\n  this.indent_body_inner_html = this._get_boolean('indent_body_inner_html', true);\n  this.indent_head_inner_html = this._get_boolean('indent_head_inner_html', true);\n\n  this.indent_handlebars = this._get_boolean('indent_handlebars', true);\n  this.wrap_attributes = this._get_selection('wrap_attributes',\n    ['auto', 'force', 'force-aligned', 'force-expand-multiline', 'aligned-multiple', 'preserve', 'preserve-aligned']);\n  this.wrap_attributes_indent_size = this._get_number('wrap_attributes_indent_size', this.indent_size);\n  this.extra_liners = this._get_array('extra_liners', ['head', 'body', '/html']);\n\n  // Block vs inline elements\n  // https://developer.mozilla.org/en-US/docs/Web/HTML/Block-level_elements\n  // https://developer.mozilla.org/en-US/docs/Web/HTML/Inline_elements\n  // https://www.w3.org/TR/html5/dom.html#phrasing-content\n  this.inline = this._get_array('inline', [\n    'a', 'abbr', 'area', 'audio', 'b', 'bdi', 'bdo', 'br', 'button', 'canvas', 'cite',\n    'code', 'data', 'datalist', 'del', 'dfn', 'em', 'embed', 'i', 'iframe', 'img',\n    'input', 'ins', 'kbd', 'keygen', 'label', 'map', 'mark', 'math', 'meter', 'noscript',\n    'object', 'output', 'progress', 'q', 'ruby', 's', 'samp', /* 'script', */ 'select', 'small',\n    'span', 'strong', 'sub', 'sup', 'svg', 'template', 'textarea', 'time', 'u', 'var',\n    'video', 'wbr', 'text',\n    // obsolete inline tags\n    'acronym', 'big', 'strike', 'tt'\n  ]);\n  this.void_elements = this._get_array('void_elements', [\n    // HTLM void elements - aka self-closing tags - aka singletons\n    // https://www.w3.org/html/wg/drafts/html/master/syntax.html#void-elements\n    'area', 'base', 'br', 'col', 'embed', 'hr', 'img', 'input', 'keygen',\n    'link', 'menuitem', 'meta', 'param', 'source', 'track', 'wbr',\n    // NOTE: Optional tags are too complex for a simple list\n    // they are hard coded in _do_optional_end_element\n\n    // Doctype and xml elements\n    '!doctype', '?xml',\n\n    // obsolete tags\n    // basefont: https://www.computerhope.com/jargon/h/html-basefont-tag.htm\n    // isndex: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/isindex\n    'basefont', 'isindex'\n  ]);\n  this.unformatted = this._get_array('unformatted', []);\n  this.content_unformatted = this._get_array('content_unformatted', [\n    'pre', 'textarea'\n  ]);\n  this.unformatted_content_delimiter = this._get_characters('unformatted_content_delimiter');\n  this.indent_scripts = this._get_selection('indent_scripts', ['normal', 'keep', 'separate']);\n\n}\nOptions.prototype = new BaseOptions();\n\n\n\nmodule.exports.Options = Options;\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nvar BaseTokenizer = require('./core/tokenizer').Tokenizer;\nvar BASETOKEN = require('./core/tokenizer').TOKEN;\nvar Directives = require('./core/directives').Directives;\nvar TemplatablePattern = require('./core/templatablepattern').TemplatablePattern;\nvar Pattern = require('./core/pattern').Pattern;\n\nvar TOKEN = {\n  TAG_OPEN: 'TK_TAG_OPEN',\n  TAG_CLOSE: 'TK_TAG_CLOSE',\n  ATTRIBUTE: 'TK_ATTRIBUTE',\n  EQUALS: 'TK_EQUALS',\n  VALUE: 'TK_VALUE',\n  COMMENT: 'TK_COMMENT',\n  TEXT: 'TK_TEXT',\n  UNKNOWN: 'TK_UNKNOWN',\n  START: BASETOKEN.START,\n  RAW: BASETOKEN.RAW,\n  EOF: BASETOKEN.EOF\n};\n\nvar directives_core = new Directives(/<!--/, /-->/);\n\nvar Tokenizer = function(input_string, options) {\n  BaseTokenizer.call(this, input_string, options);\n  this._current_tag_name = '';\n\n  // Words end at whitespace or when a tag starts\n  // if we are indenting handlebars, they are considered tags\n  var templatable_reader = new TemplatablePattern(this._input).read_options(this._options);\n  var pattern_reader = new Pattern(this._input);\n\n  this.__patterns = {\n    word: templatable_reader.until(/[\\n\\r\\t <]/),\n    single_quote: templatable_reader.until_after(/'/),\n    double_quote: templatable_reader.until_after(/\"/),\n    attribute: templatable_reader.until(/[\\n\\r\\t =>]|\\/>/),\n    element_name: templatable_reader.until(/[\\n\\r\\t >/]/),\n\n    handlebars_comment: pattern_reader.starting_with(/{{!--/).until_after(/--}}/),\n    handlebars: pattern_reader.starting_with(/{{/).until_after(/}}/),\n    handlebars_open: pattern_reader.until(/[\\n\\r\\t }]/),\n    handlebars_raw_close: pattern_reader.until(/}}/),\n    comment: pattern_reader.starting_with(/<!--/).until_after(/-->/),\n    cdata: pattern_reader.starting_with(/<!\\[CDATA\\[/).until_after(/]]>/),\n    // https://en.wikipedia.org/wiki/Conditional_comment\n    conditional_comment: pattern_reader.starting_with(/<!\\[/).until_after(/]>/),\n    processing: pattern_reader.starting_with(/<\\?/).until_after(/\\?>/)\n  };\n\n  if (this._options.indent_handlebars) {\n    this.__patterns.word = this.__patterns.word.exclude('handlebars');\n  }\n\n  this._unformatted_content_delimiter = null;\n\n  if (this._options.unformatted_content_delimiter) {\n    var literal_regexp = this._input.get_literal_regexp(this._options.unformatted_content_delimiter);\n    this.__patterns.unformatted_content_delimiter =\n      pattern_reader.matching(literal_regexp)\n      .until_after(literal_regexp);\n  }\n};\nTokenizer.prototype = new BaseTokenizer();\n\nTokenizer.prototype._is_comment = function(current_token) { // jshint unused:false\n  return false; //current_token.type === TOKEN.COMMENT || current_token.type === TOKEN.UNKNOWN;\n};\n\nTokenizer.prototype._is_opening = function(current_token) {\n  return current_token.type === TOKEN.TAG_OPEN;\n};\n\nTokenizer.prototype._is_closing = function(current_token, open_token) {\n  return current_token.type === TOKEN.TAG_CLOSE &&\n    (open_token && (\n      ((current_token.text === '>' || current_token.text === '/>') && open_token.text[0] === '<') ||\n      (current_token.text === '}}' && open_token.text[0] === '{' && open_token.text[1] === '{')));\n};\n\nTokenizer.prototype._reset = function() {\n  this._current_tag_name = '';\n};\n\nTokenizer.prototype._get_next_token = function(previous_token, open_token) { // jshint unused:false\n  var token = null;\n  this._readWhitespace();\n  var c = this._input.peek();\n\n  if (c === null) {\n    return this._create_token(TOKEN.EOF, '');\n  }\n\n  token = token || this._read_open_handlebars(c, open_token);\n  token = token || this._read_attribute(c, previous_token, open_token);\n  token = token || this._read_close(c, open_token);\n  token = token || this._read_raw_content(c, previous_token, open_token);\n  token = token || this._read_content_word(c);\n  token = token || this._read_comment_or_cdata(c);\n  token = token || this._read_processing(c);\n  token = token || this._read_open(c, open_token);\n  token = token || this._create_token(TOKEN.UNKNOWN, this._input.next());\n\n  return token;\n};\n\nTokenizer.prototype._read_comment_or_cdata = function(c) { // jshint unused:false\n  var token = null;\n  var resulting_string = null;\n  var directives = null;\n\n  if (c === '<') {\n    var peek1 = this._input.peek(1);\n    // We treat all comments as literals, even more than preformatted tags\n    // we only look for the appropriate closing marker\n    if (peek1 === '!') {\n      resulting_string = this.__patterns.comment.read();\n\n      // only process directive on html comments\n      if (resulting_string) {\n        directives = directives_core.get_directives(resulting_string);\n        if (directives && directives.ignore === 'start') {\n          resulting_string += directives_core.readIgnored(this._input);\n        }\n      } else {\n        resulting_string = this.__patterns.cdata.read();\n      }\n    }\n\n    if (resulting_string) {\n      token = this._create_token(TOKEN.COMMENT, resulting_string);\n      token.directives = directives;\n    }\n  }\n\n  return token;\n};\n\nTokenizer.prototype._read_processing = function(c) { // jshint unused:false\n  var token = null;\n  var resulting_string = null;\n  var directives = null;\n\n  if (c === '<') {\n    var peek1 = this._input.peek(1);\n    if (peek1 === '!' || peek1 === '?') {\n      resulting_string = this.__patterns.conditional_comment.read();\n      resulting_string = resulting_string || this.__patterns.processing.read();\n    }\n\n    if (resulting_string) {\n      token = this._create_token(TOKEN.COMMENT, resulting_string);\n      token.directives = directives;\n    }\n  }\n\n  return token;\n};\n\nTokenizer.prototype._read_open = function(c, open_token) {\n  var resulting_string = null;\n  var token = null;\n  if (!open_token) {\n    if (c === '<') {\n\n      resulting_string = this._input.next();\n      if (this._input.peek() === '/') {\n        resulting_string += this._input.next();\n      }\n      resulting_string += this.__patterns.element_name.read();\n      token = this._create_token(TOKEN.TAG_OPEN, resulting_string);\n    }\n  }\n  return token;\n};\n\nTokenizer.prototype._read_open_handlebars = function(c, open_token) {\n  var resulting_string = null;\n  var token = null;\n  if (!open_token) {\n    if (this._options.indent_handlebars && c === '{' && this._input.peek(1) === '{') {\n      if (this._input.peek(2) === '!') {\n        resulting_string = this.__patterns.handlebars_comment.read();\n        resulting_string = resulting_string || this.__patterns.handlebars.read();\n        token = this._create_token(TOKEN.COMMENT, resulting_string);\n      } else {\n        resulting_string = this.__patterns.handlebars_open.read();\n        token = this._create_token(TOKEN.TAG_OPEN, resulting_string);\n      }\n    }\n  }\n  return token;\n};\n\n\nTokenizer.prototype._read_close = function(c, open_token) {\n  var resulting_string = null;\n  var token = null;\n  if (open_token) {\n    if (open_token.text[0] === '<' && (c === '>' || (c === '/' && this._input.peek(1) === '>'))) {\n      resulting_string = this._input.next();\n      if (c === '/') { //  for close tag \"/>\"\n        resulting_string += this._input.next();\n      }\n      token = this._create_token(TOKEN.TAG_CLOSE, resulting_string);\n    } else if (open_token.text[0] === '{' && c === '}' && this._input.peek(1) === '}') {\n      this._input.next();\n      this._input.next();\n      token = this._create_token(TOKEN.TAG_CLOSE, '}}');\n    }\n  }\n\n  return token;\n};\n\nTokenizer.prototype._read_attribute = function(c, previous_token, open_token) {\n  var token = null;\n  var resulting_string = '';\n  if (open_token && open_token.text[0] === '<') {\n\n    if (c === '=') {\n      token = this._create_token(TOKEN.EQUALS, this._input.next());\n    } else if (c === '\"' || c === \"'\") {\n      var content = this._input.next();\n      if (c === '\"') {\n        content += this.__patterns.double_quote.read();\n      } else {\n        content += this.__patterns.single_quote.read();\n      }\n      token = this._create_token(TOKEN.VALUE, content);\n    } else {\n      resulting_string = this.__patterns.attribute.read();\n\n      if (resulting_string) {\n        if (previous_token.type === TOKEN.EQUALS) {\n          token = this._create_token(TOKEN.VALUE, resulting_string);\n        } else {\n          token = this._create_token(TOKEN.ATTRIBUTE, resulting_string);\n        }\n      }\n    }\n  }\n  return token;\n};\n\nTokenizer.prototype._is_content_unformatted = function(tag_name) {\n  // void_elements have no content and so cannot have unformatted content\n  // script and style tags should always be read as unformatted content\n  // finally content_unformatted and unformatted element contents are unformatted\n  return this._options.void_elements.indexOf(tag_name) === -1 &&\n    (this._options.content_unformatted.indexOf(tag_name) !== -1 ||\n      this._options.unformatted.indexOf(tag_name) !== -1);\n};\n\n\nTokenizer.prototype._read_raw_content = function(c, previous_token, open_token) { // jshint unused:false\n  var resulting_string = '';\n  if (open_token && open_token.text[0] === '{') {\n    resulting_string = this.__patterns.handlebars_raw_close.read();\n  } else if (previous_token.type === TOKEN.TAG_CLOSE &&\n    previous_token.opened.text[0] === '<' && previous_token.text[0] !== '/') {\n    // ^^ empty tag has no content \n    var tag_name = previous_token.opened.text.substr(1).toLowerCase();\n    if (tag_name === 'script' || tag_name === 'style') {\n      // Script and style tags are allowed to have comments wrapping their content\n      // or just have regular content.\n      var token = this._read_comment_or_cdata(c);\n      if (token) {\n        token.type = TOKEN.TEXT;\n        return token;\n      }\n      resulting_string = this._input.readUntil(new RegExp('</' + tag_name + '[\\\\n\\\\r\\\\t ]*?>', 'ig'));\n    } else if (this._is_content_unformatted(tag_name)) {\n\n      resulting_string = this._input.readUntil(new RegExp('</' + tag_name + '[\\\\n\\\\r\\\\t ]*?>', 'ig'));\n    }\n  }\n\n  if (resulting_string) {\n    return this._create_token(TOKEN.TEXT, resulting_string);\n  }\n\n  return null;\n};\n\nTokenizer.prototype._read_content_word = function(c) {\n  var resulting_string = '';\n  if (this._options.unformatted_content_delimiter) {\n    if (c === this._options.unformatted_content_delimiter[0]) {\n      resulting_string = this.__patterns.unformatted_content_delimiter.read();\n    }\n  }\n\n  if (!resulting_string) {\n    resulting_string = this.__patterns.word.read();\n  }\n  if (resulting_string) {\n    return this._create_token(TOKEN.TEXT, resulting_string);\n  }\n};\n\nmodule.exports.Tokenizer = Tokenizer;\nmodule.exports.TOKEN = TOKEN;\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nvar InputScanner = require('../core/inputscanner').InputScanner;\nvar Token = require('../core/token').Token;\nvar TokenStream = require('../core/tokenstream').TokenStream;\nvar WhitespacePattern = require('./whitespacepattern').WhitespacePattern;\n\nvar TOKEN = {\n  START: 'TK_START',\n  RAW: 'TK_RAW',\n  EOF: 'TK_EOF'\n};\n\nvar Tokenizer = function(input_string, options) {\n  this._input = new InputScanner(input_string);\n  this._options = options || {};\n  this.__tokens = null;\n\n  this._patterns = {};\n  this._patterns.whitespace = new WhitespacePattern(this._input);\n};\n\nTokenizer.prototype.tokenize = function() {\n  this._input.restart();\n  this.__tokens = new TokenStream();\n\n  this._reset();\n\n  var current;\n  var previous = new Token(TOKEN.START, '');\n  var open_token = null;\n  var open_stack = [];\n  var comments = new TokenStream();\n\n  while (previous.type !== TOKEN.EOF) {\n    current = this._get_next_token(previous, open_token);\n    while (this._is_comment(current)) {\n      comments.add(current);\n      current = this._get_next_token(previous, open_token);\n    }\n\n    if (!comments.isEmpty()) {\n      current.comments_before = comments;\n      comments = new TokenStream();\n    }\n\n    current.parent = open_token;\n\n    if (this._is_opening(current)) {\n      open_stack.push(open_token);\n      open_token = current;\n    } else if (open_token && this._is_closing(current, open_token)) {\n      current.opened = open_token;\n      open_token.closed = current;\n      open_token = open_stack.pop();\n      current.parent = open_token;\n    }\n\n    current.previous = previous;\n    previous.next = current;\n\n    this.__tokens.add(current);\n    previous = current;\n  }\n\n  return this.__tokens;\n};\n\n\nTokenizer.prototype._is_first_token = function() {\n  return this.__tokens.isEmpty();\n};\n\nTokenizer.prototype._reset = function() {};\n\nTokenizer.prototype._get_next_token = function(previous_token, open_token) { // jshint unused:false\n  this._readWhitespace();\n  var resulting_string = this._input.read(/.+/g);\n  if (resulting_string) {\n    return this._create_token(TOKEN.RAW, resulting_string);\n  } else {\n    return this._create_token(TOKEN.EOF, '');\n  }\n};\n\nTokenizer.prototype._is_comment = function(current_token) { // jshint unused:false\n  return false;\n};\n\nTokenizer.prototype._is_opening = function(current_token) { // jshint unused:false\n  return false;\n};\n\nTokenizer.prototype._is_closing = function(current_token, open_token) { // jshint unused:false\n  return false;\n};\n\nTokenizer.prototype._create_token = function(type, text) {\n  var token = new Token(type, text,\n    this._patterns.whitespace.newline_count,\n    this._patterns.whitespace.whitespace_before_token);\n  return token;\n};\n\nTokenizer.prototype._readWhitespace = function() {\n  return this._patterns.whitespace.read();\n};\n\n\n\nmodule.exports.Tokenizer = Tokenizer;\nmodule.exports.TOKEN = TOKEN;\n","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nvar Beautifier = require('./beautifier').Beautifier,\n  Options = require('./options').Options;\n\nfunction style_html(html_source, options, js_beautify, css_beautify) {\n  var beautifier = new Beautifier(html_source, options, js_beautify, css_beautify);\n  return beautifier.beautify();\n}\n\nmodule.exports = style_html;\nmodule.exports.defaultOptions = function() {\n  return new Options();\n};\n","var map = {\n\t\"./theme-ambiance\": 25,\n\t\"./theme-ambiance.js\": 25,\n\t\"./theme-chaos\": 26,\n\t\"./theme-chaos.js\": 26,\n\t\"./theme-chrome\": 27,\n\t\"./theme-chrome.js\": 27,\n\t\"./theme-clouds\": 28,\n\t\"./theme-clouds.js\": 28,\n\t\"./theme-clouds_midnight\": 29,\n\t\"./theme-clouds_midnight.js\": 29,\n\t\"./theme-cobalt\": 30,\n\t\"./theme-cobalt.js\": 30,\n\t\"./theme-crimson_editor\": 31,\n\t\"./theme-crimson_editor.js\": 31,\n\t\"./theme-dawn\": 32,\n\t\"./theme-dawn.js\": 32,\n\t\"./theme-dracula\": 33,\n\t\"./theme-dracula.js\": 33,\n\t\"./theme-dreamweaver\": 34,\n\t\"./theme-dreamweaver.js\": 34,\n\t\"./theme-eclipse\": 35,\n\t\"./theme-eclipse.js\": 35,\n\t\"./theme-github\": 36,\n\t\"./theme-github.js\": 36,\n\t\"./theme-gob\": 37,\n\t\"./theme-gob.js\": 37,\n\t\"./theme-gruvbox\": 38,\n\t\"./theme-gruvbox.js\": 38,\n\t\"./theme-idle_fingers\": 39,\n\t\"./theme-idle_fingers.js\": 39,\n\t\"./theme-iplastic\": 40,\n\t\"./theme-iplastic.js\": 40,\n\t\"./theme-katzenmilch\": 41,\n\t\"./theme-katzenmilch.js\": 41,\n\t\"./theme-kr_theme\": 42,\n\t\"./theme-kr_theme.js\": 42,\n\t\"./theme-kuroir\": 43,\n\t\"./theme-kuroir.js\": 43,\n\t\"./theme-merbivore\": 44,\n\t\"./theme-merbivore.js\": 44,\n\t\"./theme-merbivore_soft\": 45,\n\t\"./theme-merbivore_soft.js\": 45,\n\t\"./theme-mono_industrial\": 46,\n\t\"./theme-mono_industrial.js\": 46,\n\t\"./theme-monokai\": 16,\n\t\"./theme-monokai.js\": 16,\n\t\"./theme-nord_dark\": 47,\n\t\"./theme-nord_dark.js\": 47,\n\t\"./theme-pastel_on_dark\": 48,\n\t\"./theme-pastel_on_dark.js\": 48,\n\t\"./theme-solarized_dark\": 49,\n\t\"./theme-solarized_dark.js\": 49,\n\t\"./theme-solarized_light\": 50,\n\t\"./theme-solarized_light.js\": 50,\n\t\"./theme-sqlserver\": 51,\n\t\"./theme-sqlserver.js\": 51,\n\t\"./theme-terminal\": 52,\n\t\"./theme-terminal.js\": 52,\n\t\"./theme-textmate\": 53,\n\t\"./theme-textmate.js\": 53,\n\t\"./theme-tomorrow\": 54,\n\t\"./theme-tomorrow.js\": 54,\n\t\"./theme-tomorrow_night\": 55,\n\t\"./theme-tomorrow_night.js\": 55,\n\t\"./theme-tomorrow_night_blue\": 56,\n\t\"./theme-tomorrow_night_blue.js\": 56,\n\t\"./theme-tomorrow_night_bright\": 57,\n\t\"./theme-tomorrow_night_bright.js\": 57,\n\t\"./theme-tomorrow_night_eighties\": 58,\n\t\"./theme-tomorrow_night_eighties.js\": 58,\n\t\"./theme-twilight\": 59,\n\t\"./theme-twilight.js\": 59,\n\t\"./theme-vibrant_ink\": 60,\n\t\"./theme-vibrant_ink.js\": 60,\n\t\"./theme-xcode\": 61,\n\t\"./theme-xcode.js\": 61\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 92;","/*jshint node:true */\n/*\n\n  The MIT License (MIT)\n\n  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation files\n  (the \"Software\"), to deal in the Software without restriction,\n  including without limitation the rights to use, copy, modify, merge,\n  publish, distribute, sublicense, and/or sell copies of the Software,\n  and to permit persons to whom the Software is furnished to do so,\n  subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n\nvar Options = require('./options').Options;\nvar Output = require('./core/output').Output;\nvar Tokenizer = require('./tokenizer').Tokenizer;\nvar TOKEN = require('./tokenizer').TOKEN;\n\nvar lineBreak = /\\r\\n|[\\r\\n]/;\nvar allLineBreaks = /\\r\\n|[\\r\\n]/g;\n\nvar Printer = function(options, base_indent_string) { //handles input/output and some other printing functions\n\n  this.indent_level = 0;\n  this.alignment_size = 0;\n  this.max_preserve_newlines = options.max_preserve_newlines;\n  this.preserve_newlines = options.preserve_newlines;\n\n  this._output = new Output(options, base_indent_string);\n\n};\n\nPrinter.prototype.current_line_has_match = function(pattern) {\n  return this._output.current_line.has_match(pattern);\n};\n\nPrinter.prototype.set_space_before_token = function(value, non_breaking) {\n  this._output.space_before_token = value;\n  this._output.non_breaking_space = non_breaking;\n};\n\nPrinter.prototype.set_wrap_point = function() {\n  this._output.set_indent(this.indent_level, this.alignment_size);\n  this._output.set_wrap_point();\n};\n\n\nPrinter.prototype.add_raw_token = function(token) {\n  this._output.add_raw_token(token);\n};\n\nPrinter.prototype.print_preserved_newlines = function(raw_token) {\n  var newlines = 0;\n  if (raw_token.type !== TOKEN.TEXT && raw_token.previous.type !== TOKEN.TEXT) {\n    newlines = raw_token.newlines ? 1 : 0;\n  }\n\n  if (this.preserve_newlines) {\n    newlines = raw_token.newlines < this.max_preserve_newlines + 1 ? raw_token.newlines : this.max_preserve_newlines + 1;\n  }\n  for (var n = 0; n < newlines; n++) {\n    this.print_newline(n > 0);\n  }\n\n  return newlines !== 0;\n};\n\nPrinter.prototype.traverse_whitespace = function(raw_token) {\n  if (raw_token.whitespace_before || raw_token.newlines) {\n    if (!this.print_preserved_newlines(raw_token)) {\n      this._output.space_before_token = true;\n    }\n    return true;\n  }\n  return false;\n};\n\nPrinter.prototype.previous_token_wrapped = function() {\n  return this._output.previous_token_wrapped;\n};\n\nPrinter.prototype.print_newline = function(force) {\n  this._output.add_new_line(force);\n};\n\nPrinter.prototype.print_token = function(token) {\n  if (token.text) {\n    this._output.set_indent(this.indent_level, this.alignment_size);\n    this._output.add_token(token.text);\n  }\n};\n\nPrinter.prototype.indent = function() {\n  this.indent_level++;\n};\n\nPrinter.prototype.get_full_indent = function(level) {\n  level = this.indent_level + (level || 0);\n  if (level < 1) {\n    return '';\n  }\n\n  return this._output.get_indent_string(level);\n};\n\nvar get_type_attribute = function(start_token) {\n  var result = null;\n  var raw_token = start_token.next;\n\n  // Search attributes for a type attribute\n  while (raw_token.type !== TOKEN.EOF && start_token.closed !== raw_token) {\n    if (raw_token.type === TOKEN.ATTRIBUTE && raw_token.text === 'type') {\n      if (raw_token.next && raw_token.next.type === TOKEN.EQUALS &&\n        raw_token.next.next && raw_token.next.next.type === TOKEN.VALUE) {\n        result = raw_token.next.next.text;\n      }\n      break;\n    }\n    raw_token = raw_token.next;\n  }\n\n  return result;\n};\n\nvar get_custom_beautifier_name = function(tag_check, raw_token) {\n  var typeAttribute = null;\n  var result = null;\n\n  if (!raw_token.closed) {\n    return null;\n  }\n\n  if (tag_check === 'script') {\n    typeAttribute = 'text/javascript';\n  } else if (tag_check === 'style') {\n    typeAttribute = 'text/css';\n  }\n\n  typeAttribute = get_type_attribute(raw_token) || typeAttribute;\n\n  // For script and style tags that have a type attribute, only enable custom beautifiers for matching values\n  // For those without a type attribute use default;\n  if (typeAttribute.search('text/css') > -1) {\n    result = 'css';\n  } else if (typeAttribute.search(/module|((text|application|dojo)\\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\\+)?json|method|aspect))/) > -1) {\n    result = 'javascript';\n  } else if (typeAttribute.search(/(text|application|dojo)\\/(x-)?(html)/) > -1) {\n    result = 'html';\n  } else if (typeAttribute.search(/test\\/null/) > -1) {\n    // Test only mime-type for testing the beautifier when null is passed as beautifing function\n    result = 'null';\n  }\n\n  return result;\n};\n\nfunction in_array(what, arr) {\n  return arr.indexOf(what) !== -1;\n}\n\nfunction TagFrame(parent, parser_token, indent_level) {\n  this.parent = parent || null;\n  this.tag = parser_token ? parser_token.tag_name : '';\n  this.indent_level = indent_level || 0;\n  this.parser_token = parser_token || null;\n}\n\nfunction TagStack(printer) {\n  this._printer = printer;\n  this._current_frame = null;\n}\n\nTagStack.prototype.get_parser_token = function() {\n  return this._current_frame ? this._current_frame.parser_token : null;\n};\n\nTagStack.prototype.record_tag = function(parser_token) { //function to record a tag and its parent in this.tags Object\n  var new_frame = new TagFrame(this._current_frame, parser_token, this._printer.indent_level);\n  this._current_frame = new_frame;\n};\n\nTagStack.prototype._try_pop_frame = function(frame) { //function to retrieve the opening tag to the corresponding closer\n  var parser_token = null;\n\n  if (frame) {\n    parser_token = frame.parser_token;\n    this._printer.indent_level = frame.indent_level;\n    this._current_frame = frame.parent;\n  }\n\n  return parser_token;\n};\n\nTagStack.prototype._get_frame = function(tag_list, stop_list) { //function to retrieve the opening tag to the corresponding closer\n  var frame = this._current_frame;\n\n  while (frame) { //till we reach '' (the initial value);\n    if (tag_list.indexOf(frame.tag) !== -1) { //if this is it use it\n      break;\n    } else if (stop_list && stop_list.indexOf(frame.tag) !== -1) {\n      frame = null;\n      break;\n    }\n    frame = frame.parent;\n  }\n\n  return frame;\n};\n\nTagStack.prototype.try_pop = function(tag, stop_list) { //function to retrieve the opening tag to the corresponding closer\n  var frame = this._get_frame([tag], stop_list);\n  return this._try_pop_frame(frame);\n};\n\nTagStack.prototype.indent_to_tag = function(tag_list) {\n  var frame = this._get_frame(tag_list);\n  if (frame) {\n    this._printer.indent_level = frame.indent_level;\n  }\n};\n\nfunction Beautifier(source_text, options, js_beautify, css_beautify) {\n  //Wrapper function to invoke all the necessary constructors and deal with the output.\n  this._source_text = source_text || '';\n  options = options || {};\n  this._js_beautify = js_beautify;\n  this._css_beautify = css_beautify;\n  this._tag_stack = null;\n\n  // Allow the setting of language/file-type specific options\n  // with inheritance of overall settings\n  var optionHtml = new Options(options, 'html');\n\n  this._options = optionHtml;\n\n  this._is_wrap_attributes_force = this._options.wrap_attributes.substr(0, 'force'.length) === 'force';\n  this._is_wrap_attributes_force_expand_multiline = (this._options.wrap_attributes === 'force-expand-multiline');\n  this._is_wrap_attributes_force_aligned = (this._options.wrap_attributes === 'force-aligned');\n  this._is_wrap_attributes_aligned_multiple = (this._options.wrap_attributes === 'aligned-multiple');\n  this._is_wrap_attributes_preserve = this._options.wrap_attributes.substr(0, 'preserve'.length) === 'preserve';\n  this._is_wrap_attributes_preserve_aligned = (this._options.wrap_attributes === 'preserve-aligned');\n}\n\nBeautifier.prototype.beautify = function() {\n\n  // if disabled, return the input unchanged.\n  if (this._options.disabled) {\n    return this._source_text;\n  }\n\n  var source_text = this._source_text;\n  var eol = this._options.eol;\n  if (this._options.eol === 'auto') {\n    eol = '\\n';\n    if (source_text && lineBreak.test(source_text)) {\n      eol = source_text.match(lineBreak)[0];\n    }\n  }\n\n  // HACK: newline parsing inconsistent. This brute force normalizes the input.\n  source_text = source_text.replace(allLineBreaks, '\\n');\n\n  var baseIndentString = source_text.match(/^[\\t ]*/)[0];\n\n  var last_token = {\n    text: '',\n    type: ''\n  };\n\n  var last_tag_token = new TagOpenParserToken();\n\n  var printer = new Printer(this._options, baseIndentString);\n  var tokens = new Tokenizer(source_text, this._options).tokenize();\n\n  this._tag_stack = new TagStack(printer);\n\n  var parser_token = null;\n  var raw_token = tokens.next();\n  while (raw_token.type !== TOKEN.EOF) {\n\n    if (raw_token.type === TOKEN.TAG_OPEN || raw_token.type === TOKEN.COMMENT) {\n      parser_token = this._handle_tag_open(printer, raw_token, last_tag_token, last_token);\n      last_tag_token = parser_token;\n    } else if ((raw_token.type === TOKEN.ATTRIBUTE || raw_token.type === TOKEN.EQUALS || raw_token.type === TOKEN.VALUE) ||\n      (raw_token.type === TOKEN.TEXT && !last_tag_token.tag_complete)) {\n      parser_token = this._handle_inside_tag(printer, raw_token, last_tag_token, tokens);\n    } else if (raw_token.type === TOKEN.TAG_CLOSE) {\n      parser_token = this._handle_tag_close(printer, raw_token, last_tag_token);\n    } else if (raw_token.type === TOKEN.TEXT) {\n      parser_token = this._handle_text(printer, raw_token, last_tag_token);\n    } else {\n      // This should never happen, but if it does. Print the raw token\n      printer.add_raw_token(raw_token);\n    }\n\n    last_token = parser_token;\n\n    raw_token = tokens.next();\n  }\n  var sweet_code = printer._output.get_code(eol);\n\n  return sweet_code;\n};\n\nBeautifier.prototype._handle_tag_close = function(printer, raw_token, last_tag_token) {\n  var parser_token = {\n    text: raw_token.text,\n    type: raw_token.type\n  };\n  printer.alignment_size = 0;\n  last_tag_token.tag_complete = true;\n\n  printer.set_space_before_token(raw_token.newlines || raw_token.whitespace_before !== '', true);\n  if (last_tag_token.is_unformatted) {\n    printer.add_raw_token(raw_token);\n  } else {\n    if (last_tag_token.tag_start_char === '<') {\n      printer.set_space_before_token(raw_token.text[0] === '/', true); // space before />, no space before >\n      if (this._is_wrap_attributes_force_expand_multiline && last_tag_token.has_wrapped_attrs) {\n        printer.print_newline(false);\n      }\n    }\n    printer.print_token(raw_token);\n\n  }\n\n  if (last_tag_token.indent_content &&\n    !(last_tag_token.is_unformatted || last_tag_token.is_content_unformatted)) {\n    printer.indent();\n\n    // only indent once per opened tag\n    last_tag_token.indent_content = false;\n  }\n\n  if (!last_tag_token.is_inline_element &&\n    !(last_tag_token.is_unformatted || last_tag_token.is_content_unformatted)) {\n    printer.set_wrap_point();\n  }\n\n  return parser_token;\n};\n\nBeautifier.prototype._handle_inside_tag = function(printer, raw_token, last_tag_token, tokens) {\n  var wrapped = last_tag_token.has_wrapped_attrs;\n  var parser_token = {\n    text: raw_token.text,\n    type: raw_token.type\n  };\n\n  printer.set_space_before_token(raw_token.newlines || raw_token.whitespace_before !== '', true);\n  if (last_tag_token.is_unformatted) {\n    printer.add_raw_token(raw_token);\n  } else if (last_tag_token.tag_start_char === '{' && raw_token.type === TOKEN.TEXT) {\n    // For the insides of handlebars allow newlines or a single space between open and contents\n    if (printer.print_preserved_newlines(raw_token)) {\n      raw_token.newlines = 0;\n      printer.add_raw_token(raw_token);\n    } else {\n      printer.print_token(raw_token);\n    }\n  } else {\n    if (raw_token.type === TOKEN.ATTRIBUTE) {\n      printer.set_space_before_token(true);\n      last_tag_token.attr_count += 1;\n    } else if (raw_token.type === TOKEN.EQUALS) { //no space before =\n      printer.set_space_before_token(false);\n    } else if (raw_token.type === TOKEN.VALUE && raw_token.previous.type === TOKEN.EQUALS) { //no space before value\n      printer.set_space_before_token(false);\n    }\n\n    if (raw_token.type === TOKEN.ATTRIBUTE && last_tag_token.tag_start_char === '<') {\n      if (this._is_wrap_attributes_preserve || this._is_wrap_attributes_preserve_aligned) {\n        printer.traverse_whitespace(raw_token);\n        wrapped = wrapped || raw_token.newlines !== 0;\n      }\n\n\n      if (this._is_wrap_attributes_force) {\n        var force_attr_wrap = last_tag_token.attr_count > 1;\n        if (this._is_wrap_attributes_force_expand_multiline && last_tag_token.attr_count === 1) {\n          var is_only_attribute = true;\n          var peek_index = 0;\n          var peek_token;\n          do {\n            peek_token = tokens.peek(peek_index);\n            if (peek_token.type === TOKEN.ATTRIBUTE) {\n              is_only_attribute = false;\n              break;\n            }\n            peek_index += 1;\n          } while (peek_index < 4 && peek_token.type !== TOKEN.EOF && peek_token.type !== TOKEN.TAG_CLOSE);\n\n          force_attr_wrap = !is_only_attribute;\n        }\n\n        if (force_attr_wrap) {\n          printer.print_newline(false);\n          wrapped = true;\n        }\n      }\n    }\n    printer.print_token(raw_token);\n    wrapped = wrapped || printer.previous_token_wrapped();\n    last_tag_token.has_wrapped_attrs = wrapped;\n  }\n  return parser_token;\n};\n\nBeautifier.prototype._handle_text = function(printer, raw_token, last_tag_token) {\n  var parser_token = {\n    text: raw_token.text,\n    type: 'TK_CONTENT'\n  };\n  if (last_tag_token.custom_beautifier_name) { //check if we need to format javascript\n    this._print_custom_beatifier_text(printer, raw_token, last_tag_token);\n  } else if (last_tag_token.is_unformatted || last_tag_token.is_content_unformatted) {\n    printer.add_raw_token(raw_token);\n  } else {\n    printer.traverse_whitespace(raw_token);\n    printer.print_token(raw_token);\n  }\n  return parser_token;\n};\n\nBeautifier.prototype._print_custom_beatifier_text = function(printer, raw_token, last_tag_token) {\n  var local = this;\n  if (raw_token.text !== '') {\n\n    var text = raw_token.text,\n      _beautifier,\n      script_indent_level = 1,\n      pre = '',\n      post = '';\n    if (last_tag_token.custom_beautifier_name === 'javascript' && typeof this._js_beautify === 'function') {\n      _beautifier = this._js_beautify;\n    } else if (last_tag_token.custom_beautifier_name === 'css' && typeof this._css_beautify === 'function') {\n      _beautifier = this._css_beautify;\n    } else if (last_tag_token.custom_beautifier_name === 'html') {\n      _beautifier = function(html_source, options) {\n        var beautifier = new Beautifier(html_source, options, local._js_beautify, local._css_beautify);\n        return beautifier.beautify();\n      };\n    }\n\n    if (this._options.indent_scripts === \"keep\") {\n      script_indent_level = 0;\n    } else if (this._options.indent_scripts === \"separate\") {\n      script_indent_level = -printer.indent_level;\n    }\n\n    var indentation = printer.get_full_indent(script_indent_level);\n\n    // if there is at least one empty line at the end of this text, strip it\n    // we'll be adding one back after the text but before the containing tag.\n    text = text.replace(/\\n[ \\t]*$/, '');\n\n    // Handle the case where content is wrapped in a comment or cdata.\n    if (last_tag_token.custom_beautifier_name !== 'html' &&\n      text[0] === '<' && text.match(/^(<!--|<!\\[CDATA\\[)/)) {\n      var matched = /^(<!--[^\\n]*|<!\\[CDATA\\[)(\\n?)([ \\t\\n]*)([\\s\\S]*)(-->|]]>)$/.exec(text);\n\n      // if we start to wrap but don't finish, print raw\n      if (!matched) {\n        printer.add_raw_token(raw_token);\n        return;\n      }\n\n      pre = indentation + matched[1] + '\\n';\n      text = matched[4];\n      if (matched[5]) {\n        post = indentation + matched[5];\n      }\n\n      // if there is at least one empty line at the end of this text, strip it\n      // we'll be adding one back after the text but before the containing tag.\n      text = text.replace(/\\n[ \\t]*$/, '');\n\n      if (matched[2] || matched[3].indexOf('\\n') !== -1) {\n        // if the first line of the non-comment text has spaces\n        // use that as the basis for indenting in null case.\n        matched = matched[3].match(/[ \\t]+$/);\n        if (matched) {\n          raw_token.whitespace_before = matched[0];\n        }\n      }\n    }\n\n    if (text) {\n      if (_beautifier) {\n\n        // call the Beautifier if avaliable\n        var Child_options = function() {\n          this.eol = '\\n';\n        };\n        Child_options.prototype = this._options.raw_options;\n        var child_options = new Child_options();\n        text = _beautifier(indentation + text, child_options);\n      } else {\n        // simply indent the string otherwise\n        var white = raw_token.whitespace_before;\n        if (white) {\n          text = text.replace(new RegExp('\\n(' + white + ')?', 'g'), '\\n');\n        }\n\n        text = indentation + text.replace(/\\n/g, '\\n' + indentation);\n      }\n    }\n\n    if (pre) {\n      if (!text) {\n        text = pre + post;\n      } else {\n        text = pre + text + '\\n' + post;\n      }\n    }\n\n    printer.print_newline(false);\n    if (text) {\n      raw_token.text = text;\n      raw_token.whitespace_before = '';\n      raw_token.newlines = 0;\n      printer.add_raw_token(raw_token);\n      printer.print_newline(true);\n    }\n  }\n};\n\nBeautifier.prototype._handle_tag_open = function(printer, raw_token, last_tag_token, last_token) {\n  var parser_token = this._get_tag_open_token(raw_token);\n\n  if ((last_tag_token.is_unformatted || last_tag_token.is_content_unformatted) &&\n    !last_tag_token.is_empty_element &&\n    raw_token.type === TOKEN.TAG_OPEN && raw_token.text.indexOf('</') === 0) {\n    // End element tags for unformatted or content_unformatted elements\n    // are printed raw to keep any newlines inside them exactly the same.\n    printer.add_raw_token(raw_token);\n    parser_token.start_tag_token = this._tag_stack.try_pop(parser_token.tag_name);\n  } else {\n    printer.traverse_whitespace(raw_token);\n    this._set_tag_position(printer, raw_token, parser_token, last_tag_token, last_token);\n    if (!parser_token.is_inline_element) {\n      printer.set_wrap_point();\n    }\n    printer.print_token(raw_token);\n  }\n\n  //indent attributes an auto, forced, aligned or forced-align line-wrap\n  if (this._is_wrap_attributes_force_aligned || this._is_wrap_attributes_aligned_multiple || this._is_wrap_attributes_preserve_aligned) {\n    parser_token.alignment_size = raw_token.text.length + 1;\n  }\n\n  if (!parser_token.tag_complete && !parser_token.is_unformatted) {\n    printer.alignment_size = parser_token.alignment_size;\n  }\n\n  return parser_token;\n};\n\nvar TagOpenParserToken = function(parent, raw_token) {\n  this.parent = parent || null;\n  this.text = '';\n  this.type = 'TK_TAG_OPEN';\n  this.tag_name = '';\n  this.is_inline_element = false;\n  this.is_unformatted = false;\n  this.is_content_unformatted = false;\n  this.is_empty_element = false;\n  this.is_start_tag = false;\n  this.is_end_tag = false;\n  this.indent_content = false;\n  this.multiline_content = false;\n  this.custom_beautifier_name = null;\n  this.start_tag_token = null;\n  this.attr_count = 0;\n  this.has_wrapped_attrs = false;\n  this.alignment_size = 0;\n  this.tag_complete = false;\n  this.tag_start_char = '';\n  this.tag_check = '';\n\n  if (!raw_token) {\n    this.tag_complete = true;\n  } else {\n    var tag_check_match;\n\n    this.tag_start_char = raw_token.text[0];\n    this.text = raw_token.text;\n\n    if (this.tag_start_char === '<') {\n      tag_check_match = raw_token.text.match(/^<([^\\s>]*)/);\n      this.tag_check = tag_check_match ? tag_check_match[1] : '';\n    } else {\n      tag_check_match = raw_token.text.match(/^{{(?:[\\^]|#\\*?)?([^\\s}]+)/);\n      this.tag_check = tag_check_match ? tag_check_match[1] : '';\n\n      // handle \"{{#> myPartial}}\n      if (raw_token.text === '{{#>' && this.tag_check === '>' && raw_token.next !== null) {\n        this.tag_check = raw_token.next.text;\n      }\n    }\n    this.tag_check = this.tag_check.toLowerCase();\n\n    if (raw_token.type === TOKEN.COMMENT) {\n      this.tag_complete = true;\n    }\n\n    this.is_start_tag = this.tag_check.charAt(0) !== '/';\n    this.tag_name = !this.is_start_tag ? this.tag_check.substr(1) : this.tag_check;\n    this.is_end_tag = !this.is_start_tag ||\n      (raw_token.closed && raw_token.closed.text === '/>');\n\n    // handlebars tags that don't start with # or ^ are single_tags, and so also start and end.\n    this.is_end_tag = this.is_end_tag ||\n      (this.tag_start_char === '{' && (this.text.length < 3 || (/[^#^]/.test(this.text.charAt(2)))));\n  }\n};\n\nBeautifier.prototype._get_tag_open_token = function(raw_token) { //function to get a full tag and parse its type\n  var parser_token = new TagOpenParserToken(this._tag_stack.get_parser_token(), raw_token);\n\n  parser_token.alignment_size = this._options.wrap_attributes_indent_size;\n\n  parser_token.is_end_tag = parser_token.is_end_tag ||\n    in_array(parser_token.tag_check, this._options.void_elements);\n\n  parser_token.is_empty_element = parser_token.tag_complete ||\n    (parser_token.is_start_tag && parser_token.is_end_tag);\n\n  parser_token.is_unformatted = !parser_token.tag_complete && in_array(parser_token.tag_check, this._options.unformatted);\n  parser_token.is_content_unformatted = !parser_token.is_empty_element && in_array(parser_token.tag_check, this._options.content_unformatted);\n  parser_token.is_inline_element = in_array(parser_token.tag_name, this._options.inline) || parser_token.tag_start_char === '{';\n\n  return parser_token;\n};\n\nBeautifier.prototype._set_tag_position = function(printer, raw_token, parser_token, last_tag_token, last_token) {\n\n  if (!parser_token.is_empty_element) {\n    if (parser_token.is_end_tag) { //this tag is a double tag so check for tag-ending\n      parser_token.start_tag_token = this._tag_stack.try_pop(parser_token.tag_name); //remove it and all ancestors\n    } else { // it's a start-tag\n      // check if this tag is starting an element that has optional end element\n      // and do an ending needed\n      if (this._do_optional_end_element(parser_token)) {\n        if (!parser_token.is_inline_element) {\n          printer.print_newline(false);\n        }\n      }\n\n      this._tag_stack.record_tag(parser_token); //push it on the tag stack\n\n      if ((parser_token.tag_name === 'script' || parser_token.tag_name === 'style') &&\n        !(parser_token.is_unformatted || parser_token.is_content_unformatted)) {\n        parser_token.custom_beautifier_name = get_custom_beautifier_name(parser_token.tag_check, raw_token);\n      }\n    }\n  }\n\n  if (in_array(parser_token.tag_check, this._options.extra_liners)) { //check if this double needs an extra line\n    printer.print_newline(false);\n    if (!printer._output.just_added_blankline()) {\n      printer.print_newline(true);\n    }\n  }\n\n  if (parser_token.is_empty_element) { //if this tag name is a single tag type (either in the list or has a closing /)\n\n    // if you hit an else case, reset the indent level if you are inside an:\n    // 'if', 'unless', or 'each' block.\n    if (parser_token.tag_start_char === '{' && parser_token.tag_check === 'else') {\n      this._tag_stack.indent_to_tag(['if', 'unless', 'each']);\n      parser_token.indent_content = true;\n      // Don't add a newline if opening {{#if}} tag is on the current line\n      var foundIfOnCurrentLine = printer.current_line_has_match(/{{#if/);\n      if (!foundIfOnCurrentLine) {\n        printer.print_newline(false);\n      }\n    }\n\n    // Don't add a newline before elements that should remain where they are.\n    if (parser_token.tag_name === '!--' && last_token.type === TOKEN.TAG_CLOSE &&\n      last_tag_token.is_end_tag && parser_token.text.indexOf('\\n') === -1) {\n      //Do nothing. Leave comments on same line.\n    } else {\n      if (!(parser_token.is_inline_element || parser_token.is_unformatted)) {\n        printer.print_newline(false);\n      }\n      this._calcluate_parent_multiline(printer, parser_token);\n    }\n  } else if (parser_token.is_end_tag) { //this tag is a double tag so check for tag-ending\n    var do_end_expand = false;\n\n    // deciding whether a block is multiline should not be this hard\n    do_end_expand = parser_token.start_tag_token && parser_token.start_tag_token.multiline_content;\n    do_end_expand = do_end_expand || (!parser_token.is_inline_element &&\n      !(last_tag_token.is_inline_element || last_tag_token.is_unformatted) &&\n      !(last_token.type === TOKEN.TAG_CLOSE && parser_token.start_tag_token === last_tag_token) &&\n      last_token.type !== 'TK_CONTENT'\n    );\n\n    if (parser_token.is_content_unformatted || parser_token.is_unformatted) {\n      do_end_expand = false;\n    }\n\n    if (do_end_expand) {\n      printer.print_newline(false);\n    }\n  } else { // it's a start-tag\n    parser_token.indent_content = !parser_token.custom_beautifier_name;\n\n    if (parser_token.tag_start_char === '<') {\n      if (parser_token.tag_name === 'html') {\n        parser_token.indent_content = this._options.indent_inner_html;\n      } else if (parser_token.tag_name === 'head') {\n        parser_token.indent_content = this._options.indent_head_inner_html;\n      } else if (parser_token.tag_name === 'body') {\n        parser_token.indent_content = this._options.indent_body_inner_html;\n      }\n    }\n\n    if (!(parser_token.is_inline_element || parser_token.is_unformatted) &&\n      (last_token.type !== 'TK_CONTENT' || parser_token.is_content_unformatted)) {\n      printer.print_newline(false);\n    }\n\n    this._calcluate_parent_multiline(printer, parser_token);\n  }\n};\n\nBeautifier.prototype._calcluate_parent_multiline = function(printer, parser_token) {\n  if (parser_token.parent && printer._output.just_added_newline() &&\n    !((parser_token.is_inline_element || parser_token.is_unformatted) && parser_token.parent.is_inline_element)) {\n    parser_token.parent.multiline_content = true;\n  }\n};\n\n//To be used for <p> tag special case:\nvar p_closers = ['address', 'article', 'aside', 'blockquote', 'details', 'div', 'dl', 'fieldset', 'figcaption', 'figure', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'header', 'hr', 'main', 'nav', 'ol', 'p', 'pre', 'section', 'table', 'ul'];\nvar p_parent_excludes = ['a', 'audio', 'del', 'ins', 'map', 'noscript', 'video'];\n\nBeautifier.prototype._do_optional_end_element = function(parser_token) {\n  var result = null;\n  // NOTE: cases of \"if there is no more content in the parent element\"\n  // are handled automatically by the beautifier.\n  // It assumes parent or ancestor close tag closes all children.\n  // https://www.w3.org/TR/html5/syntax.html#optional-tags\n  if (parser_token.is_empty_element || !parser_token.is_start_tag || !parser_token.parent) {\n    return;\n\n  }\n\n  if (parser_token.tag_name === 'body') {\n    // A head element’s end tag may be omitted if the head element is not immediately followed by a space character or a comment.\n    result = result || this._tag_stack.try_pop('head');\n\n    //} else if (parser_token.tag_name === 'body') {\n    // DONE: A body element’s end tag may be omitted if the body element is not immediately followed by a comment.\n\n  } else if (parser_token.tag_name === 'li') {\n    // An li element’s end tag may be omitted if the li element is immediately followed by another li element or if there is no more content in the parent element.\n    result = result || this._tag_stack.try_pop('li', ['ol', 'ul']);\n\n  } else if (parser_token.tag_name === 'dd' || parser_token.tag_name === 'dt') {\n    // A dd element’s end tag may be omitted if the dd element is immediately followed by another dd element or a dt element, or if there is no more content in the parent element.\n    // A dt element’s end tag may be omitted if the dt element is immediately followed by another dt element or a dd element.\n    result = result || this._tag_stack.try_pop('dt', ['dl']);\n    result = result || this._tag_stack.try_pop('dd', ['dl']);\n\n\n  } else if (parser_token.parent.tag_name === 'p' && p_closers.indexOf(parser_token.tag_name) !== -1) {\n    // IMPORTANT: this else-if works because p_closers has no overlap with any other element we look for in this method\n    // check for the parent element is an HTML element that is not an <a>, <audio>, <del>, <ins>, <map>, <noscript>, or <video> element,  or an autonomous custom element.\n    // To do this right, this needs to be coded as an inclusion of the inverse of the exclusion above.\n    // But to start with (if we ignore \"autonomous custom elements\") the exclusion would be fine.\n    var p_parent = parser_token.parent.parent;\n    if (!p_parent || p_parent_excludes.indexOf(p_parent.tag_name) === -1) {\n      result = result || this._tag_stack.try_pop('p');\n    }\n  } else if (parser_token.tag_name === 'rp' || parser_token.tag_name === 'rt') {\n    // An rt element’s end tag may be omitted if the rt element is immediately followed by an rt or rp element, or if there is no more content in the parent element.\n    // An rp element’s end tag may be omitted if the rp element is immediately followed by an rt or rp element, or if there is no more content in the parent element.\n    result = result || this._tag_stack.try_pop('rt', ['ruby', 'rtc']);\n    result = result || this._tag_stack.try_pop('rp', ['ruby', 'rtc']);\n\n  } else if (parser_token.tag_name === 'optgroup') {\n    // An optgroup element’s end tag may be omitted if the optgroup element is immediately followed by another optgroup element, or if there is no more content in the parent element.\n    // An option element’s end tag may be omitted if the option element is immediately followed by another option element, or if it is immediately followed by an optgroup element, or if there is no more content in the parent element.\n    result = result || this._tag_stack.try_pop('optgroup', ['select']);\n    //result = result || this._tag_stack.try_pop('option', ['select']);\n\n  } else if (parser_token.tag_name === 'option') {\n    // An option element’s end tag may be omitted if the option element is immediately followed by another option element, or if it is immediately followed by an optgroup element, or if there is no more content in the parent element.\n    result = result || this._tag_stack.try_pop('option', ['select', 'datalist', 'optgroup']);\n\n  } else if (parser_token.tag_name === 'colgroup') {\n    // DONE: A colgroup element’s end tag may be omitted if the colgroup element is not immediately followed by a space character or a comment.\n    // A caption element's end tag may be ommitted if a colgroup, thead, tfoot, tbody, or tr element is started.\n    result = result || this._tag_stack.try_pop('caption', ['table']);\n\n  } else if (parser_token.tag_name === 'thead') {\n    // A colgroup element's end tag may be ommitted if a thead, tfoot, tbody, or tr element is started.\n    // A caption element's end tag may be ommitted if a colgroup, thead, tfoot, tbody, or tr element is started.\n    result = result || this._tag_stack.try_pop('caption', ['table']);\n    result = result || this._tag_stack.try_pop('colgroup', ['table']);\n\n    //} else if (parser_token.tag_name === 'caption') {\n    // DONE: A caption element’s end tag may be omitted if the caption element is not immediately followed by a space character or a comment.\n\n  } else if (parser_token.tag_name === 'tbody' || parser_token.tag_name === 'tfoot') {\n    // A thead element’s end tag may be omitted if the thead element is immediately followed by a tbody or tfoot element.\n    // A tbody element’s end tag may be omitted if the tbody element is immediately followed by a tbody or tfoot element, or if there is no more content in the parent element.\n    // A colgroup element's end tag may be ommitted if a thead, tfoot, tbody, or tr element is started.\n    // A caption element's end tag may be ommitted if a colgroup, thead, tfoot, tbody, or tr element is started.\n    result = result || this._tag_stack.try_pop('caption', ['table']);\n    result = result || this._tag_stack.try_pop('colgroup', ['table']);\n    result = result || this._tag_stack.try_pop('thead', ['table']);\n    result = result || this._tag_stack.try_pop('tbody', ['table']);\n\n    //} else if (parser_token.tag_name === 'tfoot') {\n    // DONE: A tfoot element’s end tag may be omitted if there is no more content in the parent element.\n\n  } else if (parser_token.tag_name === 'tr') {\n    // A tr element’s end tag may be omitted if the tr element is immediately followed by another tr element, or if there is no more content in the parent element.\n    // A colgroup element's end tag may be ommitted if a thead, tfoot, tbody, or tr element is started.\n    // A caption element's end tag may be ommitted if a colgroup, thead, tfoot, tbody, or tr element is started.\n    result = result || this._tag_stack.try_pop('caption', ['table']);\n    result = result || this._tag_stack.try_pop('colgroup', ['table']);\n    result = result || this._tag_stack.try_pop('tr', ['table', 'thead', 'tbody', 'tfoot']);\n\n  } else if (parser_token.tag_name === 'th' || parser_token.tag_name === 'td') {\n    // A td element’s end tag may be omitted if the td element is immediately followed by a td or th element, or if there is no more content in the parent element.\n    // A th element’s end tag may be omitted if the th element is immediately followed by a td or th element, or if there is no more content in the parent element.\n    result = result || this._tag_stack.try_pop('td', ['table', 'thead', 'tbody', 'tfoot', 'tr']);\n    result = result || this._tag_stack.try_pop('th', ['table', 'thead', 'tbody', 'tfoot', 'tr']);\n  }\n\n  // Start element omission not handled currently\n  // A head element’s start tag may be omitted if the element is empty, or if the first thing inside the head element is an element.\n  // A tbody element’s start tag may be omitted if the first thing inside the tbody element is a tr element, and if the element is not immediately preceded by a tbody, thead, or tfoot element whose end tag has been omitted. (It can’t be omitted if the element is empty.)\n  // A colgroup element’s start tag may be omitted if the first thing inside the colgroup element is a col element, and if the element is not immediately preceded by another colgroup element whose end tag has been omitted. (It can’t be omitted if the element is empty.)\n\n  // Fix up the parent of the parser token\n  parser_token.parent = this._tag_stack.get_parser_token();\n\n  return result;\n};\n\nmodule.exports.Beautifier = Beautifier;\n"],"sourceRoot":""}